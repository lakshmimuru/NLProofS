187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<04:45,  3.07s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<04:45,  3.07s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:04<03:39,  2.38s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:04<03:39,  2.38s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:04,  2.68s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:04,  2.68s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:44,  2.49s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:44,  2.49s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<03:57,  2.67s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<03:57,  2.67s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:14<03:11,  2.18s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:14<03:11,  2.18s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:15<02:52,  1.98s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:15<02:52,  1.98s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:16<02:14,  1.56s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:16<02:14,  1.56s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:17<01:49,  1.29s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:17<01:49,  1.29s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:23<03:59,  2.85s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:23<03:59,  2.85s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:25<03:24,  2.47s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:25<03:24,  2.47s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:27<03:06,  2.28s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:27<03:06,  2.28s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:29<03:17,  2.44s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:29<03:17,  2.44s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:32<03:24,  2.56s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:32<03:24,  2.56s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:35<03:24,  2.59s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:35<03:24,  2.59s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:41<04:51,  3.74s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:41<04:51,  3.74s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:45<04:43,  3.68s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:45<04:43,  3.68s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:47<04:14,  3.35s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:47<04:14,  3.35s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:49<03:30,  2.81s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:49<03:30,  2.81s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [00:53<03:58,  3.23s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [00:53<03:58,  3.23s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [00:59<04:48,  3.95s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [00:59<04:48,  3.95s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:05<05:28,  4.56s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:05<05:28,  4.56s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:09<05:23,  4.55s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:09<05:23,  4.55s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:12<04:41,  4.02s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:12<04:41,  4.02s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:15<04:14,  3.68s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:15<04:14,  3.68s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:17<03:38,  3.21s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:17<03:38,  3.21s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:21<03:51,  3.45s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:21<03:51,  3.45s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:24<03:29,  3.17s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:24<03:29,  3.17s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:24<02:37,  2.43s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:24<02:37,  2.43s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:28<02:58,  2.79s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:28<02:58,  2.79s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:32<03:09,  3.01s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:32<03:09,  3.01s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:34<02:53,  2.80s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:34<02:53,  2.80s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:35<02:26,  2.40s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:35<02:26,  2.40s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:38<02:36,  2.61s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:38<02:36,  2.61s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:40<02:07,  2.16s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:40<02:07,  2.16s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:41<01:47,  1.85s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:41<01:47,  1.85s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [01:43<01:49,  1.91s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [01:43<01:49,  1.91s/it]Validation DataLoader 0:  40%|████      | 38/94 [01:45<01:53,  2.03s/it]Validation DataLoader 0:  40%|████      | 38/94 [01:45<01:53,  2.03s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [01:47<01:57,  2.13s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [01:47<01:57,  2.13s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [01:50<02:05,  2.32s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [01:50<02:05,  2.32s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [01:53<02:17,  2.59s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [01:53<02:17,  2.59s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [01:54<01:44,  2.02s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [01:54<01:44,  2.02s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:01<03:01,  3.57s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:01<03:01,  3.57s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:08<03:46,  4.53s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:08<03:46,  4.53s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:17<04:48,  5.88s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:17<04:48,  5.88s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:25<05:11,  6.50s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:25<05:11,  6.50s/it]Validation DataLoader 0:  50%|█████     | 47/94 [02:32<05:14,  6.70s/it]Validation DataLoader 0:  50%|█████     | 47/94 [02:32<05:14,  6.70s/it]Validation DataLoader 0:  51%|█████     | 48/94 [02:37<04:41,  6.11s/it]Validation DataLoader 0:  51%|█████     | 48/94 [02:37<04:41,  6.11s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [02:40<03:50,  5.12s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [02:40<03:50,  5.12s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [02:43<03:15,  4.43s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [02:43<03:15,  4.43s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [02:48<03:27,  4.81s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [02:48<03:27,  4.81s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [02:51<03:02,  4.34s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [02:51<03:02,  4.34s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [02:56<02:55,  4.28s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [02:56<02:55,  4.28s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [02:57<02:14,  3.37s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [02:57<02:14,  3.37s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:00<02:05,  3.21s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:00<02:05,  3.21s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:03<01:57,  3.09s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:03<01:57,  3.09s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:06<01:56,  3.14s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:06<01:56,  3.14s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:08<01:48,  3.01s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:08<01:48,  3.01s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:09<01:21,  2.31s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:09<01:21,  2.31s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [03:21<02:52,  5.08s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [03:21<02:52,  5.08s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [03:25<02:38,  4.79s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [03:25<02:38,  4.79s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [03:27<02:05,  3.92s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [03:27<02:05,  3.92s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [03:29<01:47,  3.45s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [03:29<01:47,  3.45s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [03:37<02:23,  4.78s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [03:37<02:23,  4.78s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [03:47<03:07,  6.45s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [03:47<03:07,  6.45s/it]Validation DataLoader 0:  70%|███████   | 66/94 [03:50<02:30,  5.36s/it]Validation DataLoader 0:  70%|███████   | 66/94 [03:50<02:30,  5.36s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [03:52<01:59,  4.42s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [03:52<01:59,  4.42s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [03:53<01:25,  3.29s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [03:53<01:25,  3.29s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [03:56<01:22,  3.31s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [03:56<01:22,  3.31s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [03:59<01:12,  3.03s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [03:59<01:12,  3.03s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:01<01:02,  2.70s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:01<01:02,  2.70s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [04:03<00:58,  2.66s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [04:03<00:58,  2.66s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:06<00:54,  2.58s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:06<00:54,  2.58s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [04:07<00:47,  2.37s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [04:07<00:47,  2.37s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [04:09<00:42,  2.22s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [04:09<00:42,  2.22s/it]Validation DataLoader 0:  81%|████████  | 76/94 [04:12<00:40,  2.27s/it]Validation DataLoader 0:  81%|████████  | 76/94 [04:12<00:40,  2.27s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [04:12<00:30,  1.79s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [04:12<00:30,  1.79s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [04:14<00:27,  1.75s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [04:14<00:27,  1.75s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [04:15<00:21,  1.43s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [04:15<00:21,  1.43s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [04:18<00:25,  1.85s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [04:18<00:25,  1.85s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [04:20<00:25,  2.00s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [04:20<00:25,  2.00s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [04:22<00:23,  2.00s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [04:22<00:23,  2.00s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [04:24<00:21,  1.97s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [04:24<00:21,  1.97s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [04:26<00:20,  2.04s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [04:26<00:20,  2.04s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [04:27<00:16,  1.83s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [04:27<00:16,  1.83s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [04:31<00:19,  2.40s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [04:31<00:19,  2.40s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [04:34<00:17,  2.48s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [04:34<00:17,  2.48s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [04:35<00:11,  1.98s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [04:35<00:11,  1.98s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [04:36<00:09,  1.95s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [04:36<00:09,  1.95s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [04:38<00:07,  1.75s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [04:38<00:07,  1.75s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [04:39<00:04,  1.59s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [04:39<00:04,  1.59s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [04:40<00:03,  1.53s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [04:40<00:03,  1.53s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [04:42<00:01,  1.66s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [04:42<00:01,  1.66s/it]Validation DataLoader 0: 100%|██████████| 94/94 [04:43<00:00,  1.29s/it]Validation DataLoader 0: 100%|██████████| 94/94 [04:43<00:00,  1.29s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9862745098039215
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.878830717893218
	steps: 0.375	0.4672991071428571
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.42857142857142855	0.8255597577026148
	steps: 0.17857142857142858	0.3967403628117914
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8792308000641333
	steps: 0.16666666666666666	0.3693722943722944
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6531120324463978
	steps: 0.0	0.17470264777957084
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5283390279188598
	steps: 0.0	0.13430735930735932
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7122822427170253
	steps: 0.0	0.1642540832758224
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9829268292682927
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8751608751608752
	steps: 0.4594594594594595	0.5018018018018018
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8307692307692308
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.854181929181929
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.2	0.8556998556998557
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9257070707070707
	steps: 0.1	0.41428571428571426
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8324944896373468
	steps: 0.07142857142857142	0.284018759018759
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8583333333333333
	steps: 0.0	0.18636363636363634
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.6696428571428572
	steps: 0.0	0.09090909090909091
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.5697335344394169
	steps: 0.0	0.1690850815850816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8
	steps: 0.0	0.17692307692307693
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.4705882352941176
	steps: 0.0	0.12777777777777777
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6257575757575756
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8662090007627765
	steps: 0.0	0.2640901771336554
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5454545454545455
	steps: 0.0	0.1
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [04:43<00:00,  3.01s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5508021390374331
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val          0.86604019591193
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5126277259385839
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=2, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:06,  3.30s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:06,  3.30s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<03:55,  2.56s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<03:55,  2.56s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:56,  3.26s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:56,  3.26s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<04:04,  2.72s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<04:04,  2.72s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:12,  2.84s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:12,  2.84s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<03:40,  2.50s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<03:40,  2.50s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:17<03:08,  2.16s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:17<03:08,  2.16s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:18<02:42,  1.89s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:18<02:42,  1.89s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:29,  1.76s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:29,  1.76s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:53,  3.49s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:53,  3.49s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<04:06,  2.96s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<04:06,  2.96s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:40,  2.69s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:40,  2.69s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:16,  3.16s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:16,  3.16s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:23,  3.30s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:23,  3.30s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:43<04:25,  3.36s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:43<04:25,  3.36s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:48<05:02,  3.88s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:48<05:02,  3.88s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:51<04:39,  3.63s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:51<04:39,  3.63s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:54<04:19,  3.42s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:54<04:19,  3.42s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:56<03:42,  2.97s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:56<03:42,  2.97s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:03<05:23,  4.38s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:03<05:23,  4.38s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:09<05:42,  4.70s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:09<05:42,  4.70s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:15<06:04,  5.06s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:15<06:04,  5.06s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:18<05:29,  4.64s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:18<05:29,  4.64s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:21<04:53,  4.20s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:21<04:53,  4.20s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:24<04:28,  3.89s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:24<04:28,  3.89s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:27<03:49,  3.38s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:27<03:49,  3.38s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:31<03:58,  3.56s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:31<03:58,  3.56s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:34<03:50,  3.49s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:34<03:50,  3.49s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:35<02:55,  2.70s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:35<02:55,  2.70s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:39<03:25,  3.21s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:39<03:25,  3.21s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:42<03:13,  3.08s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:42<03:13,  3.08s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:46<03:25,  3.32s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:46<03:25,  3.32s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:48<03:06,  3.06s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:48<03:06,  3.06s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:56<04:23,  4.40s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:56<04:23,  4.40s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:58<03:31,  3.59s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:58<03:31,  3.59s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:59<02:52,  2.97s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:59<02:52,  2.97s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:02<02:42,  2.85s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:02<02:42,  2.85s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:05<02:51,  3.06s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:05<02:51,  3.06s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:11<03:40,  4.00s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:11<03:40,  4.00s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:15<03:22,  3.75s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:15<03:22,  3.75s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:25<05:11,  5.88s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:25<05:11,  5.88s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:26<03:47,  4.38s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:26<03:47,  4.38s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:30<03:35,  4.22s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:30<03:35,  4.22s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:39<04:39,  5.58s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:39<04:39,  5.58s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:46<04:56,  6.05s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:46<04:56,  6.05s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:53<05:01,  6.28s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:53<05:01,  6.28s/it]Validation DataLoader 0:  50%|█████     | 47/94 [02:58<04:42,  6.02s/it]Validation DataLoader 0:  50%|█████     | 47/94 [02:58<04:42,  6.02s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:04<04:38,  6.06s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:04<04:38,  6.06s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:07<03:46,  5.04s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:07<03:46,  5.04s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:11<03:20,  4.55s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:11<03:20,  4.55s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:16<03:32,  4.95s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:16<03:32,  4.95s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:20<03:06,  4.44s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:20<03:06,  4.44s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:24<02:58,  4.36s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:24<02:58,  4.36s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:26<02:28,  3.72s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:26<02:28,  3.72s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:29<02:18,  3.54s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:29<02:18,  3.54s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:33<02:11,  3.47s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:33<02:11,  3.47s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:38<02:27,  3.98s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:38<02:27,  3.98s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:41<02:18,  3.84s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:41<02:18,  3.84s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:42<01:47,  3.08s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:42<01:47,  3.08s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [03:57<03:42,  6.55s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [03:57<03:42,  6.55s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:04<03:34,  6.51s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:04<03:34,  6.51s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:06<02:51,  5.37s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:06<02:51,  5.37s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:10<02:32,  4.91s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:10<02:32,  4.91s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:18<02:53,  5.79s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:18<02:53,  5.79s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:32<04:00,  8.28s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:32<04:00,  8.28s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:34<03:01,  6.49s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:34<03:01,  6.49s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:36<02:19,  5.16s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:36<02:19,  5.16s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:38<01:43,  3.98s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:38<01:43,  3.98s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:41<01:33,  3.75s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:41<01:33,  3.75s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:43<01:17,  3.22s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:43<01:17,  3.22s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:44<01:02,  2.73s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:44<01:02,  2.73s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [04:47<01:01,  2.80s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [04:47<01:01,  2.80s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:50<00:58,  2.81s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:50<00:58,  2.81s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [04:53<00:53,  2.67s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [04:53<00:53,  2.67s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [04:55<00:48,  2.57s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [04:55<00:48,  2.57s/it]Validation DataLoader 0:  81%|████████  | 76/94 [04:58<00:49,  2.75s/it]Validation DataLoader 0:  81%|████████  | 76/94 [04:58<00:49,  2.75s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [04:59<00:37,  2.18s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [04:59<00:37,  2.18s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:01<00:36,  2.29s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:01<00:36,  2.29s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:03<00:30,  2.01s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:03<00:30,  2.01s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:07<00:36,  2.58s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:07<00:36,  2.58s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:09<00:33,  2.56s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:09<00:33,  2.56s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:12<00:31,  2.62s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:12<00:31,  2.62s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:14<00:26,  2.45s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:14<00:26,  2.45s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:16<00:22,  2.23s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:16<00:22,  2.23s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:17<00:18,  2.01s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:17<00:18,  2.01s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:25<00:28,  3.61s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:25<00:28,  3.61s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:27<00:23,  3.31s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:27<00:23,  3.31s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:28<00:15,  2.64s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:28<00:15,  2.64s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:31<00:12,  2.53s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:31<00:12,  2.53s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:32<00:08,  2.19s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:32<00:08,  2.19s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:33<00:05,  1.98s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:33<00:05,  1.98s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:35<00:03,  1.92s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:35<00:03,  1.92s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:39<00:02,  2.48s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:39<00:02,  2.48s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:40<00:00,  2.02s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:40<00:00,  2.02s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9114820075757576
	steps: 0.390625	0.49981398809523814
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.4642857142857143	0.8967306503020789
	steps: 0.17857142857142858	0.39999999999999997
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8834028625695294
	steps: 0.16666666666666666	0.35464165464165465
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.15384615384615385	0.8133229515582456
	steps: 0.0	0.25557519403673246
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6451457506079354
	steps: 0.0	0.16339929911358483
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7016855929899409
	steps: 0.0	0.21787518037518036
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9173745173745174
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.9181318681318682
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9136363636363637
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.8936363636363638
	steps: 0.1	0.35873015873015873
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8467802039230611
	steps: 0.07142857142857142	0.29682539682539677
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.75	0.9807692307692307
	steps: 0.0	0.2517482517482517
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7321428571428572
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6677960927960928
	steps: 0.0	0.20724645724645727
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8750000000000001
	steps: 0.0	0.23809523809523808
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7598039215686274
	steps: 0.0	0.13968253968253966
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.9333333333333333
	steps: 0.0	0.5
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6868686868686869
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9262187088274044
	steps: 0.0	0.2813852813852813
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5454545454545455
	steps: 0.0	0.1
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [05:40<00:00,  3.62s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.9035705878386102
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5312575867388701
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=3, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:16,  3.40s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:16,  3.40s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:05,  2.67s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:05,  2.67s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:53,  3.22s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:53,  3.22s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<04:17,  2.86s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<04:17,  2.86s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:15<04:43,  3.19s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:15<04:43,  3.19s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:17<03:50,  2.62s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:17<03:50,  2.62s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:33,  2.45s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:33,  2.45s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:59,  2.09s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:59,  2.09s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:41,  1.90s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:41,  1.90s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:28<04:40,  3.34s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:28<04:40,  3.34s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:30<03:59,  2.88s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:30<03:59,  2.88s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:32<03:35,  2.63s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:32<03:35,  2.63s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:36<04:20,  3.21s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:36<04:20,  3.21s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:41<04:54,  3.68s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:41<04:54,  3.68s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:45<04:53,  3.72s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:45<04:53,  3.72s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:52<05:57,  4.58s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:52<05:57,  4.58s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:55<05:33,  4.34s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:55<05:33,  4.34s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:12,  4.11s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:12,  4.11s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:01<04:33,  3.64s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:01<04:33,  3.64s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:05<04:26,  3.60s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:05<04:26,  3.60s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:13<05:57,  4.90s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:13<05:57,  4.90s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:18<05:54,  4.92s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:18<05:54,  4.92s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:21<05:19,  4.50s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:21<05:19,  4.50s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:28<06:06,  5.24s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:28<06:06,  5.24s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:31<05:13,  4.54s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:31<05:13,  4.54s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:34<04:24,  3.89s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:34<04:24,  3.89s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:39<04:51,  4.35s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:39<04:51,  4.35s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:42<04:15,  3.87s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:42<04:15,  3.87s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:43<03:12,  2.96s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:43<03:12,  2.96s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:47<03:35,  3.37s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:47<03:35,  3.37s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:49<03:14,  3.09s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:49<03:14,  3.09s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:53<03:22,  3.26s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:53<03:22,  3.26s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:55<02:58,  2.92s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:55<02:58,  2.92s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:00<03:36,  3.61s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:00<03:36,  3.61s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:02<02:59,  3.04s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:02<02:59,  3.04s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:04<02:30,  2.59s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:04<02:30,  2.59s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:07<02:36,  2.75s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:07<02:36,  2.75s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:11<02:59,  3.21s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:11<02:59,  3.21s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:15<03:07,  3.41s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:15<03:07,  3.41s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:17<02:46,  3.08s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:17<02:46,  3.08s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:21<02:47,  3.17s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:21<02:47,  3.17s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:22<02:08,  2.48s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:22<02:08,  2.48s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:27<02:48,  3.30s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:27<02:48,  3.30s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:38<04:42,  5.65s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:38<04:42,  5.65s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:45<04:53,  5.98s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:45<04:53,  5.98s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:54<05:38,  7.06s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:54<05:38,  7.06s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:00<05:10,  6.61s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:00<05:10,  6.61s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:07<05:18,  6.92s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:07<05:18,  6.92s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:12<04:36,  6.14s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:12<04:36,  6.14s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:17<04:19,  5.90s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:17<04:19,  5.90s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:26<04:57,  6.93s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:26<04:57,  6.93s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:31<04:21,  6.24s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:31<04:21,  6.24s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:35<03:48,  5.56s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:35<03:48,  5.56s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:37<03:03,  4.59s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:37<03:03,  4.59s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:41<02:44,  4.22s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:41<02:44,  4.22s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:44<02:24,  3.81s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:44<02:24,  3.81s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:50<02:49,  4.58s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:50<02:49,  4.58s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:53<02:32,  4.24s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:53<02:32,  4.24s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:55<02:01,  3.48s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:55<02:01,  3.48s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:11<04:07,  7.29s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:11<04:07,  7.29s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:17<03:42,  6.76s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:17<03:42,  6.76s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:22<03:17,  6.17s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:22<03:17,  6.17s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:24<02:36,  5.04s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:24<02:36,  5.04s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:33<03:09,  6.33s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:33<03:09,  6.33s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:45<03:53,  8.07s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:45<03:53,  8.07s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:49<03:09,  6.77s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:49<03:09,  6.77s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:51<02:20,  5.19s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:51<02:20,  5.19s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:52<01:44,  4.04s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:52<01:44,  4.04s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:56<01:37,  3.91s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:56<01:37,  3.91s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:58<01:23,  3.49s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:58<01:23,  3.49s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:00<01:11,  3.09s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:00<01:11,  3.09s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:03<01:04,  2.94s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:03<01:04,  2.94s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:05<00:57,  2.75s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:05<00:57,  2.75s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:08<00:53,  2.66s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:08<00:53,  2.66s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:10<00:50,  2.66s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:10<00:50,  2.66s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:13<00:47,  2.63s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:13<00:47,  2.63s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:14<00:35,  2.09s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:14<00:35,  2.09s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:15<00:31,  1.98s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:15<00:31,  1.98s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:17<00:26,  1.74s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:17<00:26,  1.74s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:20<00:30,  2.19s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:20<00:30,  2.19s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:22<00:29,  2.29s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:22<00:29,  2.29s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:26<00:33,  2.82s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:26<00:33,  2.82s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:29<00:30,  2.76s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:29<00:30,  2.76s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:31<00:26,  2.63s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:31<00:26,  2.63s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:33<00:20,  2.33s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:33<00:20,  2.33s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:35<00:18,  2.37s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:35<00:18,  2.37s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:40<00:20,  2.91s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:40<00:20,  2.91s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:41<00:14,  2.39s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:41<00:14,  2.39s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:43<00:11,  2.31s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:43<00:11,  2.31s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:44<00:08,  2.05s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:44<00:08,  2.05s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:46<00:05,  1.99s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:46<00:05,  1.99s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:48<00:03,  1.92s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:48<00:03,  1.92s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:52<00:02,  2.43s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:52<00:02,  2.43s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:53<00:00,  1.98s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:53<00:00,  1.98s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9215686274509803	0.9865546218487395
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.578125	0.912728851010101
	steps: 0.40625	0.5089285714285715
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.5	0.9051626944484088
	steps: 0.17857142857142858	0.38707740672026386
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.8731896190229524
	steps: 0.16666666666666666	0.37891213724547057
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7685692750529617
	steps: 0.0	0.15789821038689816
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6511573860313355
	steps: 0.0	0.17767470624613482
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.74004144004144
	steps: 0.0	0.23163919413919412
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.8	0.9714285714285715
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9104247104247104
	steps: 0.5135135135135135	0.5774774774774775
	proof: 0.5135135135135135	0.5135135135135135
13 trees have size 6
	leaves: 0.46153846153846156	0.8967032967032966
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6153846153846154	0.9236263736263736
	steps: 0.3076923076923077	0.46703296703296704
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9595959595959596
	steps: 0.0	0.21333333333333332
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9097979797979798
	steps: 0.1	0.3329365079365079
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.39682539682539686
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8362573934002506
	steps: 0.14285714285714285	0.284018759018759
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 0.0	0.923076923076923
	steps: 0.0	0.9090909090909091
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.8818181818181818
	steps: 0.0	0.2077922077922078
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7689075630252101
	steps: 0.0	0.1678321678321678
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.672611865258924
	steps: 0.0	0.20270840270840274
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7946428571428572
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7529239766081871
	steps: 0.0	0.1736694677871148
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7692307692307693
	steps: 0.0	0.2
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7391562685680332
	steps: 0.0	0.14682539682539683
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.6666666666666666	0.9743589743589743
	steps: 0.0	0.2828282828282828
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5454545454545455
	steps: 0.0	0.1
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [05:53<00:00,  3.76s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.9025703298612687
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5289638998588353
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=4, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:06,  3.94s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:06,  3.94s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:05,  3.32s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:05,  3.32s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:33,  3.66s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:33,  3.66s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:46,  3.19s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:46,  3.19s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:23,  3.64s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:23,  3.64s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:28,  3.05s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:28,  3.05s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:01,  2.78s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:01,  2.78s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:20,  2.33s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:20,  2.33s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<02:56,  2.08s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<02:56,  2.08s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:35<06:40,  4.77s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:35<06:40,  4.77s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:37<05:25,  3.92s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:37<05:25,  3.92s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<04:37,  3.39s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<04:37,  3.39s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:44<05:05,  3.77s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:44<05:05,  3.77s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:50<05:48,  4.36s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:50<05:48,  4.36s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:54<05:33,  4.22s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:54<05:33,  4.22s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:00<06:22,  4.90s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:00<06:22,  4.90s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:04<05:58,  4.65s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:04<05:58,  4.65s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:08<05:33,  4.39s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:08<05:33,  4.39s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:11<04:50,  3.87s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:11<04:50,  3.87s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:15<05:10,  4.19s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:15<05:10,  4.19s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:20<05:11,  4.26s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:20<05:11,  4.26s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:25<05:14,  4.37s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:25<05:14,  4.37s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:29<05:03,  4.28s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:29<05:03,  4.28s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:34<05:28,  4.69s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:34<05:28,  4.69s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:37<04:38,  4.03s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:37<04:38,  4.03s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:39<04:03,  3.58s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:39<04:03,  3.58s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:45<04:36,  4.13s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:45<04:36,  4.13s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:47<04:05,  3.72s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:47<04:05,  3.72s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:49<03:10,  2.93s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:49<03:10,  2.93s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:53<03:32,  3.32s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:53<03:32,  3.32s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:56<03:30,  3.34s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:56<03:30,  3.34s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:59<03:27,  3.34s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:59<03:27,  3.34s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:02<03:03,  3.00s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:02<03:03,  3.00s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:06<03:27,  3.46s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:06<03:27,  3.46s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:08<02:54,  2.95s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:08<02:54,  2.95s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:10<02:35,  2.68s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:10<02:35,  2.68s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:13<02:41,  2.83s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:13<02:41,  2.83s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:24<04:54,  5.26s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:24<04:54,  5.26s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:30<04:53,  5.34s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:30<04:53,  5.34s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:32<04:00,  4.46s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:32<04:00,  4.46s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:38<04:13,  4.78s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:38<04:13,  4.78s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:39<03:07,  3.61s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:39<03:07,  3.61s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:42<03:08,  3.69s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:42<03:08,  3.69s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:54<05:03,  6.07s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:54<05:03,  6.07s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:07<06:36,  8.08s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:07<06:36,  8.08s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:23<08:25, 10.54s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:23<08:25, 10.54s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:30<07:30,  9.59s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:30<07:30,  9.59s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:36<06:21,  8.30s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:36<06:21,  8.30s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:40<05:21,  7.14s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:40<05:21,  7.14s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:48<05:17,  7.21s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:48<05:17,  7.21s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:57<05:41,  7.95s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:57<05:41,  7.95s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:03<05:05,  7.28s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:03<05:05,  7.28s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:07<04:22,  6.40s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:07<04:22,  6.40s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:10<03:27,  5.20s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:10<03:27,  5.20s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:13<03:01,  4.65s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:13<03:01,  4.65s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:16<02:42,  4.28s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:16<02:42,  4.28s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:20<02:31,  4.11s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:20<02:31,  4.11s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:24<02:22,  3.95s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:24<02:22,  3.95s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:25<01:53,  3.24s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:25<01:53,  3.24s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:37<03:13,  5.69s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:37<03:13,  5.69s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:42<03:05,  5.63s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:42<03:05,  5.63s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:45<02:34,  4.82s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:45<02:34,  4.82s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:48<02:07,  4.11s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:48<02:07,  4.11s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:59<03:08,  6.30s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:59<03:08,  6.30s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:20<05:12, 10.77s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:20<05:12, 10.77s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:26<04:16,  9.15s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:26<04:16,  9.15s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:28<03:09,  7.00s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:28<03:09,  7.00s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:29<02:18,  5.31s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:29<02:18,  5.31s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:32<01:52,  4.51s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:32<01:52,  4.51s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:35<01:37,  4.06s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:35<01:37,  4.06s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:36<01:17,  3.36s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:36<01:17,  3.36s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:39<01:09,  3.17s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:39<01:09,  3.17s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:41<01:01,  2.95s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:41<01:01,  2.95s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:46<01:08,  3.44s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:46<01:08,  3.44s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:49<01:01,  3.23s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:49<01:01,  3.23s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:51<00:55,  3.06s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:51<00:55,  3.06s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:52<00:41,  2.41s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:52<00:41,  2.41s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:55<00:39,  2.44s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:55<00:39,  2.44s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:56<00:32,  2.18s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:56<00:32,  2.18s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:00<00:35,  2.55s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:00<00:35,  2.55s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:03<00:36,  2.81s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:03<00:36,  2.81s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:06<00:34,  2.90s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:06<00:34,  2.90s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:09<00:31,  2.85s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:09<00:31,  2.85s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:11<00:25,  2.52s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:11<00:25,  2.52s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:13<00:20,  2.27s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:13<00:20,  2.27s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:16<00:20,  2.55s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:16<00:20,  2.55s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:19<00:18,  2.69s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:19<00:18,  2.69s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:20<00:13,  2.27s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:20<00:13,  2.27s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:23<00:11,  2.38s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:23<00:11,  2.38s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:24<00:08,  2.11s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:24<00:08,  2.11s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:26<00:05,  1.88s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:26<00:05,  1.88s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:27<00:03,  1.88s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:27<00:03,  1.88s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:32<00:02,  2.76s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:32<00:02,  2.76s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:33<00:00,  2.25s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:33<00:00,  2.25s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9893557422969187
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.546875	0.9070402687590189
	steps: 0.390625	0.49759424603174607
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.4642857142857143	0.8979348032919461
	steps: 0.17857142857142858	0.4106292517006803
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8855439313772648
	steps: 0.2222222222222222	0.3700737534070867
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.0	0.7480257160478643
	steps: 0.0	0.2428326324253926
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6269441109777245
	steps: 0.0	0.13814371902607198
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7219620958751394
	steps: 0.0	0.2269073519073519
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8967032967032966
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5	0.9156898656898658
	steps: 0.3076923076923077	0.47912087912087914
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9097979797979798
	steps: 0.1	0.3392857142857143
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8243526314954887
	steps: 0.14285714285714285	0.2849206349206349
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9151515151515153
	steps: 0.0	0.27922077922077926
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.23076923076923073
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6598392348392349
	steps: 0.0	0.20192552545493725
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.26515151515151514
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.21241830065359477
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6633986928104575
	steps: 0.0	0.0892857142857143
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.8949938949938949
	steps: 0.0	0.30151515151515146
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:33<00:00,  4.19s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5614973262032086
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.8985796843604411
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5320334370114176
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=5, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:18,  4.07s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:18,  4.07s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:22,  3.50s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:22,  3.50s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:42,  3.76s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:42,  3.76s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:50,  3.23s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:50,  3.23s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:07,  3.45s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:07,  3.45s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:26,  3.02s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:26,  3.02s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<03:48,  2.62s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<03:48,  2.62s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:22<03:11,  2.23s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:22<03:11,  2.23s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<02:51,  2.02s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<02:51,  2.02s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<08:17,  5.92s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<08:17,  5.92s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:32,  4.73s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:32,  4.73s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:24,  3.96s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:24,  3.96s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:48<05:41,  4.21s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:48<05:41,  4.21s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:52<05:44,  4.30s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:52<05:44,  4.30s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:55<05:12,  3.96s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:55<05:12,  3.96s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:05<07:16,  5.60s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:05<07:16,  5.60s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:09<06:37,  5.16s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:09<06:37,  5.16s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<05:52,  4.63s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<05:52,  4.63s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:15<05:03,  4.05s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:15<05:03,  4.05s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:19<05:02,  4.09s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:19<05:02,  4.09s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:25<05:48,  4.78s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:25<05:48,  4.78s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:36<07:51,  6.55s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:36<07:51,  6.55s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:41<07:18,  6.18s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:41<07:18,  6.18s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:46<06:42,  5.75s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:46<06:42,  5.75s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:49<05:26,  4.73s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:49<05:26,  4.73s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:51<04:36,  4.07s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:51<04:36,  4.07s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:58<05:35,  5.01s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:58<05:35,  5.01s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:01<04:52,  4.44s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:01<04:52,  4.44s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:03<03:44,  3.45s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:03<03:44,  3.45s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:08<04:24,  4.14s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:08<04:24,  4.14s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:11<03:50,  3.66s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:11<03:50,  3.66s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:16<04:16,  4.13s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:16<04:16,  4.13s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:18<03:37,  3.57s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:18<03:37,  3.57s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:27<04:58,  4.98s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:27<04:58,  4.98s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:28<03:54,  3.97s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:28<03:54,  3.97s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:30<03:18,  3.42s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:30<03:18,  3.42s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:34<03:12,  3.37s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:34<03:12,  3.37s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:41<04:13,  4.53s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:41<04:13,  4.53s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:49<05:11,  5.67s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:49<05:11,  5.67s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:52<04:16,  4.76s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:52<04:16,  4.76s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:55<03:52,  4.38s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:55<03:52,  4.38s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:56<02:53,  3.34s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:56<02:53,  3.34s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:02<03:32,  4.17s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:02<03:32,  4.17s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:15<05:42,  6.86s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:15<05:42,  6.86s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:28<06:59,  8.56s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:28<06:59,  8.56s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:39<07:32,  9.43s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:39<07:32,  9.43s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:47<06:58,  8.91s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:47<06:58,  8.91s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:02<08:14, 10.74s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:02<08:14, 10.74s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:06<06:35,  8.78s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:06<06:35,  8.78s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:17<06:52,  9.37s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:17<06:52,  9.37s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:26<06:37,  9.24s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:26<06:37,  9.24s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:31<05:34,  7.96s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:31<05:34,  7.96s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:34<04:28,  6.54s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:34<04:28,  6.54s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:37<03:31,  5.28s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:37<03:31,  5.28s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:43<03:38,  5.61s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:43<03:38,  5.61s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:46<03:06,  4.90s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:46<03:06,  4.90s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:53<03:22,  5.48s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:53<03:22,  5.48s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:00<03:36,  6.01s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:00<03:36,  6.01s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:02<02:45,  4.73s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:02<02:45,  4.73s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:22<05:14,  9.24s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:22<05:14,  9.24s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:29<04:42,  8.55s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:29<04:42,  8.55s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:34<04:03,  7.61s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:34<04:03,  7.61s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:37<03:08,  6.08s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:37<03:08,  6.08s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:46<03:34,  7.14s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:46<03:34,  7.14s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:55<03:42,  7.67s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:55<03:42,  7.67s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:59<03:04,  6.59s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:59<03:04,  6.59s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:01<02:17,  5.09s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:01<02:17,  5.09s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:02<01:43,  3.98s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:02<01:43,  3.98s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:06<01:39,  3.97s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:06<01:39,  3.97s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:09<01:27,  3.63s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:09<01:27,  3.63s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:11<01:10,  3.05s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:11<01:10,  3.05s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:15<01:12,  3.28s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:15<01:12,  3.28s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:17<01:00,  2.89s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:17<01:00,  2.89s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:20<01:03,  3.16s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:20<01:03,  3.16s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:24<01:05,  3.44s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:24<01:05,  3.44s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:28<01:01,  3.39s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:28<01:01,  3.39s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:29<00:45,  2.65s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:29<00:45,  2.65s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:31<00:42,  2.63s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:31<00:42,  2.63s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:33<00:36,  2.40s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:33<00:36,  2.40s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:37<00:38,  2.75s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:37<00:38,  2.75s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:39<00:36,  2.78s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:39<00:36,  2.78s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:44<00:38,  3.24s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:44<00:38,  3.24s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:47<00:35,  3.23s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:47<00:35,  3.23s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:50<00:30,  3.04s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:50<00:30,  3.04s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:51<00:23,  2.66s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:51<00:23,  2.66s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:57<00:27,  3.41s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:57<00:27,  3.41s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:01<00:25,  3.63s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:01<00:25,  3.63s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:02<00:17,  2.96s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:02<00:17,  2.96s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:05<00:14,  2.96s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:05<00:14,  2.96s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:06<00:10,  2.50s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:06<00:10,  2.50s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:08<00:06,  2.30s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:08<00:06,  2.30s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:14<00:06,  3.37s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:14<00:06,  3.37s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:17<00:03,  3.25s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:17<00:03,  3.25s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:18<00:00,  2.60s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:18<00:00,  2.60s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9047235750360749
	steps: 0.40625	0.5042410714285714
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.4642857142857143	0.8837166801452516
	steps: 0.17857142857142858	0.3504844361987219
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8822611030944364
	steps: 0.16666666666666666	0.379333012666346
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7767122005035794
	steps: 0.0	0.19074021755017231
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5979963645377181
	steps: 0.0	0.1429971988795518
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7789796397347885
	steps: 0.0	0.21941186359344925
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.8917082917082916
	steps: 0.38461538461538464	0.5153846153846153
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5384615384615384	0.9004273504273504
	steps: 0.3076923076923077	0.4322344322344322
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.9057070707070707
	steps: 0.1	0.3511183261183261
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8360575932004503
	steps: 0.14285714285714285	0.29143990929705216
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 0.0	0.6666666666666665
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.9005681818181819
	steps: 0.0	0.203030303030303
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.16025641025641024
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6541947818263608
	steps: 0.0	0.15278022630963808
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7451923076923077
	steps: 0.0	0.26515151515151514
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6402116402116402
	steps: 0.0	0.173202614379085
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.37499999999999994
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7529239766081871
	steps: 0.0	0.08366013071895424
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9217273954116059
	steps: 0.0	0.29175293305728084
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:18<00:00,  4.67s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.8988459181753744
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5225136974056515
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=6, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:07,  3.31s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:07,  3.31s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:34,  2.98s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:34,  2.98s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:26,  3.58s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:26,  3.58s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:49,  3.21s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:49,  3.21s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:19,  3.59s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:19,  3.59s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:31,  3.09s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:31,  3.09s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:28,  3.09s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:28,  3.09s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:38,  2.54s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:38,  2.54s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:04,  2.16s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:04,  2.16s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:49<12:33,  8.97s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:49<12:33,  8.97s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:51<09:29,  6.86s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:51<09:29,  6.86s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:53<07:34,  5.54s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:53<07:34,  5.54s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:59<07:31,  5.57s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:59<07:31,  5.57s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:05<07:44,  5.81s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:05<07:44,  5.81s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:09<06:39,  5.06s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:09<06:39,  5.06s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:20<09:09,  7.05s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:20<09:09,  7.05s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:25<07:57,  6.20s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:25<07:57,  6.20s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:28<06:48,  5.37s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:28<06:48,  5.37s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<05:44,  4.59s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<05:44,  4.59s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:36<05:43,  4.64s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:36<05:43,  4.64s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:44<07:09,  5.88s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:44<07:09,  5.88s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:01<10:46,  8.98s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:01<10:46,  8.98s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:07<09:35,  8.11s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:07<09:35,  8.11s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:12<08:37,  7.40s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:12<08:37,  7.40s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:16<07:01,  6.11s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:16<07:01,  6.11s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:18<05:45,  5.08s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:18<05:45,  5.08s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:27<07:01,  6.29s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:27<07:01,  6.29s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:30<05:46,  5.25s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:30<05:46,  5.25s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:31<04:21,  4.02s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:31<04:21,  4.02s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:39<05:31,  5.18s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:39<05:31,  5.18s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:42<04:43,  4.50s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:42<04:43,  4.50s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:48<05:06,  4.94s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:48<05:06,  4.94s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:50<04:13,  4.15s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:50<04:13,  4.15s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:00<05:48,  5.80s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:00<05:48,  5.80s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:02<04:29,  4.56s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:02<04:29,  4.56s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:03<03:34,  3.70s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:03<03:34,  3.70s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:07<03:32,  3.72s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:07<03:32,  3.72s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:17<05:18,  5.69s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:17<05:18,  5.69s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:23<05:07,  5.59s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:23<05:07,  5.59s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:27<04:36,  5.11s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:27<04:36,  5.11s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:35<05:23,  6.10s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:35<05:23,  6.10s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:37<04:03,  4.68s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:37<04:03,  4.68s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:45<04:49,  5.67s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:45<04:49,  5.67s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:59<06:58,  8.37s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:59<06:58,  8.37s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:09<07:13,  8.85s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:09<07:13,  8.85s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:20<07:29,  9.37s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:20<07:29,  9.37s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:33<08:09, 10.42s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:33<08:09, 10.42s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:41<07:27,  9.73s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:41<07:27,  9.73s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:45<06:04,  8.11s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:45<06:04,  8.11s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:53<05:56,  8.10s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:53<05:56,  8.10s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:08<07:19, 10.23s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:08<07:19, 10.23s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:14<06:12,  8.86s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:14<06:12,  8.86s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:18<04:59,  7.30s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:18<04:59,  7.30s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:20<03:53,  5.83s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:20<03:53,  5.83s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:24<03:19,  5.12s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:24<03:19,  5.12s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:27<02:50,  4.50s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:27<02:50,  4.50s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:37<03:53,  6.30s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:37<03:53,  6.30s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:43<03:46,  6.28s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:43<03:46,  6.28s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:45<02:52,  4.94s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:45<02:52,  4.94s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:02<04:45,  8.39s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:02<04:45,  8.39s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:10<04:35,  8.36s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:10<04:35,  8.36s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:14<03:47,  7.10s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:14<03:47,  7.10s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:17<02:57,  5.73s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:17<02:57,  5.73s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:38<05:16, 10.56s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:38<05:16, 10.56s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:49<05:02, 10.44s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:49<05:02, 10.44s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:52<03:49,  8.21s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:52<03:49,  8.21s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:54<02:52,  6.38s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:54<02:52,  6.38s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:55<02:09,  4.99s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:55<02:09,  4.99s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:58<01:49,  4.37s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:58<01:49,  4.37s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:02<01:36,  4.04s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:02<01:36,  4.04s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:03<01:17,  3.36s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:03<01:17,  3.36s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:09<01:28,  4.02s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:09<01:28,  4.02s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:11<01:14,  3.57s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:11<01:14,  3.57s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:15<01:09,  3.50s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:15<01:09,  3.50s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:18<01:03,  3.36s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:18<01:03,  3.36s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:21<01:00,  3.38s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:21<01:00,  3.38s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:23<00:47,  2.79s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:23<00:47,  2.79s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:25<00:43,  2.74s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:25<00:43,  2.74s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:27<00:37,  2.48s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:27<00:37,  2.48s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:32<00:45,  3.27s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:32<00:45,  3.27s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:38<00:53,  4.14s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:38<00:53,  4.14s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:45<00:58,  4.85s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:45<00:58,  4.85s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:48<00:47,  4.29s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:48<00:47,  4.29s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:50<00:35,  3.56s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:50<00:35,  3.56s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:52<00:27,  3.03s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:52<00:27,  3.03s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:57<00:29,  3.68s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:57<00:29,  3.68s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:00<00:25,  3.60s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:00<00:25,  3.60s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:02<00:17,  2.95s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:02<00:17,  2.95s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:04<00:13,  2.70s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:04<00:13,  2.70s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:05<00:09,  2.35s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:05<00:09,  2.35s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:07<00:06,  2.23s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:07<00:06,  2.23s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:12<00:05,  2.87s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:12<00:05,  2.87s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:16<00:03,  3.18s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:16<00:03,  3.18s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:17<00:00,  2.58s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:17<00:00,  2.58s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9094584235209235
	steps: 0.40625	0.5049851190476191
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.42857142857142855	0.8883368615511473
	steps: 0.14285714285714285	0.3288265306122448
	proof: 0.14285714285714285	0.14285714285714285
18 trees have depth 4
	leaves: 0.3888888888888889	0.8855479397146063
	steps: 0.1111111111111111	0.34001523168189834
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.07692307692307693	0.7836563511902879
	steps: 0.0	0.2217380407425656
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5855018930649184
	steps: 0.0	0.14292080468551058
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7650471589602024
	steps: 0.0	0.17343813593813592
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9150183150183151
	steps: 0.38461538461538464	0.5373626373626373
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5384615384615384	0.9130952380952382
	steps: 0.2692307692307692	0.41346153846153844
	proof: 0.2692307692307692	0.2692307692307692
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.3	0.8768181818181819
	steps: 0.1	0.29325396825396827
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.85583781298067
	steps: 0.07142857142857142	0.2654195011337869
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 0.0	0.8571428571428571
	steps: 0.0	0.5454545454545454
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.9151515151515153
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6273629964806435
	steps: 0.0	0.1553054788348906
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8750000000000001
	steps: 0.0	0.2532467532467533
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.57703081232493
	steps: 0.0	0.173202614379085
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.3529411764705882
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7761933056050703
	steps: 0.0	0.08088235294117647
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8143417366946778
	steps: 0.0	0.17460317460317457
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.6458333333333333
	steps: 0.0	0.05
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [08:17<00:00,  5.29s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5561497326203209
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8995656280114066
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5164178268692267
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=7, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:21,  4.11s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:21,  4.11s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:05,  3.32s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:05,  3.32s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:31,  4.31s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:31,  4.31s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:04,  3.38s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:04,  3.38s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:18<05:40,  3.83s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:18<05:40,  3.83s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:27,  3.04s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:27,  3.04s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:23<04:28,  3.08s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:23<04:28,  3.08s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:25<03:38,  2.55s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:25<03:38,  2.55s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:11,  2.25s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:11,  2.25s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<05:45,  4.11s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<05:45,  4.11s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:37<04:50,  3.50s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:37<04:50,  3.50s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<04:23,  3.22s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<04:23,  3.22s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:44<05:07,  3.79s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:44<05:07,  3.79s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<08:36,  6.46s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<08:36,  6.46s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:00<07:13,  5.49s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:00<07:13,  5.49s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:07<07:36,  5.85s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:07<07:36,  5.85s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:12<07:09,  5.58s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:12<07:09,  5.58s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:16<06:36,  5.22s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:16<06:36,  5.22s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:19<05:38,  4.51s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:19<05:38,  4.51s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:23<05:19,  4.32s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:23<05:19,  4.32s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:32<07:08,  5.87s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:32<07:08,  5.87s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:37<06:30,  5.42s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:37<06:30,  5.42s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:45<07:22,  6.24s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:45<07:22,  6.24s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:50<06:51,  5.88s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:50<06:51,  5.88s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:53<05:38,  4.91s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:53<05:38,  4.91s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:55<04:49,  4.25s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:55<04:49,  4.25s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:01<05:24,  4.84s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:01<05:24,  4.84s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:04<04:40,  4.25s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:04<04:40,  4.25s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:06<03:36,  3.34s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:06<03:36,  3.34s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:11<04:09,  3.90s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:11<04:09,  3.90s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:16<04:29,  4.28s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:16<04:29,  4.28s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:22<04:51,  4.71s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:22<04:51,  4.71s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:24<04:04,  4.01s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:24<04:04,  4.01s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:34<05:48,  5.81s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:34<05:48,  5.81s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:36<04:33,  4.64s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:36<04:33,  4.64s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:38<03:38,  3.77s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:38<03:38,  3.77s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:41<03:28,  3.66s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:41<03:28,  3.66s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:49<04:39,  5.00s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:49<04:39,  5.00s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:57<05:19,  5.81s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:57<05:19,  5.81s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:01<04:40,  5.20s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:01<04:40,  5.20s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:06<04:42,  5.33s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:06<04:42,  5.33s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:08<03:34,  4.13s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:08<03:34,  4.13s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:15<04:28,  5.26s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:15<04:28,  5.26s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:21<04:23,  5.27s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:21<04:23,  5.27s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:31<05:23,  6.61s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:31<05:23,  6.61s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:50<08:27, 10.58s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:50<08:27, 10.58s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:05<09:10, 11.72s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:05<09:10, 11.72s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:21<09:56, 12.97s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:21<09:56, 12.97s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:24<07:30, 10.00s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:24<07:30, 10.00s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:33<07:07,  9.71s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:33<07:07,  9.71s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:42<06:50,  9.54s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:42<06:50,  9.54s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:47<05:47,  8.28s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:47<05:47,  8.28s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:53<05:06,  7.47s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:53<05:06,  7.47s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:55<03:59,  5.99s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:55<03:59,  5.99s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:59<03:30,  5.40s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:59<03:30,  5.40s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:02<02:57,  4.67s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:02<02:57,  4.67s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:07<02:47,  4.53s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:07<02:47,  4.53s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:10<02:35,  4.32s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:10<02:35,  4.32s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:12<02:05,  3.58s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:12<02:05,  3.58s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:29<04:19,  7.62s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:29<04:19,  7.62s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:39<04:35,  8.35s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:39<04:35,  8.35s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:42<03:34,  6.71s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:42<03:34,  6.71s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:45<02:50,  5.50s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:45<02:50,  5.50s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:00<04:15,  8.52s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:00<04:15,  8.52s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:15<04:58, 10.30s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:15<04:58, 10.30s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:18<03:47,  8.14s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:18<03:47,  8.14s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:21<02:58,  6.60s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:21<02:58,  6.60s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:23<02:14,  5.16s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:23<02:14,  5.16s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:26<01:51,  4.45s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:26<01:51,  4.45s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:28<01:35,  3.98s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:28<01:35,  3.98s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:30<01:16,  3.32s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:30<01:16,  3.32s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:37<01:37,  4.44s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:37<01:37,  4.44s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:40<01:24,  4.02s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:40<01:24,  4.02s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:44<01:21,  4.05s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:44<01:21,  4.05s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:48<01:15,  3.96s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:48<01:15,  3.96s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:53<01:16,  4.24s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:53<01:16,  4.24s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:55<00:57,  3.41s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:55<00:57,  3.41s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:57<00:50,  3.18s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:57<00:50,  3.18s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:59<00:42,  2.82s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:59<00:42,  2.82s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:03<00:42,  3.05s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:03<00:42,  3.05s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:17<01:21,  6.28s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:17<01:21,  6.28s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:22<01:10,  5.89s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:22<01:10,  5.89s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:24<00:53,  4.89s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:24<00:53,  4.89s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:26<00:39,  4.00s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:26<00:39,  4.00s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:28<00:30,  3.38s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:28<00:30,  3.38s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:34<00:34,  4.29s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:34<00:34,  4.29s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:38<00:29,  4.16s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:38<00:29,  4.16s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:40<00:20,  3.36s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:40<00:20,  3.36s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:42<00:15,  3.12s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:42<00:15,  3.12s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:44<00:10,  2.67s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:44<00:10,  2.67s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:46<00:07,  2.37s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:46<00:07,  2.37s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:52<00:07,  3.54s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:52<00:07,  3.54s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:57<00:03,  3.89s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:57<00:03,  3.89s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:58<00:00,  3.08s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:58<00:00,  3.08s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.546875	0.9064202290764791
	steps: 0.40625	0.5034970238095239
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.5	0.9162498216069646
	steps: 0.17857142857142858	0.360062358276644
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3333333333333333	0.8744368286034953
	steps: 0.1111111111111111	0.3758257174923842
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.07692307692307693	0.7367047607997834
	steps: 0.0	0.2100910401815379
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6045787545787545
	steps: 0.0	0.14775910364145656
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7501154240284674
	steps: 0.0	0.15940893901420217
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9021978021978021
	steps: 0.38461538461538464	0.5153846153846153
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5769230769230769	0.9362026862026862
	steps: 0.3076923076923077	0.440018315018315
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9095959595959597
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8968181818181818
	steps: 0.1	0.332936507936508
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8280822352250924
	steps: 0.07142857142857142	0.28134920634920635
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 0.0	0.8571428571428571
	steps: 0.0	0.9090909090909091
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.8741258741258742
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.788888888888889
	steps: 0.0	0.2976190476190476
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6013431013431013
	steps: 0.0	0.13714063714063712
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7451923076923077
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6872082166199812
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.4
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7314814814814814
	steps: 0.0	0.08088235294117647
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8699818699818699
	steps: 0.0	0.24953314659197012
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.6458333333333333
	steps: 0.0	0.05263157894736842
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:58<00:00,  5.09s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5561497326203209
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.8986067797924139
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5229538468040313
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=8, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:48,  3.74s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:48,  3.74s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:06,  3.33s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:06,  3.33s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:31,  3.64s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:31,  3.64s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:26,  2.97s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:26,  2.97s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:52,  3.28s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:52,  3.28s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:15,  2.91s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:15,  2.91s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:14,  2.92s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:14,  2.92s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:30,  2.45s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:30,  2.45s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:07,  2.20s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:07,  2.20s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:41<09:14,  6.60s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:41<09:14,  6.60s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:43<07:14,  5.24s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:43<07:14,  5.24s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:46<06:15,  4.58s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:46<06:15,  4.58s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:56<08:20,  6.17s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:56<08:20,  6.17s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:08<10:35,  7.94s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:08<10:35,  7.94s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:15<10:00,  7.60s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:15<10:00,  7.60s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:20<08:53,  6.84s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:20<08:53,  6.84s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:25<08:05,  6.30s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:25<08:05,  6.30s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:30<07:41,  6.07s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:30<07:41,  6.07s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:33<06:14,  4.99s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:33<06:14,  4.99s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:39<06:42,  5.44s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:39<06:42,  5.44s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:48<07:54,  6.50s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:48<07:54,  6.50s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:53<07:06,  5.92s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:53<07:06,  5.92s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:58<06:35,  5.57s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:58<06:35,  5.57s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:04<06:49,  5.86s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:04<06:49,  5.86s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:07<05:49,  5.07s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:07<05:49,  5.07s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:10<05:02,  4.44s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:10<05:02,  4.44s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:19<06:23,  5.72s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:19<06:23,  5.72s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:22<05:29,  4.99s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:22<05:29,  4.99s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:24<04:12,  3.88s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:24<04:12,  3.88s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:30<05:00,  4.70s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:30<05:00,  4.70s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:36<05:18,  5.06s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:36<05:18,  5.06s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:42<05:35,  5.41s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:42<05:35,  5.41s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:45<04:35,  4.52s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:45<04:35,  4.52s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:50<04:43,  4.73s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:50<04:43,  4.73s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:52<03:50,  3.91s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:52<03:50,  3.91s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:54<03:20,  3.46s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:54<03:20,  3.46s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:58<03:21,  3.53s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:58<03:21,  3.53s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:03<03:36,  3.87s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:03<03:36,  3.87s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:08<03:57,  4.32s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:08<03:57,  4.32s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:12<03:44,  4.15s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:12<03:44,  4.15s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:18<04:06,  4.64s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:18<04:06,  4.64s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:19<03:13,  3.73s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:19<03:13,  3.73s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:25<03:42,  4.36s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:25<03:42,  4.36s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:42<06:49,  8.18s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:42<06:49,  8.18s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:53<07:15,  8.89s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:53<07:15,  8.89s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:12<09:38, 12.04s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:12<09:38, 12.04s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:24<09:27, 12.07s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:24<09:27, 12.07s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:41<10:23, 13.55s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:41<10:23, 13.55s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:44<07:42, 10.28s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:44<07:42, 10.28s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:53<07:20, 10.02s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:53<07:20, 10.02s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:03<07:05,  9.89s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:03<07:05,  9.89s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:08<05:52,  8.40s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:08<05:52,  8.40s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:13<05:07,  7.49s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:13<05:07,  7.49s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:16<04:00,  6.02s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:16<04:00,  6.02s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:21<03:45,  5.78s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:21<03:45,  5.78s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:24<03:08,  4.96s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:24<03:08,  4.96s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:31<03:20,  5.41s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:31<03:20,  5.41s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:35<02:59,  4.98s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:35<02:59,  4.98s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:36<02:22,  4.06s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:36<02:22,  4.06s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:57<05:02,  8.89s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:57<05:02,  8.89s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:06<04:56,  8.97s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:06<04:56,  8.97s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:11<04:15,  8.00s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:11<04:15,  8.00s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:14<03:17,  6.38s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:14<03:17,  6.38s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:25<03:50,  7.70s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:25<03:50,  7.70s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:40<04:44,  9.80s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:40<04:44,  9.80s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:43<03:39,  7.82s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:43<03:39,  7.82s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:45<02:47,  6.22s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:45<02:47,  6.22s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:47<02:07,  4.90s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:47<02:07,  4.90s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:51<01:53,  4.53s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:51<01:53,  4.53s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:54<01:37,  4.08s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:54<01:37,  4.08s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:56<01:18,  3.41s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:56<01:18,  3.41s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:04<01:46,  4.83s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:04<01:46,  4.83s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:07<01:31,  4.34s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:07<01:31,  4.34s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:11<01:25,  4.27s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:11<01:25,  4.27s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:14<01:15,  3.96s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:14<01:15,  3.96s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:18<01:09,  3.84s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:18<01:09,  3.84s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:20<00:54,  3.23s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:20<00:54,  3.23s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:22<00:48,  3.03s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:22<00:48,  3.03s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:24<00:40,  2.71s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:24<00:40,  2.71s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:29<00:45,  3.24s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:29<00:45,  3.24s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:40<01:13,  5.64s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:40<01:13,  5.64s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:45<01:04,  5.39s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:45<01:04,  5.39s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:48<00:50,  4.63s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:48<00:50,  4.63s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:50<00:38,  3.82s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:50<00:38,  3.82s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:51<00:29,  3.27s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:51<00:29,  3.27s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:58<00:33,  4.17s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:58<00:33,  4.17s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:09<00:43,  6.20s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:09<00:43,  6.20s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:10<00:28,  4.80s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:10<00:28,  4.80s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:14<00:22,  4.47s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:14<00:22,  4.47s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:16<00:14,  3.67s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:16<00:14,  3.67s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:18<00:09,  3.19s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:18<00:09,  3.19s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:23<00:07,  3.93s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:23<00:07,  3.93s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:28<00:03,  3.99s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:28<00:03,  3.99s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:29<00:00,  3.16s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:29<00:00,  3.16s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9045105068542568
	steps: 0.390625	0.5019345238095239
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5	0.9071577232291519
	steps: 0.17857142857142858	0.3503684807256236
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8934844476511145
	steps: 0.1111111111111111	0.33920955587622253
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.0	0.7771071034228929
	steps: 0.0	0.2103396603396603
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6307456315859677
	steps: 0.0	0.1578601137424667
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7397758610573254
	steps: 0.0	0.16085793291675643
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9014859014859016
	steps: 0.4594594594594595	0.5504504504504505
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.5384615384615384	0.8945054945054947
	steps: 0.38461538461538464	0.5153846153846153
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.6538461538461539	0.9471916971916972
	steps: 0.3076923076923077	0.46639194139194134
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.3	0.8768181818181819
	steps: 0.1	0.3015873015873016
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.7878787878787878
	steps: 0.0	0.3928571428571429
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8796473367901939
	steps: 0.07142857142857142	0.28095238095238095
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 0.0	0.9090909090909091
	steps: 0.0	0.5
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.8741258741258742
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8210526315789475
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6017785319255907
	steps: 0.0	0.10402342755283933
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7451923076923077
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6349206349206349
	steps: 0.0	0.1984126984126984
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.9333333333333333
	steps: 0.0	0.4
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.854775828460039
	steps: 0.0	0.11328976034858389
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8960863697705803
	steps: 0.0	0.23931623931623933
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [08:29<00:00,  5.42s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5668449197860963
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.9018817390511316
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5178849356578202
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=9, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:06,  4.58s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:06,  4.58s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:32,  3.61s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:32,  3.61s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:41,  3.75s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:41,  3.75s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:33,  3.04s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:33,  3.04s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:08,  3.47s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:08,  3.47s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:31,  3.09s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:31,  3.09s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<03:48,  2.63s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<03:48,  2.63s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:17,  2.30s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:17,  2.30s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:01,  2.14s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:01,  2.14s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:33<05:56,  4.24s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:33<05:56,  4.24s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:00,  3.61s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:00,  3.61s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<04:43,  3.46s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<04:43,  3.46s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:45<05:51,  4.34s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:45<05:51,  4.34s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:56<08:26,  6.33s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:56<08:26,  6.33s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:06<09:35,  7.29s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:06<09:35,  7.29s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:16<10:45,  8.27s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:16<10:45,  8.27s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:21<09:24,  7.33s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:21<09:24,  7.33s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:29<09:15,  7.31s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:29<09:15,  7.31s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<07:18,  5.85s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<07:18,  5.85s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:39<08:08,  6.60s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:39<08:08,  6.60s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:52<10:05,  8.30s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:52<10:05,  8.30s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:57<08:50,  7.37s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:57<08:50,  7.37s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:03<08:11,  6.92s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:03<08:11,  6.92s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:10<08:03,  6.91s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:10<08:03,  6.91s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:13<06:40,  5.81s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:13<06:40,  5.81s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:16<05:34,  4.92s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:16<05:34,  4.92s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:25<07:01,  6.29s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:25<07:01,  6.29s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:28<05:49,  5.30s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:28<05:49,  5.30s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:30<04:33,  4.20s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:30<04:33,  4.20s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:37<05:26,  5.09s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:37<05:26,  5.09s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:42<05:25,  5.17s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:42<05:25,  5.17s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:49<05:49,  5.63s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:49<05:49,  5.63s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:51<04:45,  4.67s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:51<04:45,  4.67s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:59<05:25,  5.42s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:59<05:25,  5.42s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:01<04:19,  4.40s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:01<04:19,  4.40s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:03<03:34,  3.70s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:03<03:34,  3.70s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:06<03:31,  3.71s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:06<03:31,  3.71s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:15<04:47,  5.14s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:15<04:47,  5.14s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:23<05:34,  6.09s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:23<05:34,  6.09s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:28<05:02,  5.61s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:28<05:02,  5.61s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:44<07:54,  8.95s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:44<07:54,  8.95s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:46<05:52,  6.78s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:46<05:52,  6.78s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:53<05:51,  6.89s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:53<05:51,  6.89s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:12<08:46, 10.54s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:12<08:46, 10.54s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:24<08:49, 10.81s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:24<08:49, 10.81s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:39<09:43, 12.16s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:39<09:43, 12.16s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:46<08:24, 10.73s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:46<08:24, 10.73s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:02<09:17, 12.12s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:02<09:17, 12.12s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:06<07:18,  9.73s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:06<07:18,  9.73s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:23<08:42, 11.88s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:23<08:42, 11.88s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:32<08:01, 11.20s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:32<08:01, 11.20s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:42<07:32, 10.78s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:42<07:32, 10.78s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:46<05:58,  8.74s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:46<05:58,  8.74s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:49<04:36,  6.90s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:49<04:36,  6.90s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:54<04:10,  6.43s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:54<04:10,  6.43s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:58<03:28,  5.49s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:58<03:28,  5.49s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:04<03:32,  5.75s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:04<03:32,  5.75s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:12<03:55,  6.54s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:12<03:55,  6.54s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:14<03:00,  5.16s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:14<03:00,  5.16s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:46<07:25, 13.11s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:46<07:25, 13.11s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:56<06:44, 12.25s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:56<06:44, 12.25s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:00<05:16,  9.89s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:00<05:16,  9.89s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:03<04:00,  7.76s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:03<04:00,  7.76s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:16<04:35,  9.18s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:16<04:35,  9.18s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:27<04:46,  9.89s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:27<04:46,  9.89s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:31<03:40,  7.88s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:31<03:40,  7.88s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:34<02:56,  6.53s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:34<02:56,  6.53s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:36<02:13,  5.13s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:36<02:13,  5.13s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:39<01:53,  4.55s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:39<01:53,  4.55s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:42<01:38,  4.10s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:42<01:38,  4.10s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:44<01:19,  3.44s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:44<01:19,  3.44s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:50<01:31,  4.15s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:50<01:31,  4.15s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:53<01:21,  3.89s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:53<01:21,  3.89s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:57<01:18,  3.92s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:57<01:18,  3.92s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:00<01:11,  3.74s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:00<01:11,  3.74s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:05<01:10,  3.94s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:05<01:10,  3.94s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:07<00:56,  3.31s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:07<00:56,  3.31s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:09<00:50,  3.15s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:09<00:50,  3.15s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:11<00:41,  2.80s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:11<00:41,  2.80s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:16<00:46,  3.34s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:16<00:46,  3.34s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:29<01:21,  6.26s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:29<01:21,  6.26s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:37<01:21,  6.82s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:37<01:21,  6.82s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:40<01:01,  5.58s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:40<01:01,  5.58s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:42<00:44,  4.50s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:42<00:44,  4.50s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:44<00:33,  3.75s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:44<00:33,  3.75s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:50<00:35,  4.43s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:50<00:35,  4.43s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:57<00:37,  5.41s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:57<00:37,  5.41s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:59<00:25,  4.25s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:59<00:25,  4.25s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:02<00:19,  3.84s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:02<00:19,  3.84s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:04<00:12,  3.24s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:04<00:12,  3.24s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:05<00:08,  2.75s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:05<00:08,  2.75s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:18<00:11,  5.77s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:18<00:11,  5.77s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:22<00:05,  5.17s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:22<00:05,  5.17s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:23<00:00,  3.99s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:23<00:00,  3.99s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9895424836601308
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9017661158286158
	steps: 0.375	0.49312996031746037
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.5357142857142857	0.8980531373388516
	steps: 0.17857142857142858	0.3410147392290249
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8994889369889371
	steps: 0.1111111111111111	0.36870691037357706
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.07692307692307693	0.7814835616871816
	steps: 0.0	0.2237098371713756
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6154409942114498
	steps: 0.0	0.11799719887955182
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7418751263144855
	steps: 0.0	0.14145911987983598
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9053469053469053
	steps: 0.4594594594594595	0.5504504504504505
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.876415891800507
	steps: 0.3076923076923077	0.4769230769230769
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6538461538461539	0.9398656898656899
	steps: 0.3076923076923077	0.4567765567765567
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8895454545454544
	steps: 0.1	0.27103174603174607
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.7622377622377623
	steps: 0.0	0.39682539682539686
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8219494790923363
	steps: 0.07142857142857142	0.29109977324263037
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 0.0	0.6666666666666665
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.9416666666666667
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6331252811515969
	steps: 0.0	0.04044117647058824
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8705882352941177
	steps: 0.0	0.24358974358974358
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6554621848739496
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7692307692307693
	steps: 0.0	0.4
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7761933056050703
	steps: 0.0	0.08333333333333333
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.6666666666666666	0.9743589743589743
	steps: 0.0	0.26119894598155463
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:23<00:00,  6.00s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5935828877005348
  ExactMatch_proof_val      0.40106951871657753
  ExactMatch_steps_val      0.40106951871657753
      F1_leaves_val         0.9007198439052791
      F1_proof_val          0.40106951871657753
      F1_steps_val          0.5151252274872636
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:47,  4.38s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:47,  4.38s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:46,  3.77s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:46,  3.77s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:26,  4.24s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:26,  4.24s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:14,  3.50s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:14,  3.50s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:20<06:09,  4.16s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:20<06:09,  4.16s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:21<04:54,  3.35s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:21<04:54,  3.35s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:23<04:11,  2.89s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:23<04:11,  2.89s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:25<03:36,  2.52s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:25<03:36,  2.52s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:27<03:18,  2.33s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:27<03:18,  2.33s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:38<07:09,  5.12s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:38<07:09,  5.12s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<05:54,  4.27s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<05:54,  4.27s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:16,  3.87s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:16,  3.87s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:59,  4.43s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:59,  4.43s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<07:20,  5.51s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<07:20,  5.51s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:03<07:06,  5.40s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:03<07:06,  5.40s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:10<07:36,  5.85s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:10<07:36,  5.85s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:15<07:23,  5.76s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:15<07:23,  5.76s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:21<07:27,  5.89s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:21<07:27,  5.89s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:25<06:22,  5.11s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:25<06:22,  5.11s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:32<07:10,  5.81s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:32<07:10,  5.81s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:45<09:37,  7.92s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:45<09:37,  7.92s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:51<09:00,  7.51s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:51<09:00,  7.51s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:57<08:05,  6.83s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:57<08:05,  6.83s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:06<08:58,  7.69s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:06<08:58,  7.69s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:10<07:23,  6.43s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:10<07:23,  6.43s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:13<06:06,  5.39s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:13<06:06,  5.39s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:24<08:06,  7.26s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:24<08:06,  7.26s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:28<06:40,  6.07s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:28<06:40,  6.07s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:29<05:10,  4.78s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:29<05:10,  4.78s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:34<04:56,  4.64s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:34<04:56,  4.64s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:40<05:22,  5.12s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:40<05:22,  5.12s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:59<09:30,  9.20s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:59<09:30,  9.20s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:02<07:23,  7.27s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:02<07:23,  7.27s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:15<09:05,  9.09s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:15<09:05,  9.09s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:17<06:49,  6.94s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:17<06:49,  6.94s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:19<05:17,  5.48s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:19<05:17,  5.48s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:24<05:05,  5.36s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:24<05:05,  5.36s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:38<07:27,  7.98s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:38<07:27,  7.98s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:46<07:22,  8.04s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:46<07:22,  8.04s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:51<06:22,  7.08s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:51<06:22,  7.08s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:57<06:05,  6.89s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:57<06:05,  6.89s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:59<04:39,  5.38s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:59<04:39,  5.38s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:05<04:39,  5.47s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:05<04:39,  5.47s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:20<06:53,  8.27s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:20<06:53,  8.27s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:29<06:57,  8.53s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:29<06:57,  8.53s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:47<09:09, 11.44s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:47<09:09, 11.44s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:55<08:00, 10.21s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:55<08:00, 10.21s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:16<10:21, 13.50s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:16<10:21, 13.50s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:21<08:14, 10.99s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:21<08:14, 10.99s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:32<08:12, 11.19s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:32<08:12, 11.19s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:47<08:39, 12.08s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:47<08:39, 12.08s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:54<07:29, 10.70s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:54<07:29, 10.70s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:59<06:01,  8.81s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:59<06:01,  8.81s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:01<04:41,  7.04s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:01<04:41,  7.04s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:07<04:12,  6.48s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:07<04:12,  6.48s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:10<03:32,  5.59s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:10<03:32,  5.59s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:15<03:20,  5.42s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:15<03:20,  5.42s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:19<03:02,  5.07s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:19<03:02,  5.07s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:21<02:26,  4.18s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:21<02:26,  4.18s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:40<04:43,  8.33s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:40<04:43,  8.33s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:49<04:44,  8.61s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:49<04:44,  8.61s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:54<04:03,  7.60s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:54<04:03,  7.60s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:57<03:11,  6.19s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:57<03:11,  6.19s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:09<03:59,  8.00s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:09<03:59,  8.00s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:23<04:40,  9.69s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:23<04:40,  9.69s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:26<03:33,  7.62s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:26<03:33,  7.62s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:29<02:51,  6.33s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:29<02:51,  6.33s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:31<02:11,  5.04s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:31<02:11,  5.04s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:34<01:53,  4.56s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:34<01:53,  4.56s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:38<01:43,  4.30s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:38<01:43,  4.30s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:40<01:23,  3.64s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:40<01:23,  3.64s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:46<01:36,  4.39s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:46<01:36,  4.39s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:50<01:30,  4.29s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:50<01:30,  4.29s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:55<01:28,  4.42s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:55<01:28,  4.42s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:01<01:29,  4.73s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:01<01:29,  4.73s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:06<01:31,  5.06s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:06<01:31,  5.06s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:08<01:08,  4.00s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:08<01:08,  4.00s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:11<01:01,  3.87s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:11<01:01,  3.87s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:14<00:50,  3.36s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:14<00:50,  3.36s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:21<01:01,  4.42s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:21<01:01,  4.42s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:29<01:11,  5.52s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:29<01:11,  5.52s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:35<01:07,  5.65s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:35<01:07,  5.65s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:38<00:54,  4.91s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:38<00:54,  4.91s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:41<00:43,  4.34s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:41<00:43,  4.34s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:43<00:32,  3.67s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:43<00:32,  3.67s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:51<00:40,  5.04s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:51<00:40,  5.04s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:56<00:36,  5.15s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:56<00:36,  5.15s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:58<00:24,  4.11s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:58<00:24,  4.11s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:02<00:19,  3.89s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:02<00:19,  3.89s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:03<00:13,  3.27s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:03<00:13,  3.27s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:05<00:08,  2.82s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:05<00:08,  2.82s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:12<00:08,  4.08s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:12<00:08,  4.08s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:16<00:04,  4.08s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:16<00:04,  4.08s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:18<00:00,  3.25s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:18<00:00,  3.25s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9895424836601308
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9070030663780664
	steps: 0.390625	0.49910714285714286
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.4642857142857143	0.8880250701679273
	steps: 0.17857142857142858	0.3251700680272109
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8873677248677249
	steps: 0.1111111111111111	0.36912578162578163
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.07692307692307693	0.787377793147024
	steps: 0.0	0.22496929917744396
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6395052757945283
	steps: 0.0	0.1587301587301587
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7226461786967912
	steps: 0.0	0.17183351601510166
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9053469053469053
	steps: 0.4594594594594595	0.5504504504504505
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.5384615384615384	0.9067765567765568
	steps: 0.38461538461538464	0.5065934065934066
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5384615384615384	0.9082722832722834
	steps: 0.3076923076923077	0.4406593406593406
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.885909090909091
	steps: 0.1	0.27103174603174607
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.39682539682539686
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.42857142857142855	0.854683411826269
	steps: 0.07142857142857142	0.29716553287981856
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 0.0	0.6666666666666665
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.9226190476190477
	steps: 0.0	0.26136363636363635
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7333333333333334
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6298358074673863
	steps: 0.0	0.10224035224035223
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25874125874125875
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7242452536570183
	steps: 0.0	0.21241830065359477
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.9333333333333333
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7277183600713011
	steps: 0.0	0.12777777777777777
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.9265328874024527
	steps: 0.0	0.3282608695652174
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.1213235294117647
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:18<00:00,  5.94s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.9005374825713244
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5174256481999551
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=15, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:02<04:29,  2.90s/it]Validation DataLoader 0:   1%|          | 1/94 [00:02<04:29,  2.90s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:04<03:34,  2.33s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:04<03:34,  2.33s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:09,  2.74s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:09,  2.74s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:48,  2.54s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:48,  2.54s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<04:01,  2.71s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<04:01,  2.71s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:14<03:14,  2.21s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:14<03:14,  2.21s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:16<02:54,  2.00s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:16<02:54,  2.00s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:16<02:16,  1.58s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:16<02:16,  1.58s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:17<01:50,  1.30s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:17<01:50,  1.30s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:23<03:58,  2.84s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:23<03:58,  2.84s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:25<03:24,  2.46s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:25<03:24,  2.46s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:27<03:06,  2.28s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:27<03:06,  2.28s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:30<03:18,  2.45s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:30<03:18,  2.45s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:32<03:25,  2.57s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:32<03:25,  2.57s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:35<03:25,  2.60s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:35<03:25,  2.60s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:42<04:53,  3.77s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:42<04:53,  3.77s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:45<04:45,  3.71s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:45<04:45,  3.71s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:48<04:16,  3.37s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:48<04:16,  3.37s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:49<03:32,  2.83s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:49<03:32,  2.83s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [00:53<03:56,  3.19s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [00:53<03:56,  3.19s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [00:59<04:47,  3.94s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [00:59<04:47,  3.94s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:03<04:44,  3.95s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:03<04:44,  3.95s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:08<05:05,  4.30s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:08<05:05,  4.30s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:11<04:33,  3.91s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:11<04:33,  3.91s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:14<04:09,  3.62s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:14<04:09,  3.62s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:16<03:35,  3.17s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:16<03:35,  3.17s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:20<03:50,  3.44s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:20<03:50,  3.44s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:23<03:26,  3.12s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:23<03:26,  3.12s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:23<02:35,  2.39s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:23<02:35,  2.39s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:28<03:20,  3.14s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:28<03:20,  3.14s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:31<03:05,  2.94s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:31<03:05,  2.94s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:33<02:51,  2.76s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:33<02:51,  2.76s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:35<02:25,  2.38s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:35<02:25,  2.38s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:38<02:39,  2.66s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:38<02:39,  2.66s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:39<02:12,  2.25s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:39<02:12,  2.25s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:40<01:51,  1.92s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:40<01:51,  1.92s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [01:42<01:50,  1.94s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [01:42<01:50,  1.94s/it]Validation DataLoader 0:  40%|████      | 38/94 [01:46<02:15,  2.41s/it]Validation DataLoader 0:  40%|████      | 38/94 [01:46<02:15,  2.41s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [01:49<02:21,  2.58s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [01:49<02:21,  2.58s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [01:51<02:18,  2.56s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [01:51<02:18,  2.56s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [01:55<02:27,  2.78s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [01:55<02:27,  2.78s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [01:55<01:51,  2.15s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [01:55<01:51,  2.15s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:00<02:33,  3.02s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:00<02:33,  3.02s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:08<03:38,  4.37s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:08<03:38,  4.37s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:13<03:52,  4.74s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:13<03:52,  4.74s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:22<04:39,  5.81s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:22<04:39,  5.81s/it]Validation DataLoader 0:  50%|█████     | 47/94 [02:27<04:22,  5.59s/it]Validation DataLoader 0:  50%|█████     | 47/94 [02:27<04:22,  5.59s/it]Validation DataLoader 0:  51%|█████     | 48/94 [02:31<03:57,  5.17s/it]Validation DataLoader 0:  51%|█████     | 48/94 [02:31<03:57,  5.17s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [02:34<03:21,  4.47s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [02:34<03:21,  4.47s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [02:40<03:45,  5.13s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [02:40<03:45,  5.13s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [02:46<03:41,  5.16s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [02:46<03:41,  5.16s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [02:50<03:20,  4.77s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [02:50<03:20,  4.77s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [02:53<03:00,  4.40s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [02:53<03:00,  4.40s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [02:54<02:18,  3.46s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [02:54<02:18,  3.46s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [02:57<02:08,  3.29s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [02:57<02:08,  3.29s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:00<01:57,  3.08s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:00<01:57,  3.08s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:04<02:01,  3.29s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:04<02:01,  3.29s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:06<01:52,  3.13s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:06<01:52,  3.13s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:07<01:23,  2.40s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:07<01:23,  2.40s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [03:20<03:10,  5.59s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [03:20<03:10,  5.59s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [03:25<02:54,  5.30s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [03:25<02:54,  5.30s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [03:27<02:17,  4.28s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [03:27<02:17,  4.28s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [03:29<01:55,  3.71s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [03:29<01:55,  3.71s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [03:34<02:01,  4.04s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [03:34<02:01,  4.04s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [03:44<02:53,  6.00s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [03:44<02:53,  6.00s/it]Validation DataLoader 0:  70%|███████   | 66/94 [03:47<02:21,  5.05s/it]Validation DataLoader 0:  70%|███████   | 66/94 [03:47<02:21,  5.05s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [03:49<01:47,  3.99s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [03:49<01:47,  3.99s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [03:49<01:18,  3.00s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [03:49<01:18,  3.00s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [03:53<01:17,  3.12s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [03:53<01:17,  3.12s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [03:55<01:04,  2.70s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [03:55<01:04,  2.70s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [03:57<00:57,  2.48s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [03:57<00:57,  2.48s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [03:59<00:55,  2.52s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [03:59<00:55,  2.52s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:02<00:52,  2.48s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:02<00:52,  2.48s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [04:03<00:44,  2.24s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [04:03<00:44,  2.24s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [04:05<00:40,  2.14s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [04:05<00:40,  2.14s/it]Validation DataLoader 0:  81%|████████  | 76/94 [04:08<00:40,  2.26s/it]Validation DataLoader 0:  81%|████████  | 76/94 [04:08<00:40,  2.26s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [04:08<00:30,  1.79s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [04:08<00:30,  1.79s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [04:10<00:28,  1.75s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [04:10<00:28,  1.75s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [04:11<00:21,  1.43s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [04:11<00:21,  1.43s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [04:13<00:25,  1.80s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [04:13<00:25,  1.80s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [04:16<00:25,  1.96s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [04:16<00:25,  1.96s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [04:18<00:23,  1.95s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [04:18<00:23,  1.95s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [04:20<00:22,  2.08s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [04:20<00:22,  2.08s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [04:21<00:18,  1.89s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [04:21<00:18,  1.89s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [04:23<00:15,  1.73s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [04:23<00:15,  1.73s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [04:26<00:17,  2.20s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [04:26<00:17,  2.20s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [04:30<00:18,  2.66s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [04:30<00:18,  2.66s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [04:31<00:12,  2.11s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [04:31<00:12,  2.11s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [04:32<00:09,  1.99s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [04:32<00:09,  1.99s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [04:34<00:07,  1.79s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [04:34<00:07,  1.79s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [04:36<00:05,  1.80s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [04:36<00:05,  1.80s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [04:37<00:03,  1.71s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [04:37<00:03,  1.71s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [04:39<00:01,  1.80s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [04:39<00:01,  1.80s/it]Validation DataLoader 0: 100%|██████████| 94/94 [04:39<00:00,  1.39s/it]Validation DataLoader 0: 100%|██████████| 94/94 [04:39<00:00,  1.39s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9862745098039215
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.878830717893218
	steps: 0.375	0.4672991071428571
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.42857142857142855	0.8459679209679211
	steps: 0.17857142857142858	0.3959467120181405
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8792308000641333
	steps: 0.16666666666666666	0.35927128427128424
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6870550125432241
	steps: 0.0	0.20665531050146432
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5283390279188598
	steps: 0.0	0.13430735930735932
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6863132799059573
	steps: 0.0	0.1767588194698169
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9829268292682927
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8751608751608752
	steps: 0.4594594594594595	0.5018018018018018
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8307692307692308
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.8761599511599513
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.2	0.8556998556998557
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9257070707070707
	steps: 0.1	0.41428571428571426
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8464805036233607
	steps: 0.07142857142857142	0.26944444444444443
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8833333333333334
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.6696428571428572
	steps: 0.0	0.09090909090909091
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.5697335344394169
	steps: 0.0	0.1690850815850816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8
	steps: 0.0	0.17692307692307693
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.4705882352941176
	steps: 0.0	0.12777777777777777
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6742424242424242
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8100686498855835
	steps: 0.0	0.25821729658046794
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [04:40<00:00,  2.98s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5508021390374331
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8706224073334321
      F1_proof_val          0.40641711229946526
      F1_steps_val           0.514159130369109
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=2, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:03,  3.26s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:03,  3.26s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<03:52,  2.53s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<03:52,  2.53s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:53,  3.22s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:53,  3.22s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:51,  2.57s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:51,  2.57s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<04:03,  2.73s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<04:03,  2.73s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:15<03:33,  2.42s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:15<03:33,  2.42s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:17<03:03,  2.11s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:17<03:03,  2.11s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:18<02:38,  1.84s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:18<02:38,  1.84s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:30,  1.77s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:30,  1.77s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:52,  3.49s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:52,  3.49s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<04:05,  2.95s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<04:05,  2.95s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:39,  2.68s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:39,  2.68s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:09,  3.08s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:09,  3.08s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:38<04:17,  3.22s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:38<04:17,  3.22s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:42<04:20,  3.30s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:42<04:20,  3.30s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:47<04:57,  3.81s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:47<04:57,  3.81s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:50<04:39,  3.63s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:50<04:39,  3.63s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:53<04:18,  3.40s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:53<04:18,  3.40s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:55<03:41,  2.95s/it]Validation DataLoader 0:  20%|██        | 19/94 [00:55<03:41,  2.95s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:02<05:05,  4.13s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:02<05:05,  4.13s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:06<05:07,  4.22s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:06<05:07,  4.22s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:13<06:08,  5.12s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:13<06:08,  5.12s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:17<05:35,  4.72s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:17<05:35,  4.72s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:21<05:07,  4.39s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:21<05:07,  4.39s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:24<04:47,  4.16s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:24<04:47,  4.16s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:26<04:02,  3.56s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:26<04:02,  3.56s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:30<03:55,  3.51s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:30<03:55,  3.51s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:33<03:37,  3.29s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:33<03:37,  3.29s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:33<02:46,  2.56s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:33<02:46,  2.56s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:39<03:41,  3.46s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:39<03:41,  3.46s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:42<03:27,  3.30s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:42<03:27,  3.30s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:47<03:48,  3.69s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:47<03:48,  3.69s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:49<03:24,  3.35s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:49<03:24,  3.35s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:56<04:17,  4.29s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:56<04:17,  4.29s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:57<03:24,  3.47s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:57<03:24,  3.47s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:59<02:47,  2.88s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [01:59<02:47,  2.88s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:01<02:38,  2.78s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:01<02:38,  2.78s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:05<02:58,  3.18s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:05<02:58,  3.18s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:14<04:27,  4.86s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:14<04:27,  4.86s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:17<03:49,  4.24s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:17<03:49,  4.24s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:21<03:47,  4.30s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:21<03:47,  4.30s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:22<02:49,  3.26s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:22<02:49,  3.26s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:28<03:32,  4.16s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:28<03:32,  4.16s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:37<04:40,  5.60s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:37<04:40,  5.60s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:50<06:20,  7.76s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:50<06:20,  7.76s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:02<07:13,  9.03s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:02<07:13,  9.03s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:06<05:54,  7.54s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:06<05:54,  7.54s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:12<05:26,  7.10s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:12<05:26,  7.10s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:15<04:19,  5.76s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:15<04:19,  5.76s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:18<03:42,  5.06s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:18<03:42,  5.06s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:24<03:46,  5.26s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:24<03:46,  5.26s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:27<03:14,  4.64s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:27<03:14,  4.64s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:31<02:58,  4.36s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:31<02:58,  4.36s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:33<02:28,  3.71s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:33<02:28,  3.71s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:37<02:29,  3.84s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:37<02:29,  3.84s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:40<02:17,  3.62s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:40<02:17,  3.62s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:45<02:25,  3.94s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:45<02:25,  3.94s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:49<02:19,  3.87s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:49<02:19,  3.87s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:50<01:48,  3.10s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:50<01:48,  3.10s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:08<04:14,  7.48s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:08<04:14,  7.48s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:15<04:00,  7.28s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:15<04:00,  7.28s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:18<03:10,  5.96s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:18<03:10,  5.96s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:21<02:40,  5.16s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:21<02:40,  5.16s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:30<03:09,  6.30s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:30<03:09,  6.30s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:40<03:37,  7.49s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:40<03:37,  7.49s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:43<02:50,  6.10s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:43<02:50,  6.10s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:45<02:15,  5.01s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:45<02:15,  5.01s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:47<01:40,  3.87s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:47<01:40,  3.87s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:50<01:32,  3.68s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:50<01:32,  3.68s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:52<01:18,  3.28s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:52<01:18,  3.28s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:54<01:03,  2.77s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:54<01:03,  2.77s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [04:57<01:02,  2.82s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [04:57<01:02,  2.82s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:59<00:58,  2.81s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [04:59<00:58,  2.81s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:02<00:53,  2.66s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:02<00:53,  2.66s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:04<00:48,  2.55s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:04<00:48,  2.55s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:07<00:46,  2.56s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:07<00:46,  2.56s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:08<00:34,  2.04s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:08<00:34,  2.04s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:10<00:34,  2.18s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:10<00:34,  2.18s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:11<00:28,  1.88s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:11<00:28,  1.88s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:16<00:38,  2.74s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:16<00:38,  2.74s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:20<00:39,  3.07s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:20<00:39,  3.07s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:23<00:37,  3.12s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:23<00:37,  3.12s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:25<00:31,  2.89s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:25<00:31,  2.89s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:27<00:25,  2.53s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:27<00:25,  2.53s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:29<00:19,  2.21s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:29<00:19,  2.21s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:33<00:23,  2.91s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:33<00:23,  2.91s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:37<00:22,  3.25s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:37<00:22,  3.25s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:38<00:15,  2.59s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:38<00:15,  2.59s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:40<00:12,  2.42s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:40<00:12,  2.42s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:42<00:08,  2.10s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:42<00:08,  2.10s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:43<00:05,  1.87s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:43<00:05,  1.87s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:45<00:03,  1.80s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:45<00:03,  1.80s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:48<00:02,  2.25s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:48<00:02,  2.25s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:49<00:00,  1.90s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:49<00:00,  1.90s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9127840909090909
	steps: 0.390625	0.5042782738095238
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.4642857142857143	0.8853927818213532
	steps: 0.17857142857142858	0.3662440733869306
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8834028625695294
	steps: 0.2222222222222222	0.37316017316017314
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.07692307692307693	0.7562133944486885
	steps: 0.0	0.23099464637926176
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6353341336534614
	steps: 0.0	0.1675665604237033
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7095358345358346
	steps: 0.0	0.213734393625698
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9173745173745174
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.9091269841269841
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9136363636363637
	steps: 0.0	0.13
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.8936363636363638
	steps: 0.1	0.35873015873015873
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8294641866070437
	steps: 0.14285714285714285	0.2987012987012987
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9495192307692307
	steps: 0.0	0.23636363636363636
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7321428571428572
	steps: 0.0	0.25757575757575757
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6861111111111112
	steps: 0.0	0.2025844525844526
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.6875
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7002801120448178
	steps: 0.0	0.15555555555555556
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.9333333333333333
	steps: 0.0	0.5
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6868686868686869
	steps: 0.0	0.11111111111111112
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9419191919191919
	steps: 0.0	0.27310370788631655
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5454545454545455
	steps: 0.0	0.1
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [05:49<00:00,  3.72s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5668449197860963
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.8982329883949891
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5278279646159209
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=3, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:41,  3.67s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:41,  3.67s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:16,  2.79s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:16,  2.79s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<05:02,  3.33s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<05:02,  3.33s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:24,  2.94s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:24,  2.94s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:15<04:45,  3.21s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:15<04:45,  3.21s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:17<03:52,  2.64s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:17<03:52,  2.64s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:36,  2.49s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:36,  2.49s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<03:01,  2.11s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<03:01,  2.11s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:22<02:47,  1.97s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:22<02:47,  1.97s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:29<04:49,  3.45s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:29<04:49,  3.45s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:31<04:06,  2.97s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:31<04:06,  2.97s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:33<03:41,  2.70s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:33<03:41,  2.70s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:37<04:08,  3.07s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:37<04:08,  3.07s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:43<05:12,  3.90s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:43<05:12,  3.90s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:45<04:45,  3.62s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:45<04:45,  3.62s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:52<05:45,  4.43s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:52<05:45,  4.43s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:56<05:27,  4.25s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:56<05:27,  4.25s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:08,  4.06s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:08,  4.06s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:02<04:31,  3.62s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:02<04:31,  3.62s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:07<04:53,  3.96s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:07<04:53,  3.96s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:11<04:56,  4.06s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:11<04:56,  4.06s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:15<04:50,  4.03s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:15<04:50,  4.03s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:19<04:58,  4.21s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:19<04:58,  4.21s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:24<05:05,  4.36s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:24<05:05,  4.36s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:27<04:22,  3.81s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:27<04:22,  3.81s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:29<03:50,  3.38s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:29<03:50,  3.38s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:34<04:23,  3.93s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:34<04:23,  3.93s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:37<03:56,  3.58s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:37<03:56,  3.58s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:38<02:59,  2.77s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:38<02:59,  2.77s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:44<03:56,  3.70s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:44<03:56,  3.70s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:46<03:29,  3.33s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:46<03:29,  3.33s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:50<03:34,  3.45s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:50<03:34,  3.45s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:52<03:10,  3.12s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:52<03:10,  3.12s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:57<03:26,  3.45s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [01:57<03:26,  3.45s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:58<02:53,  2.94s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [01:58<02:53,  2.94s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:00<02:34,  2.66s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:00<02:34,  2.66s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:04<02:41,  2.84s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:04<02:41,  2.84s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:08<03:04,  3.29s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:08<03:04,  3.29s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:12<03:16,  3.58s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:12<03:16,  3.58s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:15<02:53,  3.22s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:15<02:53,  3.22s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:18<02:55,  3.31s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:18<02:55,  3.31s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:19<02:14,  2.58s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:19<02:14,  2.58s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:24<02:53,  3.41s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:24<02:53,  3.41s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:35<04:33,  5.48s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:35<04:33,  5.48s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:43<05:18,  6.50s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:43<05:18,  6.50s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:50<05:17,  6.62s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:50<05:17,  6.62s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:00<05:59,  7.66s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:00<05:59,  7.66s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:08<05:53,  7.69s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:08<05:53,  7.69s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:13<05:07,  6.83s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:13<05:07,  6.83s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:18<04:38,  6.34s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:18<04:38,  6.34s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<05:36,  7.83s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<05:36,  7.83s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:34<04:42,  6.72s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:34<04:42,  6.72s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:37<03:49,  5.60s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:37<03:49,  5.60s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:39<03:04,  4.62s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:39<03:04,  4.62s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:42<02:44,  4.23s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:42<02:44,  4.23s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:45<02:25,  3.84s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:45<02:25,  3.84s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:49<02:16,  3.68s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:49<02:16,  3.68s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:53<02:22,  3.95s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:53<02:22,  3.95s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:55<01:55,  3.31s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:55<01:55,  3.31s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:08<03:29,  6.18s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:08<03:29,  6.18s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:13<03:13,  5.85s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:13<03:13,  5.85s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:17<02:52,  5.40s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:17<02:52,  5.40s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:20<02:20,  4.53s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:20<02:20,  4.53s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:30<03:10,  6.36s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:30<03:10,  6.36s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:45<04:16,  8.83s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:45<04:16,  8.83s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:49<03:25,  7.33s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:49<03:25,  7.33s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:50<02:31,  5.62s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:50<02:31,  5.62s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:52<01:54,  4.39s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:52<01:54,  4.39s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:56<01:44,  4.18s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:56<01:44,  4.18s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:58<01:28,  3.69s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:58<01:28,  3.69s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:00<01:14,  3.25s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:00<01:14,  3.25s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:03<01:07,  3.06s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:03<01:07,  3.06s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:06<01:02,  2.99s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:06<01:02,  2.99s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:08<00:55,  2.80s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:08<00:55,  2.80s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:12<00:56,  2.96s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:12<00:56,  2.96s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:15<00:54,  3.02s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:15<00:54,  3.02s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:16<00:40,  2.37s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:16<00:40,  2.37s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:17<00:34,  2.13s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:17<00:34,  2.13s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:18<00:27,  1.85s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:18<00:27,  1.85s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:23<00:37,  2.67s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:23<00:37,  2.67s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:26<00:34,  2.64s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:26<00:34,  2.64s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:29<00:33,  2.77s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:29<00:33,  2.77s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:31<00:29,  2.66s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:31<00:29,  2.66s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:33<00:25,  2.57s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:33<00:25,  2.57s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:35<00:20,  2.30s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:35<00:20,  2.30s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:38<00:20,  2.55s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:38<00:20,  2.55s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:42<00:19,  2.80s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:42<00:19,  2.80s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:43<00:13,  2.32s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:43<00:13,  2.32s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:45<00:11,  2.22s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:45<00:11,  2.22s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:46<00:07,  1.97s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:46<00:07,  1.97s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:47<00:05,  1.78s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:47<00:05,  1.78s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:49<00:03,  1.78s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:49<00:03,  1.78s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:53<00:02,  2.48s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:53<00:02,  2.48s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:54<00:00,  2.02s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:54<00:00,  2.02s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9215686274509803	0.9839402427637722
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.578125	0.9133984938672439
	steps: 0.40625	0.5123511904761905
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.5357142857142857	0.8729560122417265
	steps: 0.17857142857142858	0.37899659863945573
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8774631232964567
	steps: 0.16666666666666666	0.3654441237774571
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7472734655992574
	steps: 0.0	0.21932255778409623
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6510699016448684
	steps: 0.0	0.17390545961974532
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.74004144004144
	steps: 0.0	0.23163919413919412
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.8	0.9714285714285715
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9122265122265123
	steps: 0.5135135135135135	0.5774774774774775
	proof: 0.5135135135135135	0.5135135135135135
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.4641025641025641
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6538461538461539	0.896916971916972
	steps: 0.3076923076923077	0.4457875457875457
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9595959595959596
	steps: 0.0	0.21333333333333332
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9025252525252526
	steps: 0.1	0.3551587301587301
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8222047793476366
	steps: 0.14285714285714285	0.30277777777777776
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 0.0	0.6666666666666665
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.8818181818181818
	steps: 0.0	0.2077922077922078
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7689075630252101
	steps: 0.0	0.23717948717948717
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6725098001413791
	steps: 0.0	0.20083620083620088
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25874125874125875
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6805555555555555
	steps: 0.0	0.22857142857142856
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7692307692307693
	steps: 0.0	0.2
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7391562685680332
	steps: 0.0	0.14682539682539683
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.6666666666666666	0.9743589743589743
	steps: 0.0	0.3174603174603174
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5454545454545455
	steps: 0.0	0.1
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [05:54<00:00,  3.77s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5828877005347594
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.8961917302412492
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5317579776135926
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=4, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:50,  3.77s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:50,  3.77s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:48,  3.14s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:48,  3.14s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:26,  3.59s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:26,  3.59s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:49,  3.21s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:49,  3.21s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:21,  3.62s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:21,  3.62s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:33,  3.11s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:33,  3.11s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:11,  2.89s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:11,  2.89s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:27,  2.41s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:27,  2.41s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:02,  2.14s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:02,  2.14s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<08:07,  5.80s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<08:07,  5.80s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:25,  4.65s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:25,  4.65s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:19,  3.90s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:19,  3.90s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:47<05:32,  4.10s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:47<05:32,  4.10s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:52<05:43,  4.30s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:52<05:43,  4.30s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:56<05:26,  4.13s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:56<05:26,  4.13s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:06<07:50,  6.03s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:06<07:50,  6.03s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:10<07:00,  5.46s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:10<07:00,  5.46s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:14<06:03,  4.78s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:14<06:03,  4.78s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:16<05:12,  4.16s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:16<05:12,  4.16s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:22<05:47,  4.70s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:22<05:47,  4.70s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:29<06:32,  5.37s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:29<06:32,  5.37s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:37<07:21,  6.14s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:37<07:21,  6.14s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:42<06:53,  5.82s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:42<06:53,  5.82s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:48<06:37,  5.68s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:48<06:37,  5.68s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:52<06:04,  5.28s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:52<06:04,  5.28s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:55<05:03,  4.46s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:55<05:03,  4.46s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:01<05:39,  5.07s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:01<05:39,  5.07s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:04<04:54,  4.46s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:04<04:54,  4.46s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:05<03:44,  3.45s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:05<03:44,  3.45s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:09<03:52,  3.63s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:09<03:52,  3.63s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:11<03:23,  3.23s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:11<03:23,  3.23s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:15<03:23,  3.28s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:15<03:23,  3.28s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:17<03:01,  2.97s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:17<03:01,  2.97s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:23<03:51,  3.86s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:23<03:51,  3.86s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:25<03:09,  3.20s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:25<03:09,  3.20s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:26<02:37,  2.72s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:26<02:37,  2.72s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:31<03:04,  3.24s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:31<03:04,  3.24s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:35<03:10,  3.40s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:35<03:10,  3.40s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:41<04:02,  4.40s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:41<04:02,  4.40s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:44<03:25,  3.81s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:44<03:25,  3.81s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:49<03:52,  4.39s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:49<03:52,  4.39s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:50<02:53,  3.35s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:50<02:53,  3.35s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:59<04:14,  5.00s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:59<04:14,  5.00s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:11<05:46,  6.93s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:11<05:46,  6.93s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:23<07:02,  8.63s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:23<07:02,  8.63s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:36<07:47,  9.74s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:36<07:47,  9.74s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:42<06:53,  8.80s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:42<06:53,  8.80s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:49<06:11,  8.08s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:49<06:11,  8.08s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:53<05:08,  6.86s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:53<05:08,  6.86s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:01<05:17,  7.21s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:01<05:17,  7.21s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:09<05:21,  7.48s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:09<05:21,  7.48s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:13<04:36,  6.58s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:13<04:36,  6.58s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:18<04:03,  5.93s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:18<04:03,  5.93s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:20<03:17,  4.93s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:20<03:17,  4.93s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:25<03:06,  4.79s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:25<03:06,  4.79s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:28<02:41,  4.26s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:28<02:41,  4.26s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:33<02:45,  4.48s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:33<02:45,  4.48s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:36<02:31,  4.21s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:36<02:31,  4.21s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:38<01:59,  3.43s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:38<01:59,  3.43s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:47<02:57,  5.23s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:47<02:57,  5.23s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:55<03:19,  6.05s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:55<03:19,  6.05s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:01<03:10,  5.96s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:01<03:10,  5.96s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:04<02:32,  4.94s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:04<02:32,  4.94s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:13<03:08,  6.28s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:13<03:08,  6.28s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:26<04:04,  8.43s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:26<04:04,  8.43s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:31<03:21,  7.20s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:31<03:21,  7.20s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:33<02:32,  5.64s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:33<02:32,  5.64s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:34<01:53,  4.37s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:34<01:53,  4.37s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:36<01:33,  3.74s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:36<01:33,  3.74s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:39<01:22,  3.42s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:39<01:22,  3.42s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:41<01:07,  2.92s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:41<01:07,  2.92s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:44<01:03,  2.88s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:44<01:03,  2.88s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:46<00:57,  2.76s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:46<00:57,  2.76s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:50<01:00,  3.01s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:50<01:00,  3.01s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:52<00:54,  2.87s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:52<00:54,  2.87s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:56<00:53,  2.99s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:56<00:53,  2.99s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:56<00:40,  2.37s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:56<00:40,  2.37s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:59<00:38,  2.40s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:59<00:38,  2.40s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:01<00:32,  2.16s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:01<00:32,  2.16s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:05<00:38,  2.75s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:05<00:38,  2.75s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:08<00:36,  2.78s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:08<00:36,  2.78s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:10<00:33,  2.77s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:10<00:33,  2.77s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:13<00:30,  2.77s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:13<00:30,  2.77s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:15<00:24,  2.47s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:15<00:24,  2.47s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:17<00:20,  2.25s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:17<00:20,  2.25s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:24<00:30,  3.86s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:24<00:30,  3.86s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:29<00:28,  4.00s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:29<00:28,  4.00s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:30<00:19,  3.20s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:30<00:19,  3.20s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:32<00:14,  2.90s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:32<00:14,  2.90s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:34<00:09,  2.48s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:34<00:09,  2.48s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:35<00:06,  2.14s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:35<00:06,  2.14s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:37<00:04,  2.07s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:37<00:04,  2.07s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:41<00:02,  2.57s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:41<00:02,  2.57s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:42<00:00,  2.13s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:42<00:00,  2.13s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9893557422969187
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.9039457070707071
	steps: 0.390625	0.5003720238095238
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5357142857142857	0.9047020439877583
	steps: 0.17857142857142858	0.39966244073386925
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8734227192560526
	steps: 0.2222222222222222	0.3839626422959756
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.0	0.7983708837007241
	steps: 0.0	0.24059982250027498
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.622767001537457
	steps: 0.0	0.13814371902607198
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7719620958751393
	steps: 0.0	0.2381855473960737
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9050895050895051
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6153846153846154	0.9268315018315019
	steps: 0.3076923076923077	0.45723443223443216
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9136363636363637
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9025252525252526
	steps: 0.1	0.35873015873015873
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8543726115154688
	steps: 0.14285714285714285	0.3433879612451041
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9125874125874125
	steps: 0.0	0.21969696969696967
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.634132607158923
	steps: 0.0	0.20192552545493725
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.21241830065359477
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.9333333333333333
	steps: 0.0	0.42857142857142855
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7633986928104575
	steps: 0.0	0.1118421052631579
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.8949938949938949
	steps: 0.0	0.30151515151515146
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:42<00:00,  4.28s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5668449197860963
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.9023149591553836
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5328855745227162
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=5, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:29,  3.55s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:29,  3.55s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:38,  3.02s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:38,  3.02s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:21,  3.54s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:21,  3.54s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:41,  3.13s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:41,  3.13s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:03,  3.42s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:03,  3.42s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:25,  3.01s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:25,  3.01s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:20<03:48,  2.62s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:20<03:48,  2.62s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:22<03:12,  2.24s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:22<03:12,  2.24s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:23<02:52,  2.02s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:23<02:52,  2.02s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:40<09:04,  6.48s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:40<09:04,  6.48s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:42<07:05,  5.13s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:42<07:05,  5.13s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:47,  4.24s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:47,  4.24s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:48<05:34,  4.13s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:48<05:34,  4.13s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:52<05:40,  4.25s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:52<05:40,  4.25s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:56<05:15,  3.99s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:56<05:15,  3.99s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:04<06:54,  5.31s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:04<06:54,  5.31s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:08<06:23,  4.98s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:08<06:23,  4.98s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<05:43,  4.52s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<05:43,  4.52s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:15<04:57,  3.97s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:15<04:57,  3.97s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:20<05:34,  4.52s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:20<05:34,  4.52s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:30<07:25,  6.11s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:30<07:25,  6.11s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:39<08:28,  7.06s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:39<08:28,  7.06s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:44<07:22,  6.23s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:44<07:22,  6.23s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:48<06:40,  5.73s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:48<06:40,  5.73s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:51<05:25,  4.72s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:51<05:25,  4.72s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:53<04:37,  4.08s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:53<04:37,  4.08s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:03<06:25,  5.76s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:03<06:25,  5.76s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:06<05:27,  4.97s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:06<05:27,  4.97s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:07<04:08,  3.83s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:07<04:08,  3.83s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:13<04:38,  4.35s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:13<04:38,  4.35s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:15<03:56,  3.75s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:15<03:56,  3.75s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:22<04:50,  4.68s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:22<04:50,  4.68s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:24<04:01,  3.96s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:24<04:01,  3.96s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:29<04:18,  4.31s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:29<04:18,  4.31s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:31<03:30,  3.56s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:31<03:30,  3.56s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:33<02:53,  2.99s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:33<02:53,  2.99s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:37<03:04,  3.24s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:37<03:04,  3.24s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:44<04:08,  4.44s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:44<04:08,  4.44s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:52<05:07,  5.58s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:52<05:07,  5.58s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:55<04:23,  4.88s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:55<04:23,  4.88s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:59<04:01,  4.56s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:59<04:01,  4.56s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:00<03:00,  3.46s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:00<03:00,  3.46s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:08<04:09,  4.88s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:08<04:09,  4.88s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:20<05:45,  6.90s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:20<05:45,  6.90s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:30<06:24,  7.85s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:30<06:24,  7.85s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:41<07:06,  8.88s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:41<07:06,  8.88s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:51<07:05,  9.05s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:51<07:05,  9.05s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:02<07:27,  9.72s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:02<07:27,  9.72s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:07<06:09,  8.22s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:07<06:09,  8.22s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:14<05:49,  7.95s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:14<05:49,  7.95s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:23<05:55,  8.28s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:23<05:55,  8.28s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:28<05:09,  7.36s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:28<05:09,  7.36s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:31<04:09,  6.08s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:31<04:09,  6.08s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:34<03:18,  4.96s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:34<03:18,  4.96s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:38<03:08,  4.84s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:38<03:08,  4.84s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:42<02:46,  4.37s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:42<02:46,  4.37s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:46<02:43,  4.42s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:46<02:43,  4.42s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:51<02:41,  4.49s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:51<02:41,  4.49s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:53<02:08,  3.67s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:53<02:08,  3.67s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:11<04:32,  8.01s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:11<04:32,  8.01s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:19<04:29,  8.17s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:19<04:29,  8.17s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:25<03:54,  7.33s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:25<03:54,  7.33s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:27<03:02,  5.89s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:27<03:02,  5.89s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:38<03:42,  7.43s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:38<03:42,  7.43s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:49<04:02,  8.38s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:49<04:02,  8.38s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:53<03:18,  7.10s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:53<03:18,  7.10s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:55<02:30,  5.58s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:55<02:30,  5.58s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:56<01:52,  4.32s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:56<01:52,  4.32s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:00<01:42,  4.08s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:00<01:42,  4.08s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:03<01:29,  3.73s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:03<01:29,  3.73s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:04<01:11,  3.12s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:04<01:11,  3.12s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:09<01:15,  3.45s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:09<01:15,  3.45s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:11<01:03,  3.02s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:11<01:03,  3.02s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:14<01:05,  3.26s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:14<01:05,  3.26s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:20<01:16,  4.00s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:20<01:16,  4.00s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:23<01:05,  3.62s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:23<01:05,  3.62s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:24<00:47,  2.81s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:24<00:47,  2.81s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:26<00:44,  2.75s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:26<00:44,  2.75s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:29<00:38,  2.55s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:29<00:38,  2.55s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:33<00:44,  3.20s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:33<00:44,  3.20s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:36<00:40,  3.10s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:36<00:40,  3.10s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:43<00:51,  4.27s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:43<00:51,  4.27s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:46<00:41,  3.81s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:46<00:41,  3.81s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:48<00:34,  3.45s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:48<00:34,  3.45s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:50<00:26,  2.96s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:50<00:26,  2.96s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:53<00:22,  2.86s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:53<00:22,  2.86s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:58<00:24,  3.44s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:58<00:24,  3.44s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:59<00:17,  2.89s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:59<00:17,  2.89s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:02<00:13,  2.75s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:02<00:13,  2.75s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:03<00:09,  2.37s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:03<00:09,  2.37s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:05<00:06,  2.07s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:05<00:06,  2.07s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:09<00:05,  2.85s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:09<00:05,  2.85s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:14<00:03,  3.44s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:14<00:03,  3.44s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:15<00:00,  2.73s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:15<00:00,  2.73s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9090863997113997
	steps: 0.40625	0.5069196428571429
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.42857142857142855	0.8923154226725656
	steps: 0.17857142857142858	0.39050453514739225
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8886103094436428
	steps: 0.16666666666666666	0.38449174282507614
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.15384615384615385	0.8146010085281341
	steps: 0.0	0.20202869290747355
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.644084030373283
	steps: 0.0	0.13892480068950655
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7427954292084727
	steps: 0.0	0.22361354426571814
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9067765567765568
	steps: 0.38461538461538464	0.5065934065934066
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5	0.9156898656898658
	steps: 0.3076923076923077	0.4836996336996337
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8984343434343434
	steps: 0.1	0.3579365079365079
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8345638488495631
	steps: 0.14285714285714285	0.26746031746031745
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 0.0	0.6666666666666665
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.75	0.9318181818181819
	steps: 0.0	0.2517482517482517
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8210526315789475
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6798358074673864
	steps: 0.0	0.15064347417288595
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8750000000000001
	steps: 0.0	0.3
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.671957671957672
	steps: 0.0	0.173202614379085
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.28571428571428575
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7606209150326797
	steps: 0.0	0.08683473389355743
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9410256410256409
	steps: 0.0	0.3335240274599542
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.12698412698412698
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:15<00:00,  4.64s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5828877005347594
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.9054359405619067
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5306864351660616
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=6, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:09,  3.97s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:09,  3.97s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:59,  3.25s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:59,  3.25s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:32,  3.65s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:32,  3.65s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:53,  3.26s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:53,  3.26s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:22,  3.62s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:22,  3.62s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:33,  3.11s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:33,  3.11s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:29,  3.10s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:29,  3.10s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:38,  2.55s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:38,  2.55s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:04,  2.17s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:04,  2.17s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:53,  5.63s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:53,  5.63s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:17,  4.54s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:17,  4.54s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:22,  3.93s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:22,  3.93s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:48<05:49,  4.31s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:48<05:49,  4.31s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:58<08:00,  6.01s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:58<08:00,  6.01s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:02<06:53,  5.23s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:02<06:53,  5.23s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:11<08:31,  6.55s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:11<08:31,  6.55s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:16<07:30,  5.85s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:16<07:30,  5.85s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:24<08:13,  6.49s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:24<08:13,  6.49s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:26<06:43,  5.38s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:26<06:43,  5.38s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:31<06:14,  5.05s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:31<06:14,  5.05s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:41<08:06,  6.67s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:41<08:06,  6.67s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:54<10:18,  8.60s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:54<10:18,  8.60s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:58<08:35,  7.27s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:58<08:35,  7.27s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:07<09:00,  7.72s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:07<09:00,  7.72s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:10<07:11,  6.26s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:10<07:11,  6.26s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:13<05:52,  5.19s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:13<05:52,  5.19s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:18<05:42,  5.11s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:18<05:42,  5.11s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:21<04:56,  4.50s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:21<04:56,  4.50s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:22<03:47,  3.50s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:22<03:47,  3.50s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:30<05:06,  4.80s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:30<05:06,  4.80s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:32<04:19,  4.12s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:32<04:19,  4.12s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:37<04:25,  4.28s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:37<04:25,  4.28s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:39<03:44,  3.68s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:39<03:44,  3.68s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:44<04:08,  4.13s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:44<04:08,  4.13s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:46<03:20,  3.39s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:46<03:20,  3.39s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:48<02:49,  2.92s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:48<02:49,  2.92s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:52<03:01,  3.18s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:52<03:01,  3.18s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:00<04:30,  4.84s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:00<04:30,  4.84s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:11<05:57,  6.50s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:11<05:57,  6.50s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:14<04:59,  5.54s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:14<04:59,  5.54s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:19<04:53,  5.55s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:19<04:53,  5.55s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:21<03:43,  4.29s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:21<03:43,  4.29s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:30<04:51,  5.72s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:30<04:51,  5.72s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:42<06:21,  7.63s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:42<06:21,  7.63s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:52<06:54,  8.46s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:52<06:54,  8.46s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:03<07:18,  9.14s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:03<07:18,  9.14s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:19<08:46, 11.21s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:19<08:46, 11.21s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:35<09:36, 12.54s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:35<09:36, 12.54s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:39<07:34, 10.10s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:39<07:34, 10.10s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:46<06:47,  9.26s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:46<06:47,  9.26s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:57<06:48,  9.51s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:57<06:48,  9.51s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:02<05:44,  8.21s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:02<05:44,  8.21s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:06<04:44,  6.93s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:06<04:44,  6.93s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:08<03:42,  5.56s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:08<03:42,  5.56s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:12<03:18,  5.09s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:12<03:18,  5.09s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:15<02:49,  4.47s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:15<02:49,  4.47s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:19<02:41,  4.36s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:19<02:41,  4.36s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:25<02:56,  4.91s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:25<02:56,  4.91s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:27<02:19,  3.98s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:27<02:19,  3.98s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:45<04:35,  8.11s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:45<04:35,  8.11s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:56<04:55,  8.95s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:56<04:55,  8.95s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:00<04:03,  7.62s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:00<04:03,  7.62s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:03<03:08,  6.09s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:03<03:08,  6.09s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:15<03:58,  7.97s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:15<03:58,  7.97s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:25<04:05,  8.47s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:25<04:05,  8.47s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:27<03:07,  6.71s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:27<03:07,  6.71s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:30<02:23,  5.33s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:30<02:23,  5.33s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:31<01:50,  4.25s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:31<01:50,  4.25s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:35<01:41,  4.04s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:35<01:41,  4.04s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:38<01:28,  3.70s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:38<01:28,  3.70s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:40<01:11,  3.12s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:40<01:11,  3.12s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:45<01:24,  3.86s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:45<01:24,  3.86s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:48<01:12,  3.46s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:48<01:12,  3.46s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:52<01:12,  3.61s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:52<01:12,  3.61s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:54<01:03,  3.36s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:54<01:03,  3.36s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:58<01:00,  3.37s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:58<01:00,  3.37s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:59<00:47,  2.79s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:59<00:47,  2.79s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:02<00:45,  2.86s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:02<00:45,  2.86s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:04<00:39,  2.62s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:04<00:39,  2.62s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:09<00:46,  3.30s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:09<00:46,  3.30s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:16<00:55,  4.30s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:16<00:55,  4.30s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:19<00:49,  4.09s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:19<00:49,  4.09s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:22<00:39,  3.60s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:22<00:39,  3.60s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:24<00:32,  3.30s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:24<00:32,  3.30s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:26<00:25,  2.85s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:26<00:25,  2.85s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:35<00:35,  4.49s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:35<00:35,  4.49s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:38<00:29,  4.17s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:38<00:29,  4.17s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:39<00:20,  3.34s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:39<00:20,  3.34s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:42<00:14,  2.97s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:42<00:14,  2.97s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:43<00:10,  2.54s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:43<00:10,  2.54s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:45<00:06,  2.22s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:45<00:06,  2.22s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:51<00:07,  3.58s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:51<00:07,  3.58s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:56<00:03,  3.83s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:56<00:03,  3.83s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:57<00:00,  3.03s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:57<00:00,  3.03s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9895424836601308
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.904919733044733
	steps: 0.40625	0.5087053571428571
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.5	0.9037214769357627
	steps: 0.14285714285714285	0.35875850340136056
	proof: 0.14285714285714285	0.14285714285714285
18 trees have depth 4
	leaves: 0.3333333333333333	0.8577942119608787
	steps: 0.1111111111111111	0.33247554914221583
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.15384615384615385	0.7874850738687366
	steps: 0.0	0.2661721068484584
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.587135879993023
	steps: 0.0	0.14292080468551058
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7314443726208432
	steps: 0.0	0.1701653284986618
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.8862637362637363
	steps: 0.38461538461538464	0.5153846153846153
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5769230769230769	0.9205738705738706
	steps: 0.2692307692307692	0.42014652014652015
	proof: 0.2692307692307692	0.2692307692307692
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.9057070707070707
	steps: 0.1	0.38571428571428573
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8502434073862647
	steps: 0.07142857142857142	0.2726911976911977
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 0.0	0.8
	steps: 0.0	0.5454545454545454
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.9151515151515153
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8210526315789475
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6415242165242165
	steps: 0.0	0.1791150026444144
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7451923076923077
	steps: 0.0	0.3484848484848485
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.57703081232493
	steps: 0.0	0.173202614379085
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.28571428571428575
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6852941176470587
	steps: 0.0	0.08366013071895424
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8741083477925583
	steps: 0.0	0.21411483253588515
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.47916666666666663
	steps: 0.0	0.0
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.7692307692307692
	steps: 0.0	0.14814814814814814
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:57<00:00,  5.08s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8976574872031903
      F1_proof_val          0.40641711229946526
      F1_steps_val           0.524431100693911
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=7, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:59,  3.86s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:59,  3.86s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:53,  3.19s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:53,  3.19s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:39,  3.73s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:39,  3.73s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:27,  2.98s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:27,  2.98s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:56,  3.33s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:56,  3.33s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:14,  2.90s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:14,  2.90s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:07,  2.84s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:07,  2.84s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:22<03:24,  2.38s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:22<03:24,  2.38s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:00,  2.13s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:00,  2.13s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<06:14,  4.46s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<06:14,  4.46s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:09,  3.73s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:09,  3.73s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<04:35,  3.36s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<04:35,  3.36s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:44<05:20,  3.96s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:44<05:20,  3.96s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:53<07:33,  5.66s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:53<07:33,  5.66s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:57<06:35,  5.00s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:57<06:35,  5.00s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:03<07:02,  5.41s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:03<07:02,  5.41s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:07<06:28,  5.05s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:07<06:28,  5.05s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:11<05:47,  4.57s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:11<05:47,  4.57s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:13<05:02,  4.03s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:13<05:02,  4.03s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:17<04:55,  4.00s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:17<04:55,  4.00s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:31<08:24,  6.92s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:31<08:24,  6.92s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:37<07:54,  6.58s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:37<07:54,  6.58s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:45<08:29,  7.18s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:45<08:29,  7.18s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:52<08:00,  6.86s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:52<08:00,  6.86s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:55<06:49,  5.93s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:55<06:49,  5.93s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:58<05:40,  5.01s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:58<05:40,  5.01s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:04<05:56,  5.32s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:04<05:56,  5.32s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:07<05:01,  4.57s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:07<05:01,  4.57s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:08<03:50,  3.55s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:08<03:50,  3.55s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:14<04:32,  4.26s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:14<04:32,  4.26s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:19<04:42,  4.48s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:19<04:42,  4.48s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:25<04:56,  4.79s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:25<04:56,  4.79s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:27<04:06,  4.05s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:27<04:06,  4.05s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:32<04:21,  4.36s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:32<04:21,  4.36s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:34<03:33,  3.62s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:34<03:33,  3.62s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:36<02:56,  3.05s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:36<02:56,  3.05s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:39<02:56,  3.09s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:39<02:56,  3.09s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:43<03:18,  3.54s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:43<03:18,  3.54s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:49<03:48,  4.16s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:49<03:48,  4.16s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:53<03:38,  4.04s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:53<03:38,  4.04s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:03<05:05,  5.76s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:03<05:05,  5.76s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:04<03:49,  4.42s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:04<03:49,  4.42s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:09<03:49,  4.51s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:09<03:49,  4.51s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:24<06:21,  7.63s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:24<06:21,  7.63s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:34<06:50,  8.38s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:34<06:50,  8.38s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:45<07:27,  9.31s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:45<07:27,  9.31s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:02<08:57, 11.44s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:02<08:57, 11.44s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:14<09:01, 11.76s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:14<09:01, 11.76s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:18<06:58,  9.30s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:18<06:58,  9.30s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:22<05:42,  7.78s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:22<05:42,  7.78s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:31<05:57,  8.32s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:31<05:57,  8.32s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:36<04:55,  7.04s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:36<04:55,  7.04s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:40<04:13,  6.19s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:40<04:13,  6.19s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:42<03:23,  5.08s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:42<03:23,  5.08s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:46<03:02,  4.69s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:46<03:02,  4.69s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:49<02:39,  4.20s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:49<02:39,  4.20s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:55<02:54,  4.73s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:55<02:54,  4.73s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:59<02:41,  4.49s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:59<02:41,  4.49s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:01<02:09,  3.69s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:01<02:09,  3.69s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:18<04:25,  7.80s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:18<04:25,  7.80s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:27<04:24,  8.01s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:27<04:24,  8.01s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:31<03:39,  6.87s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:31<03:39,  6.87s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:33<02:52,  5.56s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:33<02:52,  5.56s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:48<04:11,  8.40s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:48<04:11,  8.40s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:05<05:13, 10.82s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:05<05:13, 10.82s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:08<03:57,  8.48s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:08<03:57,  8.48s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:10<02:59,  6.64s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:10<02:59,  6.64s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:12<02:14,  5.17s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:12<02:14,  5.17s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:14<01:47,  4.31s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:14<01:47,  4.31s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:17<01:30,  3.76s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:17<01:30,  3.76s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:19<01:12,  3.16s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:19<01:12,  3.16s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:24<01:22,  3.73s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:24<01:22,  3.73s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:26<01:10,  3.36s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:26<01:10,  3.36s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:30<01:09,  3.50s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:30<01:09,  3.50s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:34<01:07,  3.55s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:34<01:07,  3.55s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:37<01:03,  3.51s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:37<01:03,  3.51s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:38<00:49,  2.89s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:38<00:49,  2.89s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:41<00:44,  2.80s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:41<00:44,  2.80s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:43<00:38,  2.54s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:43<00:38,  2.54s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:47<00:41,  2.97s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:47<00:41,  2.97s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:01<01:23,  6.44s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:01<01:23,  6.44s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:08<01:18,  6.50s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:08<01:18,  6.50s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:11<00:58,  5.31s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:11<00:58,  5.31s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:13<00:44,  4.50s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:13<00:44,  4.50s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:15<00:33,  3.71s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:15<00:33,  3.71s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:22<00:38,  4.81s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:22<00:38,  4.81s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:28<00:34,  4.97s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:28<00:34,  4.97s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:29<00:23,  3.92s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:29<00:23,  3.92s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:32<00:17,  3.54s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:32<00:17,  3.54s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:33<00:11,  2.94s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:33<00:11,  2.94s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:35<00:07,  2.66s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:35<00:07,  2.66s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:44<00:09,  4.53s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:44<00:09,  4.53s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:48<00:04,  4.34s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:48<00:04,  4.34s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:49<00:00,  3.39s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:49<00:00,  3.39s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.578125	0.9186350108225108
	steps: 0.390625	0.5021577380952381
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5	0.914317230388659
	steps: 0.17857142857142858	0.3454081632653061
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8934844476511142
	steps: 0.16666666666666666	0.38241943241943244
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7855053178939819
	steps: 0.0	0.19869346339934574
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6091139019710449
	steps: 0.0	0.1399752208575738
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7200336700336699
	steps: 0.0	0.18777340974137313
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.6153846153846154	0.9406593406593406
	steps: 0.3076923076923077	0.5
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6538461538461539	0.9525335775335777
	steps: 0.3076923076923077	0.4444139194139194
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9095959595959597
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.3	0.8695454545454545
	steps: 0.1	0.3154761904761905
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.41071428571428575
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8831438402866973
	steps: 0.14285714285714285	0.32261904761904764
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 0.0	0.6666666666666665
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.8741258741258742
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8210526315789475
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6463319088319088
	steps: 0.0	0.10119292472233649
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.6875
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6772486772486773
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.28571428571428575
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7870370370370369
	steps: 0.0	0.07675438596491228
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8400673400673401
	steps: 0.0	0.25821729658046794
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05263157894736842
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5
	steps: 0.0	0.10526315789473685
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:50<00:00,  5.00s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.9069284555704483
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5207623295278948
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=8, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:05,  3.93s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:05,  3.93s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:02,  3.28s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:02,  3.28s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:23,  3.56s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:23,  3.56s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:21,  2.91s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:21,  2.91s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:48,  3.24s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:48,  3.24s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:13,  2.88s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:13,  2.88s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:20,  3.00s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<04:20,  3.00s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:34,  2.49s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:34,  2.49s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:09,  2.23s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:09,  2.23s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<06:27,  4.61s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<06:27,  4.61s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:19,  3.85s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:19,  3.85s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:40<04:56,  3.61s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:40<04:56,  3.61s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:50<07:49,  5.80s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:50<07:49,  5.80s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:00<09:19,  6.99s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:00<09:19,  6.99s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:05<08:29,  6.44s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:05<08:29,  6.44s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:16<10:07,  7.79s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:16<10:07,  7.79s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:21<08:41,  6.77s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:21<08:41,  6.77s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:24<07:21,  5.81s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:24<07:21,  5.81s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:27<06:00,  4.81s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:27<06:00,  4.81s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:33<06:27,  5.23s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:33<06:27,  5.23s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:43<08:17,  6.82s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:43<08:17,  6.82s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:55<10:01,  8.35s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:55<10:01,  8.35s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:01<08:55,  7.54s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:01<08:55,  7.54s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:05<07:39,  6.57s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:05<07:39,  6.57s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:10<06:54,  6.00s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:10<06:54,  6.00s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:13<05:42,  5.04s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:13<05:42,  5.04s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:20<06:26,  5.77s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:20<06:26,  5.77s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:23<05:26,  4.94s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:23<05:26,  4.94s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:24<04:09,  3.85s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:24<04:09,  3.85s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:31<05:05,  4.78s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:31<05:05,  4.78s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:37<05:09,  4.91s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:37<05:09,  4.91s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:44<05:42,  5.53s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:44<05:42,  5.53s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:46<04:40,  4.59s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:46<04:40,  4.59s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:51<04:46,  4.78s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:51<04:46,  4.78s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:53<03:52,  3.94s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:53<03:52,  3.94s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:56<03:21,  3.47s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:56<03:21,  3.47s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:00<03:40,  3.86s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:00<03:40,  3.86s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:08<04:35,  4.91s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:08<04:35,  4.91s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:14<04:55,  5.38s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:14<04:55,  5.38s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:17<04:12,  4.67s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:17<04:12,  4.67s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:24<04:37,  5.24s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:24<04:37,  5.24s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:25<03:35,  4.14s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:25<03:35,  4.14s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:32<04:12,  4.95s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:32<04:12,  4.95s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:49<07:01,  8.43s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:49<07:01,  8.43s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:59<07:23,  9.05s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:59<07:23,  9.05s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:13<08:28, 10.58s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:13<08:28, 10.58s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:24<08:14, 10.53s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:24<08:14, 10.53s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:44<10:13, 13.34s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:44<10:13, 13.34s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:47<07:49, 10.44s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:47<07:49, 10.44s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:57<07:24, 10.10s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:57<07:24, 10.10s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:08<07:34, 10.56s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:08<07:34, 10.56s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:13<06:05,  8.70s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:13<06:05,  8.70s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:18<05:09,  7.56s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:18<05:09,  7.56s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:20<04:02,  6.06s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:20<04:02,  6.06s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:25<03:43,  5.74s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:25<03:43,  5.74s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:28<03:09,  4.98s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:28<03:09,  4.98s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:35<03:23,  5.49s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:35<03:23,  5.49s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:40<03:13,  5.37s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:40<03:13,  5.37s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:42<02:31,  4.33s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:42<02:31,  4.33s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:01<05:00,  8.83s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:01<05:00,  8.83s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:09<04:43,  8.59s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:09<04:43,  8.59s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:13<03:47,  7.10s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:13<03:47,  7.10s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:16<02:58,  5.74s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:16<02:58,  5.74s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:26<03:38,  7.27s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:26<03:38,  7.27s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:49<05:41, 11.76s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:49<05:41, 11.76s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:52<04:17,  9.19s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:52<04:17,  9.19s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:54<03:13,  7.17s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:54<03:13,  7.17s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:56<02:24,  5.57s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:56<02:24,  5.57s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:00<02:05,  5.04s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:00<02:05,  5.04s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:03<01:43,  4.30s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:03<01:43,  4.30s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:04<01:22,  3.57s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:04<01:22,  3.57s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:10<01:29,  4.06s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:10<01:29,  4.06s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:12<01:16,  3.63s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:12<01:16,  3.63s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:16<01:12,  3.62s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:16<01:12,  3.62s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:19<01:06,  3.50s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:19<01:06,  3.50s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:23<01:03,  3.51s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:23<01:03,  3.51s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:24<00:50,  3.00s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:24<00:50,  3.00s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:27<00:45,  2.86s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:27<00:45,  2.86s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:29<00:39,  2.63s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:29<00:39,  2.63s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:34<00:46,  3.31s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:34<00:46,  3.31s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:45<01:12,  5.61s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:45<01:12,  5.61s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:50<01:05,  5.50s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:50<01:05,  5.50s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:52<00:49,  4.54s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:52<00:49,  4.54s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:54<00:37,  3.75s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:54<00:37,  3.75s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:56<00:28,  3.22s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:56<00:28,  3.22s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:05<00:38,  4.84s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:05<00:38,  4.84s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:11<00:36,  5.24s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:11<00:36,  5.24s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:13<00:24,  4.12s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:13<00:24,  4.12s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:15<00:18,  3.60s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:15<00:18,  3.60s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:17<00:12,  3.06s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:17<00:12,  3.06s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:18<00:07,  2.62s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:18<00:07,  2.62s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:26<00:08,  4.06s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:26<00:08,  4.06s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:30<00:04,  4.07s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:30<00:04,  4.07s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:31<00:00,  3.21s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:31<00:00,  3.21s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9065738081363082
	steps: 0.40625	0.5097470238095239
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.4642857142857143	0.8892193124335981
	steps: 0.17857142857142858	0.3500850340136054
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8934844476511142
	steps: 0.16666666666666666	0.3689714606381273
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7480820184023328
	steps: 0.0	0.1799311799311799
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6340136054421769
	steps: 0.0	0.1462121212121212
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7633656046470692
	steps: 0.0	0.1864989585577821
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9014859014859016
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9110735418427727
	steps: 0.38461538461538464	0.5373626373626373
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.6153846153846154	0.9262820512820513
	steps: 0.3076923076923077	0.43479853479853475
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.3	0.8768181818181819
	steps: 0.1	0.35714285714285715
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.7878787878787878
	steps: 0.0	0.3928571428571429
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8701568272996844
	steps: 0.14285714285714285	0.30532879818594105
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 0.0	0.6666666666666665
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.8181818181818181
	steps: 0.0	0.13636363636363635
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8210526315789475
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6386752136752136
	steps: 0.0	0.10846930846930847
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7946428571428572
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.24074074074074073
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.28571428571428575
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.730701754385965
	steps: 0.0	0.08088235294117647
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8363197586726997
	steps: 0.0	0.21153846153846154
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [08:31<00:00,  5.44s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val          0.900240318886591
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5216538005701264
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=9, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:03,  3.90s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<06:03,  3.90s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:06,  3.33s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:06,  3.33s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:30,  3.63s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:10<05:30,  3.63s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:27,  2.97s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:27,  2.97s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:09,  3.48s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:09,  3.48s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:33,  3.11s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:19<04:33,  3.11s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<03:55,  2.70s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:21<03:55,  2.70s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:22,  2.35s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:23<03:22,  2.35s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:05,  2.18s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:24<03:05,  2.18s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:32<05:38,  4.03s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:32<05:38,  4.03s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:35<04:48,  3.47s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:35<04:48,  3.47s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<04:36,  3.37s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<04:36,  3.37s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:47<06:53,  5.11s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:47<06:53,  5.11s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<08:36,  6.46s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<08:36,  6.46s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:01<07:45,  5.89s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:01<07:45,  5.89s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:09<08:23,  6.45s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:09<08:23,  6.45s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:13<07:31,  5.86s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:13<07:31,  5.86s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:27<10:31,  8.31s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:27<10:31,  8.31s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:30<08:21,  6.69s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:30<08:21,  6.69s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:38<08:39,  7.03s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:38<08:39,  7.03s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:49<09:56,  8.17s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:49<09:56,  8.17s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:56<09:33,  7.96s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:56<09:33,  7.96s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:03<09:04,  7.66s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:03<09:04,  7.66s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:09<08:19,  7.14s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:09<08:19,  7.14s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:13<06:52,  5.98s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:13<06:52,  5.98s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:15<05:43,  5.05s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:15<05:43,  5.05s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:25<06:59,  6.27s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:25<06:59,  6.27s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:28<05:49,  5.30s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:28<05:49,  5.30s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:29<04:33,  4.21s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:29<04:33,  4.21s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:36<05:19,  4.99s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:36<05:19,  4.99s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:41<05:07,  4.88s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:41<05:07,  4.88s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:49<05:57,  5.76s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:49<05:57,  5.76s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:51<04:54,  4.82s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:51<04:54,  4.82s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:57<05:07,  5.13s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:57<05:07,  5.13s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:59<04:03,  4.13s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:59<04:03,  4.13s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:01<03:30,  3.63s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:01<03:30,  3.63s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:05<03:29,  3.68s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:05<03:29,  3.68s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:15<05:11,  5.57s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:15<05:11,  5.57s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:24<06:06,  6.66s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:24<06:06,  6.66s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:29<05:29,  6.10s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:29<05:29,  6.10s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:33<04:56,  5.59s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:33<04:56,  5.59s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:35<03:50,  4.44s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:35<03:50,  4.44s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:42<04:19,  5.08s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:42<04:19,  5.08s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:11<10:17, 12.35s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:11<10:17, 12.35s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:22<09:39, 11.83s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:22<09:39, 11.83s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:35<09:45, 12.21s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:35<09:45, 12.21s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:42<08:23, 10.71s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:42<08:23, 10.71s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:59<09:44, 12.71s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:59<09:44, 12.71s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:03<07:23,  9.85s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:03<07:23,  9.85s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:10<06:40,  9.10s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:10<06:40,  9.10s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:17<06:07,  8.54s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:17<06:07,  8.54s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:24<05:37,  8.04s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:24<05:37,  8.04s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:28<04:38,  6.79s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:28<04:38,  6.79s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:31<03:41,  5.55s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:31<03:41,  5.55s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:36<03:33,  5.47s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:36<03:33,  5.47s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:39<03:01,  4.78s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:39<03:01,  4.78s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:43<02:52,  4.67s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:43<02:52,  4.67s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:48<02:49,  4.70s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:48<02:49,  4.70s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:50<02:17,  3.93s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:50<02:17,  3.93s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:16<05:53, 10.41s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:16<05:53, 10.41s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:27<05:49, 10.58s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:27<05:49, 10.58s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:32<04:47,  8.97s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:32<04:47,  8.97s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:35<03:39,  7.07s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:35<03:39,  7.07s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:46<04:11,  8.39s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:46<04:11,  8.39s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:09<06:07, 12.68s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:09<06:07, 12.68s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:12<04:35,  9.85s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:12<04:35,  9.85s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:15<03:26,  7.67s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:15<03:26,  7.67s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:17<02:34,  5.93s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:17<02:34,  5.93s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:19<02:05,  5.03s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:19<02:05,  5.03s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:23<01:46,  4.45s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:23<01:46,  4.45s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:24<01:24,  3.69s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:24<01:24,  3.69s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:30<01:33,  4.24s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:30<01:33,  4.24s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:34<01:27,  4.15s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:34<01:27,  4.15s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:38<01:20,  4.03s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:38<01:20,  4.03s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:41<01:12,  3.83s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:41<01:12,  3.83s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:45<01:11,  3.97s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:45<01:11,  3.97s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:47<00:56,  3.33s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:47<00:56,  3.33s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:50<00:51,  3.23s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:50<00:51,  3.23s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:52<00:42,  2.85s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:52<00:42,  2.85s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:56<00:44,  3.18s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:56<00:44,  3.18s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:09<01:20,  6.18s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:09<01:20,  6.18s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:15<01:14,  6.18s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:15<01:14,  6.18s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:18<00:56,  5.13s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:18<00:56,  5.13s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:21<00:44,  4.48s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:21<00:44,  4.48s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:23<00:33,  3.75s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:23<00:33,  3.75s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:31<00:39,  4.98s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:31<00:39,  4.98s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:46<00:54,  7.85s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:46<00:54,  7.85s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:47<00:35,  5.96s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:47<00:35,  5.96s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:50<00:25,  5.05s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:50<00:25,  5.05s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:52<00:16,  4.09s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:52<00:16,  4.09s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:54<00:10,  3.51s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:54<00:10,  3.51s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:07<00:12,  6.22s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:07<00:12,  6.22s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:10<00:05,  5.50s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:10<00:05,  5.50s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:12<00:00,  4.22s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:12<00:00,  4.22s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.578125	0.9165516774891775
	steps: 0.40625	0.5149553571428571
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.5	0.9039971932829075
	steps: 0.17857142857142858	0.3401643990929705
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8829406704406705
	steps: 0.1111111111111111	0.4369368286034953
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.0	0.7761983967449554
	steps: 0.0	0.2363704671396979
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5965642127296263
	steps: 0.0	0.14220209614946458
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7726443570837164
	steps: 0.0	0.1671001455208616
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9053469053469053
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9321123321123321
	steps: 0.38461538461538464	0.541025641025641
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.6538461538461539	0.9484126984126984
	steps: 0.3076923076923077	0.4567765567765568
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8786363636363635
	steps: 0.1	0.35992063492063486
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.41666666666666663
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8603111174539746
	steps: 0.07142857142857142	0.3297619047619048
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 0.0	0.8571428571428571
	steps: 0.0	0.9090909090909091
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.9151515151515153
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6068890174153333
	steps: 0.0	0.10379094589620906
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.6875
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.2037037037037037
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.8571428571428571
	steps: 0.0	0.3333333333333333
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7656695156695156
	steps: 0.0	0.08333333333333333
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9217273954116059
	steps: 0.0	0.23089591567852433
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:12<00:00,  5.87s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5828877005347594
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.9042265516163875
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5316440671957029
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:24,  4.14s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:24,  4.14s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:45,  3.75s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:45,  3.75s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:02,  3.98s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:02,  3.98s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:00,  3.34s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:00,  3.34s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:18<05:26,  3.66s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:18<05:26,  3.66s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:47,  3.27s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:47,  3.27s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:06,  2.84s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:06,  2.84s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:33,  2.48s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:33,  2.48s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:15,  2.30s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:15,  2.30s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:35<06:06,  4.36s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:35<06:06,  4.36s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:37<05:11,  3.75s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:37<05:11,  3.75s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:40<04:46,  3.50s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:40<04:46,  3.50s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:50<07:12,  5.34s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:50<07:12,  5.34s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:00<09:06,  6.83s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:00<09:06,  6.83s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:05<08:15,  6.27s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:05<08:15,  6.27s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:18<10:39,  8.19s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:18<10:39,  8.19s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:23<09:13,  7.18s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:23<09:13,  7.18s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:29<08:46,  6.93s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:29<08:46,  6.93s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:32<07:21,  5.88s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:32<07:21,  5.88s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:39<07:21,  5.97s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:39<07:21,  5.97s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:49<09:00,  7.40s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:49<09:00,  7.40s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:59<09:50,  8.19s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:59<09:50,  8.19s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:04<08:28,  7.17s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:04<08:28,  7.17s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:10<08:01,  6.88s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:10<08:01,  6.88s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:15<07:11,  6.25s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:15<07:11,  6.25s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:18<05:58,  5.27s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:18<05:58,  5.27s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:30<08:12,  7.35s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:30<08:12,  7.35s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:34<06:44,  6.13s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:34<06:44,  6.13s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:35<05:13,  4.83s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:35<05:13,  4.83s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:41<05:23,  5.06s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:41<05:23,  5.06s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:48<06:00,  5.72s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:48<06:00,  5.72s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:58<07:05,  6.86s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:58<07:05,  6.86s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:01<05:43,  5.64s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:01<05:43,  5.64s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:10<06:54,  6.90s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:10<06:54,  6.90s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:13<05:23,  5.48s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:13<05:23,  5.48s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:15<04:28,  4.63s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:15<04:28,  4.63s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:21<04:38,  4.88s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:21<04:38,  4.88s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:30<05:44,  6.15s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:30<05:44,  6.15s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:36<05:32,  6.05s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:36<05:32,  6.05s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:40<05:02,  5.60s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:40<05:02,  5.60s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:45<04:45,  5.39s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:45<04:45,  5.39s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:47<03:45,  4.33s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:47<03:45,  4.33s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:54<04:15,  5.01s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:54<04:15,  5.01s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:10<07:05,  8.50s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:10<07:05,  8.50s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:23<07:55,  9.71s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:23<07:55,  9.71s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:35<08:18, 10.40s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:35<08:18, 10.40s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:47<08:35, 10.96s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:47<08:35, 10.96s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:02<09:18, 12.14s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:02<09:18, 12.14s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:05<07:07,  9.50s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:05<07:07,  9.50s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:10<05:59,  8.17s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:10<05:59,  8.17s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:20<06:05,  8.51s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:20<06:05,  8.51s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:28<06:00,  8.59s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:28<06:00,  8.59s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:34<05:14,  7.66s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:34<05:14,  7.66s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:37<04:07,  6.18s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:37<04:07,  6.18s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:43<04:02,  6.23s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:43<04:02,  6.23s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:46<03:25,  5.42s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:46<03:25,  5.42s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:55<03:58,  6.46s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:55<03:58,  6.46s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:05<04:23,  7.33s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:05<04:23,  7.33s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:07<03:21,  5.76s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:07<03:21,  5.76s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:28<05:54, 10.41s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:28<05:54, 10.41s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:38<05:40, 10.31s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:38<05:40, 10.31s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:44<04:44,  8.89s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:44<04:44,  8.89s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:47<03:39,  7.08s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:47<03:39,  7.08s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:59<04:18,  8.62s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:59<04:18,  8.62s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:13<04:54, 10.16s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:13<04:54, 10.16s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:18<04:05,  8.77s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:18<04:05,  8.77s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:21<03:12,  7.14s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:21<03:12,  7.14s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:23<02:24,  5.56s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:23<02:24,  5.56s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:27<02:06,  5.08s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:27<02:06,  5.08s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:31<01:50,  4.58s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:31<01:50,  4.58s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:33<01:28,  3.84s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:33<01:28,  3.84s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:38<01:37,  4.41s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:38<01:37,  4.41s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:42<01:26,  4.10s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:42<01:26,  4.10s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:48<01:34,  4.70s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:48<01:34,  4.70s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:59<02:03,  6.48s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:59<02:03,  6.48s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:06<02:00,  6.71s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:06<02:00,  6.71s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:07<01:27,  5.16s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:07<01:27,  5.16s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:10<01:12,  4.54s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:10<01:12,  4.54s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:13<00:57,  3.83s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:13<00:57,  3.83s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:19<01:02,  4.47s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:19<01:02,  4.47s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:27<01:13,  5.62s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:27<01:13,  5.62s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:33<01:07,  5.63s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:33<01:07,  5.63s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:35<00:51,  4.70s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:35<00:51,  4.70s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:38<00:41,  4.19s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:38<00:41,  4.19s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:40<00:32,  3.57s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:40<00:32,  3.57s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:47<00:36,  4.60s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:47<00:36,  4.60s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:51<00:31,  4.49s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:51<00:31,  4.49s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:53<00:21,  3.65s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:53<00:21,  3.65s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:56<00:16,  3.36s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:56<00:16,  3.36s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:58<00:11,  2.90s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:58<00:11,  2.90s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:00<00:07,  2.60s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:00<00:07,  2.60s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:06<00:07,  3.77s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:06<00:07,  3.77s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:11<00:03,  3.98s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:11<00:03,  3.98s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:12<00:00,  3.17s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:12<00:00,  3.17s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56163317/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9895424836601308
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.546875	0.9053627795815296
	steps: 0.375	0.4845238095238096
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.39285714285714285	0.8611580879438022
	steps: 0.17857142857142858	0.3572562358276644
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8764249639249638
	steps: 0.16666666666666666	0.34445646945646946
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.78478526117845
	steps: 0.0	0.22625148131221004
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.586091602632956
	steps: 0.0	0.1659967017109874
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7534154094660219
	steps: 0.0	0.1974745416561273
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9086229086229086
	steps: 0.4594594594594595	0.5477477477477477
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8957875457875458
	steps: 0.3076923076923077	0.46813186813186813
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5	0.8820207570207571
	steps: 0.3076923076923077	0.43882783882783877
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.3	0.8747979797979799
	steps: 0.1	0.32595238095238094
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8430284001712572
	steps: 0.07142857142857142	0.26587301587301587
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8741258741258742
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7529411764705882
	steps: 0.0	0.16025641025641024
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6680836707152497
	steps: 0.0	0.12857512857512857
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7451923076923077
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6984126984126985
	steps: 0.0	0.2660818713450292
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.8571428571428571
	steps: 0.0	0.3333333333333333
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7352941176470589
	steps: 0.0	0.1396825396825397
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.9072346417884175
	steps: 0.0	0.3234989648033126
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:12<00:00,  5.88s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5508021390374331
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8937074996978986
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5160481726304131
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=15, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
