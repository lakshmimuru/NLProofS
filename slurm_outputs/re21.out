187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<04:59,  3.22s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<04:59,  3.22s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:24,  2.88s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:24,  2.88s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<05:12,  3.44s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<05:12,  3.44s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:32,  3.03s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:12<04:32,  3.03s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:56,  3.33s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<04:56,  3.33s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:18,  2.94s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:18,  2.94s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:20<03:43,  2.57s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:20<03:43,  2.57s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:21<03:08,  2.19s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:21<03:08,  2.19s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:23<02:48,  1.99s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:23<02:48,  1.99s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:32<05:52,  4.20s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:32<05:52,  4.20s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:34<04:53,  3.54s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:34<04:53,  3.54s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:36<04:16,  3.13s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:36<04:16,  3.13s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:41<04:56,  3.66s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:41<04:56,  3.66s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:45<05:13,  3.92s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:45<05:13,  3.92s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:49<05:09,  3.91s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:49<05:09,  3.91s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:56<06:20,  4.88s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:56<06:20,  4.88s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:01<06:04,  4.74s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:01<06:04,  4.74s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:07<06:28,  5.11s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:07<06:28,  5.11s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:09<05:28,  4.38s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:09<05:28,  4.38s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:15<05:56,  4.82s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:15<05:56,  4.82s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:26<07:55,  6.51s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:26<07:55,  6.51s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:33<08:13,  6.85s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:33<08:13,  6.85s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:38<07:16,  6.15s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:38<07:16,  6.15s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:42<06:32,  5.61s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:42<06:32,  5.61s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:45<05:19,  4.64s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:45<05:19,  4.64s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:47<04:33,  4.02s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:47<04:33,  4.02s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:53<04:56,  4.42s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:53<04:56,  4.42s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:55<04:20,  3.94s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:55<04:20,  3.94s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:57<03:25,  3.17s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:57<03:25,  3.17s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:01<03:44,  3.51s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:01<03:44,  3.51s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:04<03:29,  3.33s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:04<03:29,  3.33s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:10<04:14,  4.11s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:10<04:14,  4.11s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:12<03:36,  3.55s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:12<03:36,  3.55s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:17<03:57,  3.96s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:17<03:57,  3.96s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:19<03:12,  3.26s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:19<03:12,  3.26s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:20<02:40,  2.77s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:20<02:40,  2.77s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:24<02:46,  2.92s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:24<02:46,  2.92s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:32<04:09,  4.45s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:32<04:09,  4.45s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:37<04:13,  4.62s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:37<04:13,  4.62s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:39<03:34,  3.96s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:39<03:34,  3.96s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:43<03:23,  3.83s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:43<03:23,  3.83s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:44<02:33,  2.96s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:44<02:33,  2.96s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:53<04:04,  4.80s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:53<04:04,  4.80s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:02<05:01,  6.04s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:02<05:01,  6.04s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:13<06:21,  7.79s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:13<06:21,  7.79s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:29<08:01, 10.03s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:29<08:01, 10.03s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:43<08:45, 11.18s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:43<08:45, 11.18s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:52<08:04, 10.53s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:52<08:04, 10.53s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:57<06:51,  9.13s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:57<06:51,  9.13s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:02<05:36,  7.64s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:02<05:36,  7.64s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:09<05:22,  7.49s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:09<05:22,  7.49s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:14<04:44,  6.76s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:14<04:44,  6.76s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:17<03:59,  5.83s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:17<03:59,  5.83s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:20<03:11,  4.79s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:20<03:11,  4.79s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:23<02:50,  4.36s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:23<02:50,  4.36s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:26<02:30,  3.95s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:26<02:30,  3.95s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:30<02:26,  3.96s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:30<02:26,  3.96s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:34<02:18,  3.84s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:34<02:18,  3.84s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:35<01:52,  3.22s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:35<01:52,  3.22s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:53<04:12,  7.43s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:53<04:12,  7.43s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:00<03:58,  7.23s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:00<03:58,  7.23s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:03<03:12,  6.03s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:03<03:12,  6.03s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:05<02:33,  4.96s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:05<02:33,  4.96s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:19<03:45,  7.50s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:19<03:45,  7.50s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:37<05:12, 10.79s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:37<05:12, 10.79s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:42<04:10,  8.96s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:42<04:10,  8.96s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:44<03:04,  6.84s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:44<03:04,  6.84s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:45<02:15,  5.21s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:45<02:15,  5.21s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:48<01:55,  4.61s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:48<01:55,  4.61s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:51<01:34,  3.95s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:51<01:34,  3.95s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:52<01:15,  3.27s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:52<01:15,  3.27s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:56<01:15,  3.45s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:56<01:15,  3.45s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:58<01:04,  3.07s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:58<01:04,  3.07s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:02<01:06,  3.32s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:02<01:06,  3.32s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:06<01:02,  3.28s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:06<01:02,  3.28s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:09<00:59,  3.29s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:09<00:59,  3.29s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:10<00:43,  2.58s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:10<00:43,  2.58s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:12<00:41,  2.58s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:12<00:41,  2.58s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:14<00:35,  2.38s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:14<00:35,  2.38s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:18<00:39,  2.84s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:18<00:39,  2.84s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:22<00:39,  3.04s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:22<00:39,  3.04s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:25<00:39,  3.27s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:25<00:39,  3.27s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:28<00:33,  3.07s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:28<00:33,  3.07s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:31<00:29,  2.93s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:31<00:29,  2.93s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:32<00:23,  2.59s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:32<00:23,  2.59s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:35<00:20,  2.59s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:35<00:20,  2.59s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:39<00:21,  3.06s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:39<00:21,  3.06s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:41<00:15,  2.57s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:41<00:15,  2.57s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:43<00:12,  2.41s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:43<00:12,  2.41s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:44<00:08,  2.13s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:44<00:08,  2.13s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:46<00:05,  1.90s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:46<00:05,  1.90s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:55<00:08,  4.14s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:55<00:08,  4.14s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:58<00:03,  3.85s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:58<00:03,  3.85s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:59<00:00,  3.02s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:59<00:00,  3.02s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9090863997113997
	steps: 0.40625	0.5131696428571428
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.4642857142857143	0.8811192775478489
	steps: 0.17857142857142858	0.3686180882609454
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.8766407974741308
	steps: 0.1111111111111111	0.3443442360109027
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.07692307692307693	0.7858566871724767
	steps: 0.0	0.16560600628235778
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5730548089681218
	steps: 0.0	0.1425642984466514
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7427954292084727
	steps: 0.0	0.22223328201589068
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9067765567765568
	steps: 0.38461538461538464	0.5373626373626373
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5384615384615384	0.9036324786324788
	steps: 0.3076923076923077	0.44322344322344315
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8984343434343434
	steps: 0.1	0.3551587301587301
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.824668981811839
	steps: 0.07142857142857142	0.22170329670329675
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 0.0	0.923076923076923
	steps: 0.0	0.9090909090909091
	proof: 0.0	0.0
4 trees have size 13
	leaves: 0.5	0.8741258741258742
	steps: 0.0	0.21328671328671328
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8210526315789475
	steps: 0.0	0.22619047619047616
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.636650922177238
	steps: 0.0	0.15236430236430237
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7451923076923077
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6140350877192983
	steps: 0.0	0.17825311942959002
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.30769230769230765
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7606209150326797
	steps: 0.0	0.08683473389355743
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9584859584859583
	steps: 0.0	0.2984363081617086
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.08695652173913045
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:59<00:00,  4.47s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.8979502506880942
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5232437846270183
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=6, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<04:41,  3.03s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<04:41,  3.03s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<03:45,  2.45s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<03:45,  2.45s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:52,  3.22s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:52,  3.22s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:51,  2.58s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:51,  2.58s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<04:04,  2.75s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:13<04:04,  2.75s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:15<03:41,  2.51s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:15<03:41,  2.51s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:17<03:09,  2.17s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:17<03:09,  2.17s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:18<02:42,  1.89s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:18<02:42,  1.89s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:30,  1.77s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:30,  1.77s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:30<06:03,  4.32s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:30<06:03,  4.32s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:31<04:54,  3.54s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:31<04:54,  3.54s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:34<04:14,  3.10s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:34<04:14,  3.10s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:38<04:32,  3.36s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:38<04:32,  3.36s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:41<04:35,  3.45s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:41<04:35,  3.45s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:44<04:22,  3.33s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:44<04:22,  3.33s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:57<07:55,  6.10s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:57<07:55,  6.10s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:00<06:39,  5.18s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:00<06:39,  5.18s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:03<05:55,  4.68s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:03<05:55,  4.68s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:06<05:01,  4.01s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:06<05:01,  4.01s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:14<06:27,  5.23s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:14<06:27,  5.23s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:18<06:01,  4.95s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:18<06:01,  4.95s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:24<06:13,  5.19s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:24<06:13,  5.19s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:29<05:59,  5.07s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:29<05:59,  5.07s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:33<05:37,  4.81s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:33<05:37,  4.81s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:37<05:08,  4.47s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:37<05:08,  4.47s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:39<04:17,  3.79s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:39<04:17,  3.79s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:42<04:07,  3.70s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:42<04:07,  3.70s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:46<03:56,  3.58s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:46<03:56,  3.58s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:46<02:59,  2.76s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:46<02:59,  2.76s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:51<03:22,  3.17s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:51<03:22,  3.17s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:53<03:12,  3.05s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:53<03:12,  3.05s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:57<03:25,  3.31s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:57<03:25,  3.31s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:00<03:06,  3.05s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:00<03:06,  3.05s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:08<04:39,  4.65s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:08<04:39,  4.65s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:10<03:39,  3.73s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:10<03:39,  3.73s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:11<02:58,  3.07s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:11<02:58,  3.07s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:14<02:46,  2.93s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:14<02:46,  2.93s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:17<02:55,  3.14s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:17<02:55,  3.14s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:22<03:19,  3.62s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:22<03:19,  3.62s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:25<02:59,  3.32s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:25<02:59,  3.32s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:30<03:22,  3.82s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:30<03:22,  3.82s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:31<02:32,  2.93s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:31<02:32,  2.93s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:38<03:31,  4.14s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:38<03:31,  4.14s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:51<05:49,  6.99s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:51<05:49,  6.99s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:00<06:08,  7.51s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:00<06:08,  7.51s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:09<06:17,  7.87s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:09<06:17,  7.87s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:14<05:38,  7.21s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:14<05:38,  7.21s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:21<05:18,  6.92s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:21<05:18,  6.92s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:23<04:13,  5.64s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:23<04:13,  5.64s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:27<03:39,  4.98s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:27<03:39,  4.98s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:33<03:46,  5.26s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:33<03:46,  5.26s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:37<03:26,  4.92s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:37<03:26,  4.92s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:42<03:22,  4.95s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:42<03:22,  4.95s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:44<02:45,  4.13s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:44<02:45,  4.13s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:48<02:44,  4.22s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:48<02:44,  4.22s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:51<02:25,  3.82s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:51<02:25,  3.82s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:57<02:39,  4.31s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:57<02:39,  4.31s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:01<02:30,  4.19s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:01<02:30,  4.19s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:02<01:56,  3.32s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:02<01:56,  3.32s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:17<03:49,  6.75s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:17<03:49,  6.75s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:22<03:31,  6.41s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:22<03:31,  6.41s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:26<02:55,  5.47s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:26<02:55,  5.47s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:29<02:28,  4.80s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:29<02:28,  4.80s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:39<03:12,  6.40s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:39<03:12,  6.40s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:54<04:20,  8.97s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:54<04:20,  8.97s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:56<03:13,  6.93s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:56<03:13,  6.93s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:59<02:31,  5.60s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:59<02:31,  5.60s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:00<01:51,  4.29s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:00<01:51,  4.29s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:03<01:39,  3.97s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:03<01:39,  3.97s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:05<01:23,  3.49s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:05<01:23,  3.49s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:07<01:07,  2.93s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:07<01:07,  2.93s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:10<01:04,  2.95s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:10<01:04,  2.95s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:12<00:58,  2.77s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:12<00:58,  2.77s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:15<00:52,  2.60s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:15<00:52,  2.60s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:17<00:49,  2.59s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:17<00:49,  2.59s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:20<00:46,  2.60s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:20<00:46,  2.60s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:21<00:35,  2.08s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:21<00:35,  2.08s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:24<00:38,  2.44s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:24<00:38,  2.44s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:25<00:30,  2.07s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:25<00:30,  2.07s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:31<00:45,  3.22s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:31<00:45,  3.22s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:34<00:41,  3.20s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:34<00:41,  3.20s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:37<00:36,  3.02s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:37<00:36,  3.02s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:39<00:31,  2.83s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:39<00:31,  2.83s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:41<00:24,  2.50s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:41<00:24,  2.50s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:42<00:19,  2.19s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:42<00:19,  2.19s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:49<00:27,  3.45s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:49<00:27,  3.45s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:53<00:25,  3.61s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:53<00:25,  3.61s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:54<00:17,  2.85s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:54<00:17,  2.85s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:56<00:13,  2.62s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:56<00:13,  2.62s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:57<00:08,  2.24s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:57<00:08,  2.24s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:59<00:05,  1.97s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:59<00:05,  1.97s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:00<00:03,  1.88s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:00<00:03,  1.88s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:03<00:02,  2.19s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:03<00:02,  2.19s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:04<00:00,  1.81s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:04<00:00,  1.81s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9127840909090909
	steps: 0.390625	0.5042782738095238
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.4642857142857143	0.864984618556047
	steps: 0.17857142857142858	0.37094671201814056
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8945139736806405
	steps: 0.2222222222222222	0.38427128427128426
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.15384615384615385	0.7837064895888426
	steps: 0.0	0.254076692538231
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6730892356942777
	steps: 0.0	0.1776469562183848
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7095358345358346
	steps: 0.0	0.213734393625698
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9173745173745174
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.8871489621489622
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9136363636363637
	steps: 0.0	0.13
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.8936363636363638
	steps: 0.1	0.3392857142857143
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8610659182087753
	steps: 0.14285714285714285	0.33492063492063495
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.75	0.9807692307692307
	steps: 0.0	0.2517482517482517
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.775
	steps: 0.0	0.17424242424242425
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6861111111111112
	steps: 0.0	0.2025844525844526
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7205882352941176
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7598039215686274
	steps: 0.0	0.1873015873015873
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.8571428571428571
	steps: 0.0	0.5454545454545454
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6868686868686869
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9419191919191919
	steps: 0.0	0.2990777338603426
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5454545454545455
	steps: 0.0	0.1
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:04<00:00,  3.88s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.8995713166285674
      F1_proof_val          0.41711229946524064
      F1_steps_val           0.531583596981179
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=3, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=False, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:28,  3.53s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:28,  3.53s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:05,  3.32s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:05,  3.32s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:10,  4.07s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:10,  4.07s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:48,  3.21s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:48,  3.21s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:15,  3.54s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:15,  3.54s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:39,  3.18s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:39,  3.18s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:15,  2.93s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:15,  2.93s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:34,  2.49s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:34,  2.49s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:11,  2.26s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:11,  2.26s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:57,  5.69s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:57,  5.69s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:25,  4.64s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:25,  4.64s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:26,  3.98s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:26,  3.98s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:51,  4.34s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:51,  4.34s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<07:35,  5.69s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:57<07:35,  5.69s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:02<06:59,  5.32s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:02<06:59,  5.32s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:10<08:10,  6.29s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:10<08:10,  6.29s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:15<07:24,  5.78s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:15<07:24,  5.78s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:19<06:44,  5.32s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:19<06:44,  5.32s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:22<05:37,  4.50s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:22<05:37,  4.50s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:29<06:31,  5.30s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:29<06:31,  5.30s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:36<07:00,  5.76s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:36<07:00,  5.76s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:42<07:02,  5.87s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:42<07:02,  5.87s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:47<06:42,  5.66s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:47<06:42,  5.66s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:55<07:22,  6.33s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:55<07:22,  6.33s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:58<05:59,  5.21s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:58<05:59,  5.21s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:00<05:04,  4.48s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:00<05:04,  4.48s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:07<05:32,  4.96s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:07<05:32,  4.96s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:10<04:51,  4.42s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:10<04:51,  4.42s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:11<03:45,  3.47s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:11<03:45,  3.47s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:16<04:08,  3.88s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:16<04:08,  3.88s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:19<03:49,  3.65s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:19<03:49,  3.65s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:23<03:58,  3.85s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:23<03:58,  3.85s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:26<03:29,  3.44s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:26<03:29,  3.44s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:31<03:54,  3.91s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:31<03:54,  3.91s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:33<03:16,  3.34s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:33<03:16,  3.34s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:34<02:46,  2.87s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:34<02:46,  2.87s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:40<03:21,  3.54s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:40<03:21,  3.54s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:44<03:29,  3.75s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:44<03:29,  3.75s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:51<04:25,  4.83s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:51<04:25,  4.83s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:54<03:52,  4.30s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:54<03:52,  4.30s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:58<03:45,  4.25s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:58<03:45,  4.25s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:59<02:50,  3.28s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:59<02:50,  3.28s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:07<03:51,  4.54s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:07<03:51,  4.54s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:23<06:38,  7.98s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:23<06:38,  7.98s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:45<09:52, 12.10s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:45<09:52, 12.10s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:58<09:54, 12.39s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:58<09:54, 12.39s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:08<09:14, 11.80s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:08<09:14, 11.80s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:13<07:34,  9.87s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:13<07:34,  9.87s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:17<06:04,  8.11s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:17<06:04,  8.11s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:29<06:42,  9.15s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:29<06:42,  9.15s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:39<06:45,  9.43s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:39<06:45,  9.43s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:44<05:39,  8.09s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:44<05:39,  8.09s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:49<04:48,  7.03s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:49<04:48,  7.03s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:51<03:48,  5.72s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:51<03:48,  5.72s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:56<03:26,  5.30s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:56<03:26,  5.30s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:59<03:00,  4.75s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:59<03:00,  4.75s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:05<03:04,  5.00s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:05<03:04,  5.00s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:09<02:50,  4.74s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:09<02:50,  4.74s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:11<02:15,  3.86s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:11<02:15,  3.86s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:24<03:51,  6.81s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:24<03:51,  6.81s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:39<05:05,  9.26s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:39<05:05,  9.26s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:45<04:19,  8.11s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:45<04:19,  8.11s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:48<03:22,  6.54s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:48<03:22,  6.54s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:01<04:15,  8.51s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:01<04:15,  8.51s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:15<05:00, 10.38s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:15<05:00, 10.38s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:20<04:00,  8.59s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:20<04:00,  8.59s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:22<03:00,  6.70s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:22<03:00,  6.70s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:24<02:13,  5.15s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:24<02:13,  5.15s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:26<01:49,  4.37s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:26<01:49,  4.37s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:30<01:37,  4.07s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:30<01:37,  4.07s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:32<01:19,  3.44s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:32<01:19,  3.44s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:35<01:13,  3.34s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:35<01:13,  3.34s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:38<01:07,  3.20s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:38<01:07,  3.20s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:44<01:20,  4.04s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:44<01:20,  4.04s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:47<01:11,  3.77s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:47<01:11,  3.77s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:50<01:07,  3.75s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:50<01:07,  3.75s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:51<00:49,  2.94s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:51<00:49,  2.94s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:54<00:45,  2.87s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:54<00:45,  2.87s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:56<00:38,  2.53s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:56<00:38,  2.53s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:00<00:43,  3.13s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:00<00:43,  3.13s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:04<00:43,  3.34s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:04<00:43,  3.34s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:10<00:49,  4.15s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:10<00:49,  4.15s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:13<00:40,  3.72s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:13<00:40,  3.72s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:16<00:34,  3.43s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:16<00:34,  3.43s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:18<00:26,  2.97s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:18<00:26,  2.97s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:24<00:33,  4.14s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:24<00:33,  4.14s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:29<00:29,  4.21s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:29<00:29,  4.21s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:30<00:20,  3.38s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:30<00:20,  3.38s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:33<00:15,  3.12s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:33<00:15,  3.12s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:34<00:10,  2.68s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:34<00:10,  2.68s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:36<00:07,  2.39s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:36<00:07,  2.39s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:38<00:04,  2.30s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:38<00:04,  2.30s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:43<00:03,  3.14s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:43<00:03,  3.14s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:45<00:00,  2.55s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:45<00:00,  2.55s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9893557422969187
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.9055893759018758
	steps: 0.390625	0.4921378968253969
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5357142857142857	0.9127634270491415
	steps: 0.17857142857142858	0.38750000000000007
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.87410105326772
	steps: 0.2222222222222222	0.39229597562930896
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.07692307692307693	0.7941795622017103
	steps: 0.0	0.25195257231456325
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6070684144102986
	steps: 0.0	0.16594924683159978
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.6950742240215924
	steps: 0.0	0.22426184926184925
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9050895050895051
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8967032967032966
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.9232600732600733
	steps: 0.3076923076923077	0.43696581196581197
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9097979797979798
	steps: 0.1	0.37142857142857144
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8478576978576979
	steps: 0.14285714285714285	0.322562358276644
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9151515151515153
	steps: 0.0	0.23636363636363636
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.23076923076923073
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.636650922177238
	steps: 0.0	0.2065875301169419
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25874125874125875
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.2679738562091503
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.4615384615384615
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6721706226350189
	steps: 0.0	0.0787037037037037
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.8949938949938949
	steps: 0.0	0.30151515151515146
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.4210526315789474
	steps: 0.0	0.1111111111111111
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:45<00:00,  4.95s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.9008038309341269
      F1_proof_val          0.41711229946524064
      F1_steps_val           0.530431830062217
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=-10.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:02,  3.26s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:02,  3.26s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:16,  2.79s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:16,  2.79s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<03:55,  2.59s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<03:55,  2.59s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:30,  2.34s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:30,  2.34s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:38,  3.13s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:38,  3.13s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<04:13,  2.88s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<04:13,  2.88s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:18<03:45,  2.59s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:18<03:45,  2.59s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:19<02:55,  2.04s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:19<02:55,  2.04s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:22,  1.68s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:22,  1.68s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:32,  3.25s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:32,  3.25s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<03:59,  2.89s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<03:59,  2.89s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:44,  2.74s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:44,  2.74s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:00,  2.97s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:00,  2.97s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:15,  3.20s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:15,  3.20s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:42<04:21,  3.32s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:42<04:21,  3.32s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:51<06:14,  4.80s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:51<06:14,  4.80s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:55<06:02,  4.71s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:55<06:02,  4.71s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:58<05:18,  4.19s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:58<05:18,  4.19s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:01<04:40,  3.74s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:01<04:40,  3.74s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:06<05:12,  4.22s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:06<05:12,  4.22s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:13<05:57,  4.90s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:13<05:57,  4.90s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:18<06:02,  5.03s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:18<06:02,  5.03s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:24<06:31,  5.52s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:24<06:31,  5.52s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:29<06:02,  5.18s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:29<06:02,  5.18s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:33<05:26,  4.73s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:33<05:26,  4.73s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:35<04:39,  4.11s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:35<04:39,  4.11s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:40<04:54,  4.39s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:40<04:54,  4.39s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:43<04:24,  4.01s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:43<04:24,  4.01s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:44<03:19,  3.07s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:44<03:19,  3.07s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:50<04:06,  3.85s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:50<04:06,  3.85s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:53<03:50,  3.67s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:53<03:50,  3.67s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:56<03:33,  3.45s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:56<03:33,  3.45s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:58<03:02,  2.99s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:58<03:02,  2.99s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:03<03:32,  3.54s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:03<03:32,  3.54s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:04<02:51,  2.91s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:04<02:51,  2.91s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:06<02:23,  2.48s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:06<02:23,  2.48s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:08<02:24,  2.53s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:08<02:24,  2.53s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:11<02:29,  2.66s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:11<02:29,  2.66s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:16<02:57,  3.23s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:16<02:57,  3.23s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:19<02:54,  3.24s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:19<02:54,  3.24s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:24<03:12,  3.62s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:24<03:12,  3.62s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:25<02:25,  2.80s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:25<02:25,  2.80s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:30<03:02,  3.59s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:30<03:02,  3.59s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:42<05:02,  6.04s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:42<05:02,  6.04s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:49<05:11,  6.36s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:49<05:11,  6.36s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:58<05:45,  7.20s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [02:58<05:45,  7.20s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:07<06:03,  7.73s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:07<06:03,  7.73s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:12<05:24,  7.04s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:12<05:24,  7.04s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:16<04:32,  6.06s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:16<04:32,  6.06s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:22<04:23,  5.98s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:22<04:23,  5.98s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<04:40,  6.53s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<04:40,  6.53s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:35<04:12,  6.02s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:35<04:12,  6.02s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:40<03:58,  5.81s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:40<03:58,  5.81s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:42<03:01,  4.55s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:42<03:01,  4.55s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:45<02:48,  4.33s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:45<02:48,  4.33s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:49<02:34,  4.07s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:49<02:34,  4.07s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:53<02:32,  4.13s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:53<02:32,  4.13s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:57<02:26,  4.08s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:57<02:26,  4.08s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:58<01:49,  3.12s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:58<01:49,  3.12s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:14<04:02,  7.13s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:14<04:02,  7.13s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:21<03:50,  6.98s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:21<03:50,  6.98s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:24<03:00,  5.64s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:24<03:00,  5.64s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:27<02:31,  4.87s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:27<02:31,  4.87s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:33<02:38,  5.30s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:33<02:38,  5.30s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:47<03:53,  8.06s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:47<03:53,  8.06s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:50<03:01,  6.47s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:50<03:01,  6.47s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:53<02:21,  5.26s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:53<02:21,  5.26s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:54<01:42,  3.94s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:54<01:42,  3.94s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:56<01:27,  3.52s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:56<01:27,  3.52s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:58<01:14,  3.11s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:58<01:14,  3.11s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:01<01:07,  2.93s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:01<01:07,  2.93s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:04<01:06,  3.04s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:04<01:06,  3.04s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:06<00:59,  2.85s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:06<00:59,  2.85s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:09<00:56,  2.83s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:09<00:56,  2.83s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:12<00:51,  2.70s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:12<00:51,  2.70s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:16<00:56,  3.11s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:16<00:56,  3.11s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:17<00:41,  2.45s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:17<00:41,  2.45s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:19<00:37,  2.34s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:19<00:37,  2.34s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:20<00:28,  1.90s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:20<00:28,  1.90s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:24<00:35,  2.52s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:24<00:35,  2.52s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:26<00:32,  2.53s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:26<00:32,  2.53s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:30<00:35,  2.94s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:30<00:35,  2.94s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:33<00:31,  2.91s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:33<00:31,  2.91s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:35<00:28,  2.83s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:35<00:28,  2.83s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:37<00:22,  2.49s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:37<00:22,  2.49s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:41<00:23,  2.98s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:41<00:23,  2.98s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:45<00:21,  3.14s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:45<00:21,  3.14s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:46<00:15,  2.57s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:46<00:15,  2.57s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:49<00:13,  2.68s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:49<00:13,  2.68s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:51<00:09,  2.37s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:51<00:09,  2.37s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:53<00:06,  2.30s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:53<00:06,  2.30s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:55<00:04,  2.18s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:55<00:04,  2.18s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:58<00:02,  2.47s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:58<00:02,  2.47s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:58<00:00,  1.89s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:58<00:00,  1.89s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9862745098039215
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.878830717893218
	steps: 0.375	0.4672991071428571
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.42857142857142855	0.8255597577026148
	steps: 0.17857142857142858	0.3967403628117914
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.8692420234086902
	steps: 0.16666666666666666	0.37316017316017314
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6670260595957191
	steps: 0.0	0.2163379355687048
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5283390279188598
	steps: 0.0	0.13430735930735932
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6863132799059573
	steps: 0.0	0.1622660658466285
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9829268292682927
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8751608751608752
	steps: 0.4594594594594595	0.5018018018018018
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8307692307692308
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.854181929181929
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.2	0.8556998556998557
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9168181818181818
	steps: 0.1	0.41428571428571426
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8260009831438404
	steps: 0.07142857142857142	0.28888888888888886
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8833333333333334
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7100840336134454
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.5697335344394169
	steps: 0.0	0.1690850815850816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8
	steps: 0.0	0.17692307692307693
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.4705882352941176
	steps: 0.0	0.12777777777777777
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6257575757575756
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8100686498855835
	steps: 0.0	0.22923178933409114
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [05:58<00:00,  3.82s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5454545454545454
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8652127659454956
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5158229797079176
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=-10.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:29,  3.54s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:29,  3.54s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:44,  3.09s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:44,  3.09s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:23,  2.89s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:23,  2.89s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<04:02,  2.70s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<04:02,  2.70s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:16,  3.55s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:16,  3.55s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:40,  3.18s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:40,  3.18s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:20<03:40,  2.53s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:20<03:40,  2.53s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:21<02:54,  2.03s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:21<02:54,  2.03s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:22<02:24,  1.70s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:22<02:24,  1.70s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<07:03,  5.04s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<07:03,  5.04s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:49,  4.21s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:49,  4.21s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<05:07,  3.75s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<05:07,  3.75s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:43<05:02,  3.73s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:43<05:02,  3.73s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:47<05:05,  3.82s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:47<05:05,  3.82s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:51<05:06,  3.88s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:51<05:06,  3.88s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:59<06:43,  5.18s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:59<06:43,  5.18s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:07<07:45,  6.05s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:07<07:45,  6.05s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<07:09,  5.66s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<07:09,  5.66s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:15<06:05,  4.87s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:15<06:05,  4.87s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:23<07:08,  5.80s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:23<07:08,  5.80s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:29<07:09,  5.88s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:29<07:09,  5.88s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:33<06:26,  5.37s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:33<06:26,  5.37s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:40<06:47,  5.74s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:40<06:47,  5.74s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:45<06:33,  5.63s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:45<06:33,  5.63s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:49<05:56,  5.16s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:49<05:56,  5.16s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:52<05:07,  4.52s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:52<05:07,  4.52s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:58<05:31,  4.94s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:58<05:31,  4.94s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:02<05:06,  4.64s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:02<05:06,  4.64s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:03<03:50,  3.54s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:03<03:50,  3.54s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:08<04:24,  4.13s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:08<04:24,  4.13s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:13<04:26,  4.23s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:13<04:26,  4.23s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:19<05:01,  4.87s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:19<05:01,  4.87s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:22<04:09,  4.09s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:22<04:09,  4.09s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:27<04:20,  4.34s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:27<04:20,  4.34s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:28<03:27,  3.52s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:28<03:27,  3.52s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:30<02:56,  3.03s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:30<02:56,  3.03s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:33<02:51,  3.01s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:33<02:51,  3.01s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:38<03:16,  3.51s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:38<03:16,  3.51s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:43<03:45,  4.10s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:43<03:45,  4.10s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:46<03:26,  3.83s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:46<03:26,  3.83s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:51<03:40,  4.16s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:51<03:40,  4.16s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:52<02:46,  3.20s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:52<02:46,  3.20s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:55<02:29,  2.93s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:55<02:29,  2.93s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:07<04:54,  5.89s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:07<04:54,  5.89s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:17<05:50,  7.14s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:17<05:50,  7.14s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:27<06:24,  8.02s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:27<06:24,  8.02s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:37<06:36,  8.44s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:37<06:36,  8.44s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:44<06:16,  8.19s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:44<06:16,  8.19s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:47<04:47,  6.39s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:47<04:47,  6.39s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:54<04:58,  6.77s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:54<04:58,  6.77s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:03<05:19,  7.44s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:03<05:19,  7.44s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:07<04:27,  6.37s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:07<04:27,  6.37s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:11<03:47,  5.55s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:11<03:47,  5.55s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:13<02:56,  4.42s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:13<02:56,  4.42s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:16<02:44,  4.22s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:16<02:44,  4.22s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:20<02:33,  4.04s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:20<02:33,  4.04s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:24<02:29,  4.03s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:24<02:29,  4.03s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:29<02:35,  4.32s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:29<02:35,  4.32s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:30<01:56,  3.32s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:30<01:56,  3.32s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:52<04:58,  8.79s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:52<04:58,  8.79s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:54<03:50,  6.97s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:54<03:50,  6.97s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:58<03:09,  5.93s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:58<03:09,  5.93s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:01<02:35,  5.03s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:01<02:35,  5.03s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:09<03:03,  6.13s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:09<03:03,  6.13s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:25<04:18,  8.92s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:25<04:18,  8.92s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:28<03:25,  7.33s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:28<03:25,  7.33s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:31<02:40,  5.93s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:31<02:40,  5.93s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:32<01:55,  4.44s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:32<01:55,  4.44s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:35<01:38,  3.95s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:35<01:38,  3.95s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:37<01:23,  3.49s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:37<01:23,  3.49s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:39<01:04,  2.81s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:39<01:04,  2.81s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:42<01:03,  2.88s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:42<01:03,  2.88s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:44<00:59,  2.83s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:44<00:59,  2.83s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:47<00:58,  2.91s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:47<00:58,  2.91s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:50<00:54,  2.85s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:50<00:54,  2.85s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:55<00:59,  3.32s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:55<00:59,  3.32s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:55<00:44,  2.62s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:55<00:44,  2.62s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:58<00:40,  2.54s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:58<00:40,  2.54s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:59<00:31,  2.08s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:59<00:31,  2.08s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:02<00:34,  2.43s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:02<00:34,  2.43s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:05<00:35,  2.70s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:05<00:35,  2.70s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:08<00:32,  2.72s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:08<00:32,  2.72s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:12<00:32,  2.91s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:12<00:32,  2.91s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:15<00:29,  2.93s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:15<00:29,  2.93s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:16<00:23,  2.63s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:16<00:23,  2.63s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:21<00:24,  3.07s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:21<00:24,  3.07s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:25<00:23,  3.34s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:25<00:23,  3.34s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:25<00:15,  2.63s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:25<00:15,  2.63s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:29<00:13,  2.74s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:29<00:13,  2.74s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:30<00:09,  2.48s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:30<00:09,  2.48s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:33<00:07,  2.44s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:33<00:07,  2.44s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:37<00:05,  2.94s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:37<00:05,  2.94s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:40<00:03,  3.13s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:40<00:03,  3.13s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:41<00:00,  2.44s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:41<00:00,  2.44s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9215686274509803	0.9736694677871148
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.484375	0.847035082972583
	steps: 0.328125	0.4062872023809524
	proof: 0.328125	0.328125
28 trees have depth 3
	leaves: 0.39285714285714285	0.8261137671851958
	steps: 0.14285714285714285	0.3546768707482993
	proof: 0.14285714285714285	0.14285714285714285
18 trees have depth 4
	leaves: 0.3888888888888889	0.8116884658551324
	steps: 0.16666666666666666	0.38638768638768645
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6775507423697469
	steps: 0.0	0.14155942097118565
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.46440576230492187
	steps: 0.0	0.1091628959276018
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.5304232804232805
	steps: 0.0	0.1418859649122807
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.926829268292683	0.9707317073170731
	steps: 0.926829268292683	0.926829268292683
	proof: 0.926829268292683	0.926829268292683
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.6	0.6
	proof: 0.6	0.6
37 trees have size 5
	leaves: 0.4864864864864865	0.8592020592020593
	steps: 0.3783783783783784	0.4207207207207207
	proof: 0.3783783783783784	0.3783783783783784
13 trees have size 6
	leaves: 0.46153846153846156	0.821001221001221
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5384615384615384	0.8521062271062271
	steps: 0.2692307692307692	0.39816849816849814
	proof: 0.2692307692307692	0.2692307692307692
5 trees have size 8
	leaves: 0.2	0.827922077922078
	steps: 0.0	0.13
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9147979797979799
	steps: 0.1	0.44642857142857145
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.14285714285714285	0.6621378621378621
	steps: 0.07142857142857142	0.2654761904761905
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9006410256410255
	steps: 0.0	0.18636363636363634
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.375
	steps: 0.0	0.09090909090909091
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.4683904330963155
	steps: 0.0	0.07816627816627816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8705882352941177
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.693627450980392
	steps: 0.0	0.12605042016806722
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7692307692307693
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6896613190730837
	steps: 0.0	0.1469298245614035
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.5132275132275133
	steps: 0.0	0.14860681114551086
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:41<00:00,  4.27s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5133689839572193
  ExactMatch_proof_val      0.3850267379679144
  ExactMatch_steps_val      0.3850267379679144
      F1_leaves_val         0.8387727577724432
      F1_proof_val          0.3850267379679144
      F1_steps_val          0.4831232097428021
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=-10.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:26,  3.51s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:26,  3.51s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:55,  3.21s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:55,  3.21s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:05,  4.02s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:05,  4.02s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:45,  3.18s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:45,  3.18s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:14,  3.53s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:14,  3.53s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:39,  3.18s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:39,  3.18s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:15,  2.94s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:15,  2.94s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:34,  2.50s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:34,  2.50s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:17,  2.32s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:25<03:17,  2.32s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:58,  5.70s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:58,  5.70s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:26,  4.66s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:26,  4.66s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:27,  3.99s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<05:27,  3.99s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:52,  4.35s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:52,  4.35s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:10<12:50,  9.63s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:10<12:50,  9.63s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:15<10:32,  8.01s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:15<10:32,  8.01s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:30<13:14, 10.19s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:30<13:14, 10.19s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:35<10:55,  8.51s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:35<10:55,  8.51s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:39<09:11,  7.25s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:39<09:11,  7.25s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:42<07:18,  5.85s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:42<07:18,  5.85s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:47<07:00,  5.68s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:47<07:00,  5.68s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:53<07:17,  5.99s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:53<07:17,  5.99s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:02<08:01,  6.68s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:02<08:01,  6.68s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:07<07:22,  6.24s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:07<07:22,  6.24s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:15<08:02,  6.90s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:15<08:02,  6.90s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:18<06:27,  5.62s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:18<06:27,  5.62s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:21<05:24,  4.78s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:21<05:24,  4.78s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:26<05:36,  5.02s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:26<05:36,  5.02s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:30<04:54,  4.47s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:30<04:54,  4.47s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:31<03:47,  3.50s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:31<03:47,  3.50s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:36<04:20,  4.07s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:36<04:20,  4.07s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:40<04:07,  3.93s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:40<04:07,  3.93s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:44<04:10,  4.05s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:44<04:10,  4.05s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:47<03:38,  3.59s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:47<03:38,  3.59s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:53<04:26,  4.44s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:53<04:26,  4.44s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:55<03:42,  3.77s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:55<03:42,  3.77s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:57<03:04,  3.18s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:57<03:04,  3.18s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:01<03:10,  3.34s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:01<03:10,  3.34s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:05<03:22,  3.61s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:05<03:22,  3.61s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:11<04:03,  4.43s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:11<04:03,  4.43s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:15<03:42,  4.11s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:15<03:42,  4.11s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:22<04:34,  5.18s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:22<04:34,  5.18s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:24<03:24,  3.93s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:24<03:24,  3.93s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:31<04:15,  5.00s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:31<04:15,  5.00s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:40<05:10,  6.21s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:40<05:10,  6.21s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:51<06:07,  7.49s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:51<06:07,  7.49s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:00<06:29,  8.11s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:00<06:29,  8.11s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:07<05:58,  7.63s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:07<05:58,  7.63s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:13<05:37,  7.34s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:13<05:37,  7.34s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:17<04:45,  6.35s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:17<04:45,  6.35s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:26<05:12,  7.10s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:26<05:12,  7.10s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:36<05:35,  7.80s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:36<05:35,  7.80s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:41<05:03,  7.22s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:41<05:03,  7.22s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:47<04:35,  6.73s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:47<04:35,  6.73s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:50<03:40,  5.52s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:50<03:40,  5.52s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:55<03:32,  5.45s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:55<03:32,  5.45s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:58<03:04,  4.86s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:58<03:04,  4.86s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:03<03:01,  4.90s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:03<03:01,  4.90s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:08<02:46,  4.63s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:08<02:46,  4.63s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:09<02:12,  3.78s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:09<02:12,  3.78s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:20<03:19,  5.85s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:20<03:19,  5.85s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:28<03:36,  6.56s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:28<03:36,  6.56s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:33<03:09,  5.92s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:33<03:09,  5.92s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:36<02:35,  5.01s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:36<02:35,  5.01s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:53<04:25,  8.84s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:53<04:25,  8.84s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:07<04:55, 10.21s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:07<04:55, 10.21s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:13<04:16,  9.17s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:13<04:16,  9.17s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:16<03:12,  7.11s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:16<03:12,  7.11s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:17<02:21,  5.45s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:17<02:21,  5.45s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:21<02:02,  4.88s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:21<02:02,  4.88s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:23<01:39,  4.16s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:23<01:39,  4.16s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:26<01:21,  3.56s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:26<01:21,  3.56s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:29<01:15,  3.43s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:29<01:15,  3.43s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:31<01:07,  3.22s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:31<01:07,  3.22s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:35<01:07,  3.39s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:35<01:07,  3.39s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:38<01:02,  3.31s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:38<01:02,  3.31s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:42<01:01,  3.44s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:42<01:01,  3.44s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:43<00:46,  2.72s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:43<00:46,  2.72s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:46<00:43,  2.74s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:46<00:43,  2.74s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:48<00:36,  2.45s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:48<00:36,  2.45s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:52<00:43,  3.09s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:52<00:43,  3.09s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:56<00:43,  3.38s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:56<00:43,  3.38s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:02<00:47,  3.94s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:02<00:47,  3.94s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:04<00:39,  3.61s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:04<00:39,  3.61s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:06<00:31,  3.12s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:06<00:31,  3.12s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:08<00:24,  2.75s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:08<00:24,  2.75s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:11<00:23,  2.89s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:11<00:23,  2.89s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:16<00:23,  3.37s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:16<00:23,  3.37s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:17<00:16,  2.79s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:17<00:16,  2.79s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:20<00:13,  2.70s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:20<00:13,  2.70s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:21<00:09,  2.38s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:21<00:09,  2.38s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:23<00:06,  2.12s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:23<00:06,  2.12s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:25<00:04,  2.12s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:25<00:04,  2.12s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:29<00:02,  2.77s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:29<00:02,  2.77s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:31<00:00,  2.30s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:31<00:00,  2.30s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9895424836601308
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9092724116161617
	steps: 0.390625	0.5048363095238095
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5	0.9083133136704566
	steps: 0.17857142857142858	0.3947278911564626
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8745450537117204
	steps: 0.2222222222222222	0.3700737534070867
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.07692307692307693	0.7844892525114007
	steps: 0.0	0.20890843696273562
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6070684144102986
	steps: 0.0	0.14213972302207598
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7708937198067632
	steps: 0.0	0.26596332517385146
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8967032967032966
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.9254578754578755
	steps: 0.3076923076923077	0.4695970695970696
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.900909090909091
	steps: 0.1	0.37142857142857144
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.839770546913404
	steps: 0.14285714285714285	0.2854875283446712
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8961038961038961
	steps: 0.0	0.21328671328671328
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6227620332883491
	steps: 0.0	0.2050002285296403
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25874125874125875
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.21241830065359477
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.4615384615384615
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7633986928104575
	steps: 0.0	0.1118421052631579
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9444444444444443
	steps: 0.0	0.351010101010101
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:31<00:00,  4.80s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5828877005347594
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.9032507286740408
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5311754011547889
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=-7.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:09,  3.33s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:09,  3.33s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:23,  2.86s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:23,  2.86s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:01,  2.66s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:01,  2.66s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:36,  2.40s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:36,  2.40s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:15<04:51,  3.27s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:15<04:51,  3.27s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:17<04:17,  2.93s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:17<04:17,  2.93s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:50,  2.65s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:50,  2.65s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:59,  2.08s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:59,  2.08s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:25,  1.71s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:25,  1.71s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:28<04:39,  3.33s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:28<04:39,  3.33s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:30<04:05,  2.96s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:30<04:05,  2.96s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:32<03:50,  2.81s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:32<03:50,  2.81s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:36<04:06,  3.04s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:36<04:06,  3.04s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:40<04:22,  3.28s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:40<04:22,  3.28s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:44<04:33,  3.46s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:44<04:33,  3.46s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:52<06:22,  4.90s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:52<06:22,  4.90s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:56<06:10,  4.81s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:56<06:10,  4.81s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:25,  4.28s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:25,  4.28s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:02<04:46,  3.82s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:02<04:46,  3.82s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:08<05:18,  4.31s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:08<05:18,  4.31s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:13<05:38,  4.64s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:13<05:38,  4.64s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:18<05:48,  4.85s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:18<05:48,  4.85s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:26<06:34,  5.55s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:26<06:34,  5.55s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:30<05:55,  5.07s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:30<05:55,  5.07s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:33<05:23,  4.69s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:33<05:23,  4.69s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:36<04:38,  4.10s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:36<04:38,  4.10s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:42<05:02,  4.52s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:42<05:02,  4.52s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:45<04:40,  4.24s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:45<04:40,  4.24s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:46<03:30,  3.24s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:46<03:30,  3.24s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:52<04:26,  4.16s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:52<04:26,  4.16s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:56<04:05,  3.90s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:56<04:05,  3.90s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:59<03:45,  3.64s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:59<03:45,  3.64s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:01<03:13,  3.17s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:01<03:13,  3.17s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:05<03:37,  3.62s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:05<03:37,  3.62s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:07<02:59,  3.04s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:07<02:59,  3.04s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:09<02:29,  2.58s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:09<02:29,  2.58s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:11<02:31,  2.66s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:11<02:31,  2.66s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:16<03:00,  3.23s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:16<03:00,  3.23s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:20<03:08,  3.43s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:20<03:08,  3.43s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:24<03:13,  3.58s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:24<03:13,  3.58s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:28<03:16,  3.71s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:28<03:16,  3.71s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:29<02:29,  2.87s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:29<02:29,  2.87s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:34<02:59,  3.53s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:34<02:59,  3.53s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:46<05:06,  6.14s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:46<05:06,  6.14s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:55<05:37,  6.89s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:55<05:37,  6.89s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:03<05:49,  7.28s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:03<05:49,  7.28s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:12<06:05,  7.78s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:12<06:05,  7.78s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:17<05:27,  7.11s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:17<05:27,  7.11s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:21<04:33,  6.07s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:21<04:33,  6.07s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:28<04:33,  6.21s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:28<04:33,  6.21s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:35<04:42,  6.58s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:35<04:42,  6.58s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:40<04:15,  6.08s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:40<04:15,  6.08s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:46<04:03,  5.95s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:46<04:03,  5.95s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:47<03:06,  4.65s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:47<03:06,  4.65s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:51<02:50,  4.36s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:51<02:50,  4.36s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:54<02:35,  4.09s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:54<02:35,  4.09s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:59<02:33,  4.15s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:59<02:33,  4.15s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:03<02:27,  4.11s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:03<02:27,  4.11s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:03<01:50,  3.15s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:03<01:50,  3.15s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:21<04:15,  7.51s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:21<04:15,  7.51s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:29<04:09,  7.57s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:29<04:09,  7.57s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:33<03:24,  6.41s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:33<03:24,  6.41s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:36<02:48,  5.44s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:36<02:48,  5.44s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:42<02:53,  5.79s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:42<02:53,  5.79s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:01<04:38,  9.61s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:01<04:38,  9.61s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:04<03:35,  7.70s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:04<03:35,  7.70s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:07<02:45,  6.12s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:07<02:45,  6.12s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:07<01:58,  4.55s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:07<01:58,  4.55s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:12<01:53,  4.54s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:12<01:53,  4.54s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:15<01:35,  3.99s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:15<01:35,  3.99s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:17<01:21,  3.56s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:17<01:21,  3.56s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:21<01:17,  3.50s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:21<01:17,  3.50s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:23<01:06,  3.18s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:23<01:06,  3.18s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:26<00:59,  2.98s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:26<00:59,  2.98s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:28<00:53,  2.81s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:28<00:53,  2.81s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:32<00:56,  3.14s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:32<00:56,  3.14s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:33<00:41,  2.47s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:33<00:41,  2.47s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:35<00:37,  2.36s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:35<00:37,  2.36s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:36<00:28,  1.92s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:36<00:28,  1.92s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:40<00:36,  2.63s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:40<00:36,  2.63s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:43<00:34,  2.68s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:43<00:34,  2.68s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:46<00:34,  2.91s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:46<00:34,  2.91s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:49<00:31,  2.87s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:49<00:31,  2.87s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:52<00:28,  2.82s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:52<00:28,  2.82s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:54<00:22,  2.50s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:54<00:22,  2.50s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:58<00:24,  3.07s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:58<00:24,  3.07s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:02<00:23,  3.37s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:02<00:23,  3.37s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:03<00:16,  2.68s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:03<00:16,  2.68s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:06<00:13,  2.62s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:06<00:13,  2.62s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:07<00:09,  2.34s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:07<00:09,  2.34s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:09<00:06,  2.11s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:09<00:06,  2.11s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:11<00:04,  2.02s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:11<00:04,  2.02s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:13<00:02,  2.25s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:13<00:02,  2.25s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:14<00:00,  1.75s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:14<00:00,  1.75s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9862745098039215
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.878830717893218
	steps: 0.375	0.4672991071428571
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.42857142857142855	0.8255597577026148
	steps: 0.17857142857142858	0.3967403628117914
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8687980229646897
	steps: 0.16666666666666666	0.37161696328363
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6655915966227947
	steps: 0.0	0.1829866714482099
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5188775510204081
	steps: 0.0	0.1379644165358451
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6726680557344173
	steps: 0.0	0.16349155604270693
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9829268292682927
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8751608751608752
	steps: 0.4594594594594595	0.5018018018018018
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8307692307692308
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.854181929181929
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.2	0.8556998556998557
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9168181818181818
	steps: 0.1	0.41428571428571426
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8254301254301255
	steps: 0.07142857142857142	0.2869047619047619
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8423076923076923
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7100840336134454
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.5811041083099907
	steps: 0.0	0.1673992673992674
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8
	steps: 0.0	0.17692307692307693
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.4257703081232493
	steps: 0.0	0.13968253968253966
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6742424242424242
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8100686498855835
	steps: 0.0	0.22923178933409114
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:14<00:00,  3.98s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5508021390374331
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8642783182986591
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5135321140952526
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=-7.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:24,  3.48s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:24,  3.48s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:38,  3.03s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:38,  3.03s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:17,  2.83s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:17,  2.83s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:50,  2.56s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:50,  2.56s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:11,  3.50s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:11,  3.50s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:35,  3.13s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:35,  3.13s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:36,  2.49s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:36,  2.49s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:51,  2.00s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:51,  2.00s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:22,  1.67s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:22,  1.67s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:33<06:56,  4.96s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:33<06:56,  4.96s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:43,  4.14s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:43,  4.14s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<05:01,  3.68s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<05:01,  3.68s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:42<04:56,  3.66s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:42<04:56,  3.66s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:46<04:59,  3.75s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:46<04:59,  3.75s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:50<05:00,  3.80s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:50<05:00,  3.80s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:58<06:34,  5.06s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:58<06:34,  5.06s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:06<07:34,  5.90s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:06<07:34,  5.90s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:10<06:54,  5.45s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:10<06:54,  5.45s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:13<05:56,  4.76s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:13<05:56,  4.76s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:21<06:57,  5.65s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:21<06:57,  5.65s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:27<06:57,  5.72s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:27<06:57,  5.72s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:31<06:16,  5.23s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:31<06:16,  5.23s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:37<06:29,  5.49s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:37<06:29,  5.49s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:42<06:17,  5.39s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:42<06:17,  5.39s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:46<05:42,  4.97s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:46<05:42,  4.97s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:49<04:56,  4.35s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:49<04:56,  4.35s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:56<05:34,  4.99s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:56<05:34,  4.99s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:59<05:06,  4.64s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:59<05:06,  4.64s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:00<03:49,  3.53s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:00<03:49,  3.53s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:06<04:20,  4.07s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:06<04:20,  4.07s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:10<04:18,  4.10s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:10<04:18,  4.10s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:15<04:40,  4.53s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:15<04:40,  4.53s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:18<03:53,  3.83s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:18<03:53,  3.83s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:22<04:03,  4.06s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:22<04:03,  4.06s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:24<03:19,  3.38s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:24<03:19,  3.38s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:25<02:42,  2.80s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:25<02:42,  2.80s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:28<02:39,  2.80s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:28<02:39,  2.80s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:32<02:48,  3.00s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:32<02:48,  3.00s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:37<03:23,  3.69s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:37<03:23,  3.69s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:40<03:09,  3.52s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:40<03:09,  3.52s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:44<03:14,  3.68s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:44<03:14,  3.68s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:45<02:28,  2.86s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:45<02:28,  2.86s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:47<02:16,  2.67s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:47<02:16,  2.67s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:57<03:54,  4.69s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:57<03:54,  4.69s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:04<04:29,  5.51s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:04<04:29,  5.51s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:14<05:30,  6.89s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:14<05:30,  6.89s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:22<05:34,  7.11s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:22<05:34,  7.11s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:29<05:23,  7.03s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:29<05:23,  7.03s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:31<04:12,  5.61s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:31<04:12,  5.61s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:40<04:57,  6.76s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:40<04:57,  6.76s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:49<05:18,  7.42s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:49<05:18,  7.42s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:54<04:32,  6.49s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:54<04:32,  6.49s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:58<03:53,  5.70s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:58<03:53,  5.70s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:59<03:00,  4.51s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:59<03:00,  4.51s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:03<02:45,  4.25s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:03<02:45,  4.25s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:06<02:32,  4.02s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:06<02:32,  4.02s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:11<02:33,  4.16s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:11<02:33,  4.16s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:15<02:27,  4.10s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:15<02:27,  4.10s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:16<01:50,  3.16s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:16<01:50,  3.16s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:35<04:30,  7.95s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:35<04:30,  7.95s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:37<03:28,  6.32s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:37<03:28,  6.32s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:42<03:01,  5.68s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:42<03:01,  5.68s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:45<02:29,  4.83s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:45<02:29,  4.83s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:55<03:14,  6.49s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:55<03:14,  6.49s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:10<04:27,  9.22s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:10<04:27,  9.22s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:13<03:24,  7.30s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:13<03:24,  7.30s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:16<02:39,  5.90s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:16<02:39,  5.90s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:17<01:54,  4.41s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:17<01:54,  4.41s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:20<01:37,  3.91s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:20<01:37,  3.91s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:22<01:22,  3.45s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:22<01:22,  3.45s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:23<01:03,  2.76s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:23<01:03,  2.76s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:26<01:00,  2.77s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:26<01:00,  2.77s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:29<00:57,  2.72s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:29<00:57,  2.72s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:31<00:54,  2.71s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:31<00:54,  2.71s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:34<00:50,  2.68s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:34<00:50,  2.68s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:38<00:58,  3.26s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:38<00:58,  3.26s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:39<00:43,  2.57s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:39<00:43,  2.57s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:42<00:40,  2.54s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:42<00:40,  2.54s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:43<00:31,  2.07s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:43<00:31,  2.07s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:46<00:34,  2.44s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:46<00:34,  2.44s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:49<00:34,  2.68s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:49<00:34,  2.68s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:53<00:36,  3.05s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:53<00:36,  3.05s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:57<00:35,  3.18s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:57<00:35,  3.18s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:00<00:30,  3.09s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:00<00:30,  3.09s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:02<00:24,  2.72s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:02<00:24,  2.72s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:05<00:24,  3.03s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:05<00:24,  3.03s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:10<00:25,  3.62s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:10<00:25,  3.62s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:11<00:17,  2.87s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:11<00:17,  2.87s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:14<00:14,  2.89s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:14<00:14,  2.89s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:16<00:10,  2.56s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:16<00:10,  2.56s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:18<00:07,  2.48s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:18<00:07,  2.48s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:22<00:05,  2.94s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:22<00:05,  2.94s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:26<00:03,  3.10s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:26<00:03,  3.10s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:26<00:00,  2.35s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:26<00:00,  2.35s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9215686274509803	0.9736694677871148
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.484375	0.8487091901154401
	steps: 0.328125	0.4062872023809524
	proof: 0.328125	0.328125
28 trees have depth 3
	leaves: 0.39285714285714285	0.8261137671851958
	steps: 0.14285714285714285	0.3546768707482993
	proof: 0.14285714285714285	0.14285714285714285
18 trees have depth 4
	leaves: 0.3888888888888889	0.8116884658551324
	steps: 0.16666666666666666	0.38638768638768645
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.685709250528255
	steps: 0.0	0.14155942097118565
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.47467653728157927
	steps: 0.0	0.1091628959276018
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.511904761904762
	steps: 0.0	0.1418859649122807
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.926829268292683	0.9707317073170731
	steps: 0.926829268292683	0.926829268292683
	proof: 0.926829268292683	0.926829268292683
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.6	0.6
	proof: 0.6	0.6
37 trees have size 5
	leaves: 0.4864864864864865	0.8592020592020593
	steps: 0.3783783783783784	0.4207207207207207
	proof: 0.3783783783783784	0.3783783783783784
13 trees have size 6
	leaves: 0.46153846153846156	0.821001221001221
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5384615384615384	0.8562271062271061
	steps: 0.2692307692307692	0.39816849816849814
	proof: 0.2692307692307692	0.2692307692307692
5 trees have size 8
	leaves: 0.2	0.827922077922078
	steps: 0.0	0.13
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9147979797979799
	steps: 0.1	0.44642857142857145
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.14285714285714285	0.6697136197136196
	steps: 0.07142857142857142	0.2654761904761905
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9006410256410255
	steps: 0.0	0.18636363636363634
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.375
	steps: 0.0	0.09090909090909091
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.4683904330963155
	steps: 0.0	0.07816627816627816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8705882352941177
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7175925925925926
	steps: 0.0	0.12605042016806722
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7692307692307693
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6896613190730837
	steps: 0.0	0.1469298245614035
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.5132275132275133
	steps: 0.0	0.14860681114551086
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.47916666666666663
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:27<00:00,  4.12s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5133689839572193
  ExactMatch_proof_val      0.3850267379679144
  ExactMatch_steps_val      0.3850267379679144
      F1_leaves_val         0.8397031736918494
      F1_proof_val          0.3850267379679144
      F1_steps_val          0.4831232097428021
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=-7.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:53,  4.45s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:53,  4.45s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<06:00,  3.92s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<06:00,  3.92s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:13<07:17,  4.81s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:13<07:17,  4.81s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:17<06:19,  4.21s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:17<06:19,  4.21s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:23<07:21,  4.96s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:23<07:21,  4.96s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:26<06:30,  4.44s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:26<06:30,  4.44s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:31<06:36,  4.55s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:31<06:36,  4.55s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:33<05:15,  3.67s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:33<05:15,  3.67s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:36<04:43,  3.34s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:36<04:43,  3.34s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:51<09:49,  7.02s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:51<09:49,  7.02s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:54<08:00,  5.79s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:54<08:00,  5.79s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:59<07:32,  5.51s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:59<07:32,  5.51s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:06<08:12,  6.08s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:06<08:12,  6.08s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:22<12:05,  9.07s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:22<12:05,  9.07s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:38<14:49, 11.26s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:38<14:49, 11.26s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:49<14:21, 11.05s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:49<14:21, 11.05s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:54<11:56,  9.31s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:54<11:56,  9.31s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [02:09<13:50, 10.93s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [02:09<13:50, 10.93s/it]Validation DataLoader 0:  20%|██        | 19/94 [02:13<11:01,  8.82s/it]Validation DataLoader 0:  20%|██        | 19/94 [02:13<11:01,  8.82s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:18<09:23,  7.62s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:18<09:23,  7.62s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:29<10:28,  8.61s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:29<10:28,  8.61s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:42<12:05, 10.08s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:42<12:05, 10.08s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:49<10:40,  9.02s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:49<10:40,  9.02s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:59<10:56,  9.38s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:59<10:56,  9.38s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [03:02<08:41,  7.56s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [03:02<08:41,  7.56s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [03:06<07:21,  6.49s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [03:06<07:21,  6.49s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:19<09:16,  8.31s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:19<09:16,  8.31s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:23<07:52,  7.16s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:23<07:52,  7.16s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:25<05:55,  5.47s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:25<05:55,  5.47s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:30<05:54,  5.55s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:30<05:54,  5.55s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:36<05:42,  5.43s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:36<05:42,  5.43s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:40<05:21,  5.18s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:40<05:21,  5.18s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:43<04:40,  4.61s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:43<04:40,  4.61s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:51<05:34,  5.58s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:51<05:34,  5.58s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:54<04:30,  4.58s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:54<04:30,  4.58s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:56<03:47,  3.92s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:56<03:47,  3.92s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:00<03:53,  4.09s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:00<03:53,  4.09s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:07<04:23,  4.70s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:07<04:23,  4.70s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:19<06:32,  7.13s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:19<06:32,  7.13s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:26<06:20,  7.05s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:26<06:20,  7.05s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:32<05:48,  6.58s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:32<05:48,  6.58s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:33<04:19,  4.99s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:33<04:19,  4.99s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:45<06:07,  7.21s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:45<06:07,  7.21s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:10<10:24, 12.49s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:10<10:24, 12.49s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:28<11:23, 13.95s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:28<11:23, 13.95s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:43<11:30, 14.38s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:43<11:30, 14.38s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:53<10:12, 13.04s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:53<10:12, 13.04s/it]Validation DataLoader 0:  51%|█████     | 48/94 [06:02<09:09, 11.94s/it]Validation DataLoader 0:  51%|█████     | 48/94 [06:02<09:09, 11.94s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [06:11<08:19, 11.11s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [06:11<08:19, 11.11s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [06:24<08:33, 11.67s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [06:24<08:33, 11.67s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:40<09:10, 12.81s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:40<09:10, 12.81s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:46<07:30, 10.73s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:46<07:30, 10.73s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:52<06:30,  9.51s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:52<06:30,  9.51s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:55<05:03,  7.60s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:55<05:03,  7.60s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [07:01<04:36,  7.08s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [07:01<04:36,  7.08s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [07:07<04:09,  6.58s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [07:07<04:09,  6.58s/it]Validation DataLoader 0:  61%|██████    | 57/94 [07:15<04:23,  7.13s/it]Validation DataLoader 0:  61%|██████    | 57/94 [07:15<04:23,  7.13s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [07:22<04:13,  7.04s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [07:22<04:13,  7.04s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [07:24<03:15,  5.59s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [07:24<03:15,  5.59s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:53<07:11, 12.68s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:53<07:11, 12.68s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [08:03<06:30, 11.83s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [08:03<06:30, 11.83s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [08:12<05:44, 10.76s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [08:12<05:44, 10.76s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [08:15<04:29,  8.69s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [08:15<04:29,  8.69s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [08:35<06:02, 12.09s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [08:35<06:02, 12.09s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [09:04<08:14, 17.04s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [09:04<08:14, 17.04s/it]Validation DataLoader 0:  70%|███████   | 66/94 [09:14<06:55, 14.84s/it]Validation DataLoader 0:  70%|███████   | 66/94 [09:14<06:55, 14.84s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [09:18<05:10, 11.52s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [09:18<05:10, 11.52s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [09:20<03:48,  8.78s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [09:20<03:48,  8.78s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [09:24<03:05,  7.42s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [09:24<03:05,  7.42s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [09:27<02:25,  6.07s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [09:27<02:25,  6.07s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [09:29<01:53,  4.94s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [09:29<01:53,  4.94s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [09:35<01:51,  5.08s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [09:35<01:51,  5.08s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [09:39<01:39,  4.74s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [09:39<01:39,  4.74s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [09:45<01:42,  5.12s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [09:45<01:42,  5.12s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [09:49<01:30,  4.74s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [09:49<01:30,  4.74s/it]Validation DataLoader 0:  81%|████████  | 76/94 [09:55<01:36,  5.35s/it]Validation DataLoader 0:  81%|████████  | 76/94 [09:55<01:36,  5.35s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [09:57<01:09,  4.09s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [09:57<01:09,  4.09s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [10:00<01:03,  3.94s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [10:00<01:03,  3.94s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [10:02<00:51,  3.42s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [10:02<00:51,  3.42s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [10:10<01:05,  4.65s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [10:10<01:05,  4.65s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [10:15<01:00,  4.66s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [10:15<01:00,  4.66s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [10:30<01:36,  8.01s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [10:30<01:36,  8.01s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [10:34<01:14,  6.79s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [10:34<01:14,  6.79s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [10:37<00:54,  5.48s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [10:37<00:54,  5.48s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [10:39<00:40,  4.53s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [10:39<00:40,  4.53s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [10:48<00:46,  5.76s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [10:48<00:46,  5.76s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [10:53<00:39,  5.71s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [10:53<00:39,  5.71s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [10:55<00:27,  4.62s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [10:55<00:27,  4.62s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [10:59<00:21,  4.40s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [10:59<00:21,  4.40s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [11:04<00:18,  4.60s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [11:04<00:18,  4.60s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [11:06<00:11,  3.83s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [11:06<00:11,  3.83s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [11:13<00:09,  4.79s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [11:13<00:09,  4.79s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [11:20<00:05,  5.40s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [11:20<00:05,  5.40s/it]Validation DataLoader 0: 100%|██████████| 94/94 [11:21<00:00,  4.17s/it]Validation DataLoader 0: 100%|██████████| 94/94 [11:21<00:00,  4.17s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.9058092081529581
	steps: 0.40625	0.5104166666666667
	proof: 0.40625	0.40625
28 trees have depth 3
	leaves: 0.5	0.9080401741116028
	steps: 0.17857142857142858	0.37511337868480726
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8773228314894982
	steps: 0.1111111111111111	0.33118486451819784
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.07692307692307693	0.7916732965375499
	steps: 0.0	0.2032282157788231
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5772319184083889
	steps: 0.0	0.14430422518657812
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7240418679549113
	steps: 0.0	0.2332830132830133
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9083655083655083
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9076923076923078
	steps: 0.38461538461538464	0.5153846153846153
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5384615384615384	0.9224664224664226
	steps: 0.3076923076923077	0.44175824175824174
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.24666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.8986363636363637
	steps: 0.0	0.2931746031746032
	proof: 0.0	0.0
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8341428412856985
	steps: 0.07142857142857142	0.2712018140589569
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8961038961038961
	steps: 0.0	0.2077922077922078
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6276353276353276
	steps: 0.0	0.21055578408519585
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7946428571428572
	steps: 0.0	0.13333333333333333
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6333333333333333
	steps: 0.0	0.23604465709728864
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.28571428571428575
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.681917211328976
	steps: 0.0	0.0787037037037037
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9322222222222222
	steps: 0.0	0.3187878787878788
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [11:22<00:00,  7.26s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.9008842387984037
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5250425844507897
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=0.8, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:05<08:23,  5.41s/it]Validation DataLoader 0:   1%|          | 1/94 [00:05<08:23,  5.41s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:07,  4.00s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:07,  4.00s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:06,  3.37s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:06,  3.37s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:13,  3.48s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:13,  3.48s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<07:40,  5.17s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<07:40,  5.17s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:24<05:52,  4.01s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:24<05:52,  4.01s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:30<06:43,  4.63s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:30<06:43,  4.63s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:31<04:58,  3.47s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:31<04:58,  3.47s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:32<03:51,  2.73s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:32<03:51,  2.73s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:42<06:59,  5.00s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:42<06:59,  5.00s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:45<05:53,  4.26s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:45<05:53,  4.26s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:48<05:33,  4.07s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:48<05:33,  4.07s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:55<06:38,  4.92s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:55<06:38,  4.92s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:04<08:08,  6.11s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:04<08:08,  6.11s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:15<09:58,  7.58s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:15<09:58,  7.58s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:42<17:19, 13.33s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:42<17:19, 13.33s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:50<15:05, 11.76s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:50<15:05, 11.76s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:54<12:01,  9.49s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:54<12:01,  9.49s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:57<09:30,  7.61s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:57<09:30,  7.61s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:08<10:30,  8.51s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:08<10:30,  8.51s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:25<13:36, 11.19s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:25<13:36, 11.19s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:32<11:40,  9.73s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:32<11:40,  9.73s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:39<10:35,  8.94s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:39<10:35,  8.94s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:48<10:26,  8.95s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:48<10:26,  8.95s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:54<09:18,  8.10s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:54<09:18,  8.10s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:58<07:49,  6.91s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:58<07:49,  6.91s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:06<07:59,  7.15s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:06<07:59,  7.15s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:10<07:03,  6.42s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:10<07:03,  6.42s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:11<05:09,  4.76s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:11<05:09,  4.76s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:19<05:53,  5.53s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:19<05:53,  5.53s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:24<05:51,  5.57s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:24<05:51,  5.57s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [04:06<16:52, 16.33s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [04:06<16:52, 16.33s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [04:08<12:25, 12.22s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [04:08<12:25, 12.22s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [04:22<12:30, 12.52s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [04:22<12:30, 12.52s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [04:24<09:22,  9.54s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [04:24<09:22,  9.54s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:26<07:00,  7.24s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:26<07:00,  7.24s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:30<05:52,  6.18s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:30<05:52,  6.18s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:59<12:04, 12.94s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:59<12:04, 12.94s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [05:08<10:53, 11.89s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [05:08<10:53, 11.89s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [05:14<09:07, 10.13s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [05:14<09:07, 10.13s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [05:19<07:37,  8.63s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [05:19<07:37,  8.63s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [05:20<05:32,  6.40s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [05:20<05:32,  6.40s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [05:30<06:17,  7.40s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [05:30<06:17,  7.40s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [06:02<12:15, 14.71s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [06:02<12:15, 14.71s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [06:20<12:50, 15.73s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [06:20<12:50, 15.73s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [06:40<13:37, 17.02s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [06:40<13:37, 17.02s/it]Validation DataLoader 0:  50%|█████     | 47/94 [07:09<16:12, 20.69s/it]Validation DataLoader 0:  50%|█████     | 47/94 [07:09<16:12, 20.69s/it]Validation DataLoader 0:  51%|█████     | 48/94 [07:21<13:46, 17.97s/it]Validation DataLoader 0:  51%|█████     | 48/94 [07:21<13:46, 17.97s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [07:26<10:31, 14.04s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [07:26<10:31, 14.04s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [07:39<10:04, 13.73s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [07:39<10:04, 13.73s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [07:47<08:43, 12.17s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [07:47<08:43, 12.17s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [07:56<07:50, 11.20s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [07:56<07:50, 11.20s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [08:03<06:39,  9.74s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [08:03<06:39,  9.74s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [08:07<05:25,  8.13s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [08:07<05:25,  8.13s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [08:11<04:32,  6.98s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [08:11<04:32,  6.98s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [08:17<04:11,  6.63s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [08:17<04:11,  6.63s/it]Validation DataLoader 0:  61%|██████    | 57/94 [08:25<04:16,  6.93s/it]Validation DataLoader 0:  61%|██████    | 57/94 [08:25<04:16,  6.93s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [08:30<03:54,  6.52s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [08:30<03:54,  6.52s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [08:31<02:51,  4.90s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [08:31<02:51,  4.90s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [09:02<07:06, 12.54s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [09:02<07:06, 12.54s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [09:15<06:58, 12.67s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [09:15<06:58, 12.67s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [09:19<05:23, 10.11s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [09:19<05:23, 10.11s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [09:25<04:33,  8.83s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [09:25<04:33,  8.83s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [09:48<06:31, 13.05s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [09:48<06:31, 13.05s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [10:19<08:58, 18.57s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [10:19<08:58, 18.57s/it]Validation DataLoader 0:  70%|███████   | 66/94 [10:23<06:34, 14.10s/it]Validation DataLoader 0:  70%|███████   | 66/94 [10:23<06:34, 14.10s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [10:27<04:58, 11.05s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [10:27<04:58, 11.05s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [10:28<03:29,  8.05s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [10:28<03:29,  8.05s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [10:32<02:51,  6.87s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [10:32<02:51,  6.87s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [10:35<02:17,  5.75s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [10:35<02:17,  5.75s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [10:39<01:59,  5.18s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [10:39<01:59,  5.18s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [10:46<02:05,  5.72s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [10:46<02:05,  5.72s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [10:49<01:42,  4.88s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [10:49<01:42,  4.88s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [10:55<01:46,  5.32s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [10:55<01:46,  5.32s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [10:59<01:34,  4.97s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [10:59<01:34,  4.97s/it]Validation DataLoader 0:  81%|████████  | 76/94 [11:06<01:38,  5.47s/it]Validation DataLoader 0:  81%|████████  | 76/94 [11:06<01:38,  5.47s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [11:07<01:10,  4.16s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [11:07<01:10,  4.16s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [11:09<00:57,  3.59s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [11:09<00:57,  3.59s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [11:10<00:41,  2.79s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [11:10<00:41,  2.79s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [11:15<00:46,  3.35s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [11:15<00:46,  3.35s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [11:19<00:46,  3.61s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [11:19<00:46,  3.61s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [11:33<01:21,  6.81s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [11:33<01:21,  6.81s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [11:37<01:05,  5.95s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [11:37<01:05,  5.95s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [11:39<00:48,  4.84s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [11:39<00:48,  4.84s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [11:42<00:37,  4.17s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [11:42<00:37,  4.17s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [11:50<00:41,  5.22s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [11:50<00:41,  5.22s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [12:01<00:49,  7.13s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [12:01<00:49,  7.13s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [12:02<00:32,  5.36s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [12:02<00:32,  5.36s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [12:07<00:25,  5.16s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [12:07<00:25,  5.16s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [12:09<00:16,  4.17s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [12:09<00:16,  4.17s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [12:12<00:11,  3.80s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [12:12<00:11,  3.80s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [12:16<00:07,  3.77s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [12:16<00:07,  3.77s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [12:22<00:04,  4.64s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [12:22<00:04,  4.64s/it]Validation DataLoader 0: 100%|██████████| 94/94 [12:23<00:00,  3.46s/it]Validation DataLoader 0: 100%|██████████| 94/94 [12:23<00:00,  3.46s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9895424836601308
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9057753878066379
	steps: 0.390625	0.4942708333333333
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.42857142857142855	0.8924969871398444
	steps: 0.17857142857142858	0.3586734693877551
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8813632355299023
	steps: 0.1111111111111111	0.32289562289562285
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.0	0.8135526866296098
	steps: 0.0	0.27784819768625435
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6914607948442535
	steps: 0.0	0.15854700854700857
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7427128427128427
	steps: 0.0	0.14029518240044556
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.8999414999415
	steps: 0.4864864864864865	0.553153153153153
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.8994505494505495
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5384615384615384	0.9114163614163615
	steps: 0.3076923076923077	0.4525641025641025
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9595959595959596
	steps: 0.0	0.31333333333333335
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.9025324675324675
	steps: 0.0	0.2404761904761905
	proof: 0.0	0.0
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.41071428571428575
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8631471702900274
	steps: 0.07142857142857142	0.29036796536796533
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8741258741258742
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7333333333333334
	steps: 0.0	0.07692307692307691
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.7313492063492063
	steps: 0.0	0.17053317053317055
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8
	steps: 0.0	0.17692307692307693
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.8025619604566973
	steps: 0.0	0.3205128205128205
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.9333333333333333
	steps: 0.0	0.5
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7603785103785103
	steps: 0.0	0.07953216374269007
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9060606060606061
	steps: 0.0	0.2100250626566416
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.6125
	steps: 0.0	0.1111111111111111
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [12:23<00:00,  7.91s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5668449197860963
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.9046172883000917
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5189943230613087
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=0.8, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:09,  4.62s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:09,  4.62s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:22,  4.16s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:22,  4.16s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:51,  3.87s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<05:51,  3.87s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:04,  3.39s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:04,  3.39s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<07:16,  4.91s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<07:16,  4.91s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:24<05:45,  3.93s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:24<05:45,  3.93s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:28<05:36,  3.87s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:28<05:36,  3.87s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:29<04:19,  3.01s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:29<04:19,  3.01s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:30<03:28,  2.45s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:30<03:28,  2.45s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:40<06:51,  4.90s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:40<06:51,  4.90s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:44<06:04,  4.39s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:44<06:04,  4.39s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:48<06:14,  4.57s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:48<06:14,  4.57s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:54<06:37,  4.91s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:54<06:37,  4.91s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:05<08:51,  6.64s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:05<08:51,  6.64s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:12<09:05,  6.91s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:12<09:05,  6.91s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:23<10:32,  8.11s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:23<10:32,  8.11s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:36<12:17,  9.57s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:36<12:17,  9.57s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:42<10:36,  8.37s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:42<10:36,  8.37s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:46<08:50,  7.08s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:46<08:50,  7.08s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:57<10:09,  8.24s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:57<10:09,  8.24s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:11<12:05,  9.93s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:11<12:05,  9.93s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:24<12:57, 10.79s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:24<12:57, 10.79s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:36<13:29, 11.41s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:36<13:29, 11.41s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:45<12:12, 10.47s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:45<12:12, 10.47s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:51<10:41,  9.29s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:51<10:41,  9.29s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:56<08:56,  7.89s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:56<08:56,  7.89s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:07<09:52,  8.84s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:07<09:52,  8.84s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:13<08:42,  7.91s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:13<08:42,  7.91s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:14<06:20,  5.85s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:14<06:20,  5.85s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:21<06:44,  6.33s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:21<06:44,  6.33s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:28<06:45,  6.43s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:28<06:45,  6.43s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:41<08:51,  8.57s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:41<08:51,  8.57s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:45<07:19,  7.21s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:45<07:19,  7.21s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [04:05<11:00, 11.01s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [04:05<11:00, 11.01s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [04:09<08:36,  8.76s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [04:09<08:36,  8.76s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:17<08:13,  8.50s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:17<08:13,  8.50s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:21<06:58,  7.33s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:21<06:58,  7.33s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:30<07:19,  7.84s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:30<07:19,  7.84s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:44<08:40,  9.47s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:44<08:40,  9.47s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:49<07:25,  8.25s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:49<07:25,  8.25s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:55<06:43,  7.62s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:55<06:43,  7.62s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:57<05:00,  5.77s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:57<05:00,  5.77s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [05:17<08:32, 10.04s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [05:17<08:32, 10.04s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:59<16:21, 19.63s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:59<16:21, 19.63s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [06:20<16:29, 20.20s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [06:20<16:29, 20.20s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [06:31<13:55, 17.41s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [06:31<13:55, 17.41s/it]Validation DataLoader 0:  50%|█████     | 47/94 [06:41<11:54, 15.21s/it]Validation DataLoader 0:  50%|█████     | 47/94 [06:41<11:54, 15.21s/it]Validation DataLoader 0:  51%|█████     | 48/94 [06:52<10:38, 13.89s/it]Validation DataLoader 0:  51%|█████     | 48/94 [06:52<10:38, 13.89s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [06:58<08:40, 11.57s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [06:58<08:40, 11.57s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [07:14<09:27, 12.90s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [07:14<09:27, 12.90s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [07:36<11:11, 15.62s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [07:36<11:11, 15.62s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [07:46<09:49, 14.04s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [07:46<09:49, 14.04s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [07:51<07:37, 11.17s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [07:51<07:37, 11.17s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [07:55<05:57,  8.95s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [07:55<05:57,  8.95s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [08:01<05:23,  8.29s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [08:01<05:23,  8.29s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [08:08<04:59,  7.89s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [08:08<04:59,  7.89s/it]Validation DataLoader 0:  61%|██████    | 57/94 [08:15<04:41,  7.62s/it]Validation DataLoader 0:  61%|██████    | 57/94 [08:15<04:41,  7.62s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [08:21<04:09,  6.92s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [08:21<04:09,  6.92s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [08:22<03:02,  5.23s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [08:22<03:02,  5.23s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [09:00<08:35, 15.16s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [09:00<08:35, 15.16s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [09:13<07:52, 14.33s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [09:13<07:52, 14.33s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [09:18<06:11, 11.60s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [09:18<06:11, 11.60s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [09:23<05:03,  9.79s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [09:23<05:03,  9.79s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [09:42<06:17, 12.57s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [09:42<06:17, 12.57s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [10:19<09:34, 19.83s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [10:19<09:34, 19.83s/it]Validation DataLoader 0:  70%|███████   | 66/94 [10:24<07:09, 15.35s/it]Validation DataLoader 0:  70%|███████   | 66/94 [10:24<07:09, 15.35s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [10:28<05:21, 11.89s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [10:28<05:21, 11.89s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [10:29<03:46,  8.72s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [10:29<03:46,  8.72s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [10:36<03:23,  8.12s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [10:36<03:23,  8.12s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [10:39<02:41,  6.71s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [10:39<02:41,  6.71s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [10:42<02:03,  5.39s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [10:42<02:03,  5.39s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [10:48<02:06,  5.76s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [10:48<02:06,  5.76s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [10:53<01:51,  5.31s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [10:53<01:51,  5.31s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [10:57<01:40,  5.01s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [10:57<01:40,  5.01s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [11:03<01:40,  5.27s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [11:03<01:40,  5.27s/it]Validation DataLoader 0:  81%|████████  | 76/94 [11:10<01:44,  5.82s/it]Validation DataLoader 0:  81%|████████  | 76/94 [11:10<01:44,  5.82s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [11:11<01:15,  4.44s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [11:11<01:15,  4.44s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [11:14<01:01,  3.84s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [11:14<01:01,  3.84s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [11:15<00:46,  3.13s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [11:15<00:46,  3.13s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [11:24<01:06,  4.76s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [11:24<01:06,  4.76s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [11:32<01:14,  5.72s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [11:32<01:14,  5.72s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [11:37<01:09,  5.76s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [11:37<01:09,  5.76s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [11:41<00:57,  5.22s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [11:41<00:57,  5.22s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [11:44<00:44,  4.45s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [11:44<00:44,  4.45s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [11:46<00:34,  3.86s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [11:46<00:34,  3.86s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [11:54<00:40,  5.08s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [11:54<00:40,  5.08s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [12:09<00:56,  8.06s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [12:09<00:56,  8.06s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [12:11<00:37,  6.23s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [12:11<00:37,  6.23s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [12:16<00:28,  5.72s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [12:16<00:28,  5.72s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [12:18<00:19,  4.76s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [12:18<00:19,  4.76s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [12:22<00:12,  4.28s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [12:22<00:12,  4.28s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [12:35<00:14,  7.06s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [12:35<00:14,  7.06s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [12:41<00:06,  6.79s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [12:41<00:06,  6.79s/it]Validation DataLoader 0: 100%|██████████| 94/94 [12:42<00:00,  5.08s/it]Validation DataLoader 0: 100%|██████████| 94/94 [12:42<00:00,  5.08s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9893557422969187
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5625	0.9032999986124985
	steps: 0.375	0.4649553571428572
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.4642857142857143	0.899905253476682
	steps: 0.17857142857142858	0.3938775510204082
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8564242855909523
	steps: 0.2222222222222222	0.4056998556998557
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.07692307692307693	0.8008925701590622
	steps: 0.0	0.2218922103537488
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6945178071228492
	steps: 0.0	0.1838145514616103
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6755749124170176
	steps: 0.0	0.11725277067348679
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8945360945360947
	steps: 0.43243243243243246	0.49729729729729727
	proof: 0.43243243243243246	0.43243243243243246
13 trees have size 6
	leaves: 0.5384615384615384	0.9028317836010143
	steps: 0.38461538461538464	0.4846153846153846
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.5769230769230769	0.9300976800976801
	steps: 0.3076923076923077	0.45860805860805864
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.8961038961038963
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9095454545454545
	steps: 0.1	0.3884920634920635
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8056249306249307
	steps: 0.14285714285714285	0.30532879818594105
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8901515151515151
	steps: 0.0	0.22727272727272724
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.775
	steps: 0.0	0.30769230769230765
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6672466422466421
	steps: 0.0	0.16554741554741556
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8705882352941177
	steps: 0.0	0.24358974358974358
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.8055555555555555
	steps: 0.0	0.21176470588235294
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.3636363636363636
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.8116218147177899
	steps: 0.0	0.0784313725490196
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8391433128275234
	steps: 0.0	0.11870255348516218
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.12916666666666665
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [12:42<00:00,  8.12s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.8995080456831918
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5185194059207626
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=0.8, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:07,  4.59s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:07,  4.59s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:15,  4.09s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:15,  4.09s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:14<07:38,  5.04s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:14<07:38,  5.04s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:17<06:12,  4.13s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:17<06:12,  4.13s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<06:44,  4.54s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<06:44,  4.54s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:26<06:08,  4.19s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:26<06:08,  4.19s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:28<05:18,  3.66s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:28<05:18,  3.66s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:30<04:28,  3.12s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:30<04:28,  3.12s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:32<03:55,  2.77s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:32<03:55,  2.77s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:46<08:50,  6.32s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:46<08:50,  6.32s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:49<07:19,  5.29s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:49<07:19,  5.29s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:52<06:20,  4.64s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:52<06:20,  4.64s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:03<08:37,  6.39s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:03<08:37,  6.39s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:10<08:50,  6.63s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:10<08:50,  6.63s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:16<08:29,  6.45s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:16<08:29,  6.45s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:29<11:06,  8.54s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:29<11:06,  8.54s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:35<09:49,  7.66s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:35<09:49,  7.66s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:40<08:45,  6.91s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:40<08:45,  6.91s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:43<07:06,  5.69s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:43<07:06,  5.69s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:51<07:50,  6.35s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:51<07:50,  6.35s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:01<08:54,  7.33s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:01<08:54,  7.33s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:08<08:51,  7.38s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:08<08:51,  7.38s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:15<08:24,  7.11s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:15<08:24,  7.11s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:26<09:47,  8.40s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:26<09:47,  8.40s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:30<08:07,  7.07s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:30<08:07,  7.07s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:33<06:46,  5.98s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:33<06:46,  5.98s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:45<08:33,  7.66s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:45<08:33,  7.66s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:50<07:28,  6.79s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:50<07:28,  6.79s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:51<05:34,  5.15s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:51<05:34,  5.15s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:56<05:35,  5.24s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:56<05:35,  5.24s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:00<05:05,  4.84s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:00<05:05,  4.84s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:05<04:51,  4.70s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:05<04:51,  4.70s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:08<04:18,  4.23s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:08<04:18,  4.23s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:15<05:02,  5.04s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:15<05:02,  5.04s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:18<04:20,  4.41s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:18<04:20,  4.41s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:20<03:40,  3.80s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:20<03:40,  3.80s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:25<04:00,  4.22s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:25<04:00,  4.22s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:34<05:17,  5.67s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:34<05:17,  5.67s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:42<05:47,  6.32s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:42<05:47,  6.32s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:46<05:04,  5.63s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:46<05:04,  5.63s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:53<05:16,  5.98s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:53<05:16,  5.98s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:55<04:04,  4.70s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:55<04:04,  4.70s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:04<05:15,  6.18s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:04<05:15,  6.18s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:20<07:26,  8.93s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:20<07:26,  8.93s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:37<09:13, 11.30s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:37<09:13, 11.30s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:46<08:37, 10.77s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:46<08:37, 10.77s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:55<07:59, 10.21s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:55<07:59, 10.21s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:05<07:46, 10.13s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:05<07:46, 10.13s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:09<06:15,  8.34s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:09<06:15,  8.34s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:17<05:57,  8.12s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:17<05:57,  8.12s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:32<07:15, 10.14s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:32<07:15, 10.14s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:37<06:08,  8.77s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:37<06:08,  8.77s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:43<05:19,  7.78s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:43<05:19,  7.78s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:47<04:25,  6.64s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:47<04:25,  6.64s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:53<04:15,  6.56s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:53<04:15,  6.56s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:57<03:41,  5.82s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:57<03:41,  5.82s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:02<03:24,  5.52s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:02<03:24,  5.52s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:09<03:34,  5.95s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:09<03:34,  5.95s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:11<02:48,  4.80s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:11<02:48,  4.80s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:33<05:37,  9.92s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:33<05:37,  9.92s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:42<05:15,  9.56s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:42<05:15,  9.56s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:47<04:23,  8.22s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:47<04:23,  8.22s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:50<03:33,  6.89s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:50<03:33,  6.89s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:08<05:01, 10.04s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:08<05:01, 10.04s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:30<06:36, 13.66s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:30<06:36, 13.66s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:35<05:12, 11.17s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:35<05:12, 11.17s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:39<04:01,  8.95s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:39<04:01,  8.95s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:41<02:56,  6.79s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:41<02:56,  6.79s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:44<02:22,  5.70s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:44<02:22,  5.70s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:48<02:02,  5.12s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:48<02:02,  5.12s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:51<01:41,  4.43s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:51<01:41,  4.43s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:54<01:32,  4.18s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:54<01:32,  4.18s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:58<01:24,  4.03s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:58<01:24,  4.03s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:04<01:32,  4.63s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:04<01:32,  4.63s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:09<01:28,  4.66s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:09<01:28,  4.66s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:13<01:24,  4.70s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:13<01:24,  4.70s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:15<01:04,  3.79s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:15<01:04,  3.79s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:19<01:01,  3.87s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:19<01:01,  3.87s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:21<00:50,  3.35s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:21<00:50,  3.35s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:27<00:56,  4.05s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:27<00:56,  4.05s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:30<00:50,  3.86s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:30<00:50,  3.86s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:37<00:58,  4.85s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:37<00:58,  4.85s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:42<00:50,  4.60s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:42<00:50,  4.60s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:45<00:43,  4.37s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:45<00:43,  4.37s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:48<00:34,  3.86s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:48<00:34,  3.86s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:52<00:31,  3.95s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:52<00:31,  3.95s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:58<00:31,  4.45s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:58<00:31,  4.45s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:00<00:22,  3.70s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:00<00:22,  3.70s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:03<00:18,  3.60s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:03<00:18,  3.60s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:05<00:12,  3.10s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:05<00:12,  3.10s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:08<00:09,  3.05s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:08<00:09,  3.05s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:11<00:05,  2.90s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:11<00:05,  2.90s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:17<00:03,  3.85s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:17<00:03,  3.85s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:18<00:00,  3.13s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:18<00:00,  3.13s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9893557422969187
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.9069782647907649
	steps: 0.390625	0.49747023809523816
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5	0.9034265337836767
	steps: 0.17857142857142858	0.36709183673469387
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8864979156645824
	steps: 0.16666666666666666	0.3515552348885682
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7815754995976477
	steps: 0.0	0.22147535722196357
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5823918771287193
	steps: 0.0	0.162161368043721
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7263480607874201
	steps: 0.0	0.22161634661634663
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9050895050895051
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8967032967032966
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5384615384615384	0.9253052503052503
	steps: 0.3076923076923077	0.44047619047619047
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.8936363636363638
	steps: 0.1	0.3392857142857143
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8429840001268573
	steps: 0.07142857142857142	0.2497732426303855
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9226190476190477
	steps: 0.0	0.21328671328671328
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.23076923076923073
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.636650922177238
	steps: 0.0	0.2065875301169419
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25874125874125875
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6140350877192983
	steps: 0.0	0.2174688057040998
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.4615384615384615
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6535530746057062
	steps: 0.0	0.12037037037037036
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9465811965811964
	steps: 0.0	0.2954545454545454
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:18<00:00,  5.94s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5668449197860963
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.9002779156740761
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5229340545163131
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=7.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:05<08:32,  5.51s/it]Validation DataLoader 0:   1%|          | 1/94 [00:05<08:32,  5.51s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:09<07:05,  4.62s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:09<07:05,  4.62s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:14<07:11,  4.75s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:14<07:11,  4.75s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:18<06:42,  4.48s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:18<06:42,  4.48s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:24<07:37,  5.15s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:24<07:37,  5.15s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:27<06:29,  4.43s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:27<06:29,  4.43s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:32<06:29,  4.48s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:32<06:29,  4.48s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:36<06:22,  4.44s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:36<06:22,  4.44s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:39<05:20,  3.77s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:39<05:20,  3.77s/it]Validation DataLoader 0:  11%|█         | 10/94 [01:04<14:48, 10.57s/it]Validation DataLoader 0:  11%|█         | 10/94 [01:04<14:48, 10.57s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [01:07<11:22,  8.23s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [01:07<11:22,  8.23s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [01:11<09:27,  6.92s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [01:11<09:27,  6.92s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:19<09:37,  7.13s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:19<09:37,  7.13s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:25<09:15,  6.94s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:25<09:15,  6.94s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:33<09:22,  7.11s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:33<09:22,  7.11s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:41<09:46,  7.52s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:41<09:46,  7.52s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:52<10:45,  8.38s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:52<10:45,  8.38s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:57<09:30,  7.50s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:57<09:30,  7.50s/it]Validation DataLoader 0:  20%|██        | 19/94 [02:00<07:49,  6.25s/it]Validation DataLoader 0:  20%|██        | 19/94 [02:00<07:49,  6.25s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:08<08:16,  6.71s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:08<08:16,  6.71s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:18<09:17,  7.64s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:18<09:17,  7.64s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:25<08:55,  7.44s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:25<08:55,  7.44s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:34<09:21,  7.91s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:34<09:21,  7.91s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:38<07:54,  6.78s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:38<07:54,  6.78s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:44<07:30,  6.53s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:44<07:30,  6.53s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:48<06:38,  5.85s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:48<06:38,  5.85s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:00<08:27,  7.58s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:00<08:27,  7.58s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:05<07:27,  6.78s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:05<07:27,  6.78s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:07<05:45,  5.32s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:07<05:45,  5.32s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:14<06:17,  5.90s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:14<06:17,  5.90s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:21<06:32,  6.24s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:21<06:32,  6.24s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:27<06:16,  6.07s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:27<06:16,  6.07s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:31<05:27,  5.36s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:31<05:27,  5.36s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:38<06:01,  6.03s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:38<06:01,  6.03s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:41<05:04,  5.17s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:41<05:04,  5.17s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:46<04:45,  4.93s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:46<04:45,  4.93s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:51<04:53,  5.15s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:51<04:53,  5.15s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:59<05:24,  5.80s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:59<05:24,  5.80s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:11<07:15,  7.92s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:11<07:15,  7.92s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:16<06:17,  6.99s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:16<06:17,  6.99s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:21<05:39,  6.40s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:21<05:39,  6.40s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:23<04:24,  5.08s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:23<04:24,  5.08s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:31<05:02,  5.93s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:31<05:02,  5.93s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:43<06:16,  7.54s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:43<06:16,  7.54s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:53<06:48,  8.34s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:53<06:48,  8.34s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:08<08:26, 10.55s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:08<08:26, 10.55s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:23<09:16, 11.84s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:23<09:16, 11.84s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:32<08:22, 10.92s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:32<08:22, 10.92s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:36<06:33,  8.75s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:36<06:33,  8.75s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:41<05:33,  7.58s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:41<05:33,  7.58s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:59<07:39, 10.68s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:59<07:39, 10.68s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:07<06:59,  9.99s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:07<06:59,  9.99s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:14<06:18,  9.23s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:14<06:18,  9.23s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:17<04:48,  7.21s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:17<04:48,  7.21s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:26<04:58,  7.65s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:26<04:58,  7.65s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:30<04:12,  6.65s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:30<04:12,  6.65s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:35<03:48,  6.19s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:35<03:48,  6.19s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:40<03:32,  5.89s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:40<03:32,  5.89s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:42<02:46,  4.75s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:42<02:46,  4.75s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:04<05:34,  9.85s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:04<05:34,  9.85s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:12<05:02,  9.18s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:12<05:02,  9.18s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:16<04:05,  7.68s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:16<04:05,  7.68s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:22<03:40,  7.11s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:22<03:40,  7.11s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:39<05:07, 10.24s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:39<05:07, 10.24s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:58<06:13, 12.86s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:58<06:13, 12.86s/it]Validation DataLoader 0:  70%|███████   | 66/94 [08:02<04:40, 10.04s/it]Validation DataLoader 0:  70%|███████   | 66/94 [08:02<04:40, 10.04s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:05<03:40,  8.16s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:05<03:40,  8.16s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:08<02:46,  6.41s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:08<02:46,  6.41s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:13<02:29,  5.98s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:13<02:29,  5.98s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:16<02:03,  5.15s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:16<02:03,  5.15s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:19<01:48,  4.70s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:19<01:48,  4.70s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:24<01:39,  4.54s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:24<01:39,  4.54s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:27<01:27,  4.19s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:27<01:27,  4.19s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:34<01:38,  4.93s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:34<01:38,  4.93s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:38<01:27,  4.62s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:38<01:27,  4.62s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:42<01:23,  4.67s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:42<01:23,  4.67s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:44<01:01,  3.63s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:44<01:01,  3.63s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:47<00:57,  3.58s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:47<00:57,  3.58s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:49<00:46,  3.12s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:49<00:46,  3.12s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:55<00:54,  3.88s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:55<00:54,  3.88s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:59<00:50,  3.89s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:59<00:50,  3.89s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [09:04<00:50,  4.23s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [09:04<00:50,  4.23s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [09:07<00:44,  4.04s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [09:07<00:44,  4.04s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:11<00:38,  3.81s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:11<00:38,  3.81s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:13<00:30,  3.43s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:13<00:30,  3.43s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:18<00:30,  3.85s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:18<00:30,  3.85s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [09:22<00:28,  4.04s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [09:22<00:28,  4.04s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:24<00:19,  3.31s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:24<00:19,  3.31s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:27<00:16,  3.25s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:27<00:16,  3.25s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:29<00:11,  2.89s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:29<00:11,  2.89s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:32<00:08,  2.73s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:32<00:08,  2.73s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:35<00:05,  2.95s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:35<00:05,  2.95s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:40<00:03,  3.57s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:40<00:03,  3.57s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:41<00:00,  2.92s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:41<00:00,  2.92s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9843137254901961
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.5	0.8979527417027416
	steps: 0.375	0.4818824404761905
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.5	0.8653247546104689
	steps: 0.17857142857142858	0.37312925170068023
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.8692420234086902
	steps: 0.16666666666666666	0.3473665223665223
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.7610432553871469
	steps: 0.0	0.23491791609200513
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5964839782066672
	steps: 0.0	0.1495567924139353
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6857872519637226
	steps: 0.0	0.10451659451659452
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9804878048780489
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8985842985842986
	steps: 0.4594594594594595	0.5288288288288289
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5384615384615384	0.8775335775335775
	steps: 0.3076923076923077	0.45347985347985353
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9414141414141414
	steps: 0.0	0.2633333333333333
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9034848484848486
	steps: 0.1	0.3392857142857143
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8130139701568273
	steps: 0.07142857142857142	0.23826530612244898
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8833333333333334
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7904411764705883
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6820818070818072
	steps: 0.0	0.1937136937136937
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8705882352941177
	steps: 0.0	0.23076923076923075
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.5669180492709903
	steps: 0.0	0.13095238095238096
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7142857142857143
	steps: 0.0	0.30769230769230765
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6821805645335056
	steps: 0.0	0.09206349206349207
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8759018759018758
	steps: 0.0	0.13381180223285485
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.4375
	steps: 0.0	0.07142857142857144
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.7692307692307692
	steps: 0.0	0.16
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:41<00:00,  6.19s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5454545454545454
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8862465171052778
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5148054687908332
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=7.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:09<14:14,  9.19s/it]Validation DataLoader 0:   1%|          | 1/94 [00:09<14:14,  9.19s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:13<09:20,  6.09s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:13<09:20,  6.09s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:18<08:33,  5.64s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:18<08:33,  5.64s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:21<07:08,  4.76s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:21<07:08,  4.76s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:28<08:25,  5.68s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:28<08:25,  5.68s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:32<07:31,  5.13s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:32<07:31,  5.13s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:36<06:52,  4.74s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:36<06:52,  4.74s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:39<05:41,  3.97s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:39<05:41,  3.97s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:42<05:07,  3.61s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:42<05:07,  3.61s/it]Validation DataLoader 0:  11%|█         | 10/94 [01:00<11:36,  8.29s/it]Validation DataLoader 0:  11%|█         | 10/94 [01:00<11:36,  8.29s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [01:04<09:26,  6.83s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [01:04<09:26,  6.83s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [01:08<08:03,  5.89s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [01:08<08:03,  5.89s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:15<08:36,  6.38s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:15<08:36,  6.38s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:21<08:06,  6.08s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:21<08:06,  6.08s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:27<08:09,  6.20s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:27<08:09,  6.20s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:39<10:13,  7.87s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:39<10:13,  7.87s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:47<10:08,  7.90s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:47<10:08,  7.90s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:53<09:30,  7.51s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:53<09:30,  7.51s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:57<07:54,  6.33s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:57<07:54,  6.33s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:09<09:49,  7.97s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:09<09:49,  7.97s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:22<11:42,  9.62s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:22<11:42,  9.62s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:31<11:09,  9.30s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:31<11:09,  9.30s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:43<12:00, 10.15s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:43<12:00, 10.15s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:49<10:19,  8.85s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:49<10:19,  8.85s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:54<08:58,  7.81s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:54<08:58,  7.81s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:58<07:39,  6.76s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:58<07:39,  6.76s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:07<08:11,  7.33s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [03:07<08:11,  7.33s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:14<07:51,  7.15s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [03:14<07:51,  7.15s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:16<06:00,  5.54s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:16<06:00,  5.54s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:22<06:14,  5.85s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:22<06:14,  5.85s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:28<06:09,  5.87s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:28<06:09,  5.87s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:37<06:54,  6.68s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:37<06:54,  6.68s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:40<05:49,  5.72s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:40<05:49,  5.72s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:53<07:58,  7.97s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:53<07:58,  7.97s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:56<06:20,  6.45s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:56<06:20,  6.45s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:01<05:53,  6.09s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:01<05:53,  6.09s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:06<05:23,  5.67s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:06<05:23,  5.67s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:11<05:10,  5.55s/it]Validation DataLoader 0:  40%|████      | 38/94 [04:11<05:10,  5.55s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:20<06:01,  6.57s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:20<06:01,  6.57s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:29<06:33,  7.28s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:29<06:33,  7.28s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:45<08:47,  9.95s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:45<08:47,  9.95s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:48<06:43,  7.76s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:48<06:43,  7.76s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:56<06:43,  7.91s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:56<06:43,  7.91s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:18<09:55, 11.91s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:18<09:55, 11.91s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:31<10:08, 12.42s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:31<10:08, 12.42s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:43<09:49, 12.29s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:43<09:49, 12.29s/it]Validation DataLoader 0:  50%|█████     | 47/94 [06:02<11:07, 14.20s/it]Validation DataLoader 0:  50%|█████     | 47/94 [06:02<11:07, 14.20s/it]Validation DataLoader 0:  51%|█████     | 48/94 [06:12<10:03, 13.12s/it]Validation DataLoader 0:  51%|█████     | 48/94 [06:12<10:03, 13.12s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [06:18<08:03, 10.75s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [06:18<08:03, 10.75s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [06:32<08:43, 11.91s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [06:32<08:43, 11.91s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:46<08:50, 12.34s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:46<08:50, 12.34s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:52<07:21, 10.52s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:52<07:21, 10.52s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:59<06:25,  9.41s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:59<06:25,  9.41s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [07:03<05:18,  7.97s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [07:03<05:18,  7.97s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [07:10<04:55,  7.56s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [07:10<04:55,  7.56s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [07:16<04:25,  6.98s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [07:16<04:25,  6.98s/it]Validation DataLoader 0:  61%|██████    | 57/94 [07:31<05:50,  9.48s/it]Validation DataLoader 0:  61%|██████    | 57/94 [07:31<05:50,  9.48s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [07:38<05:12,  8.68s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [07:38<05:12,  8.68s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [07:40<03:58,  6.80s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [07:40<03:58,  6.80s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [08:13<08:22, 14.77s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [08:13<08:22, 14.77s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [08:20<06:46, 12.31s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [08:20<06:46, 12.31s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [08:26<05:35, 10.48s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [08:26<05:35, 10.48s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [08:32<04:41,  9.08s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [08:32<04:41,  9.08s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [08:43<04:47,  9.58s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [08:43<04:47,  9.58s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [09:09<07:06, 14.70s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [09:09<07:06, 14.70s/it]Validation DataLoader 0:  70%|███████   | 66/94 [09:14<05:28, 11.74s/it]Validation DataLoader 0:  70%|███████   | 66/94 [09:14<05:28, 11.74s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [09:20<04:25,  9.83s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [09:20<04:25,  9.83s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [09:22<03:17,  7.61s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [09:22<03:17,  7.61s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [09:26<02:45,  6.60s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [09:26<02:45,  6.60s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [09:31<02:22,  5.94s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [09:31<02:22,  5.94s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [09:33<01:52,  4.89s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [09:33<01:52,  4.89s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [09:38<01:50,  5.01s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [09:38<01:50,  5.01s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [09:42<01:38,  4.67s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [09:42<01:38,  4.67s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [09:46<01:30,  4.51s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [09:46<01:30,  4.51s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [09:51<01:25,  4.49s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [09:51<01:25,  4.49s/it]Validation DataLoader 0:  81%|████████  | 76/94 [09:58<01:33,  5.22s/it]Validation DataLoader 0:  81%|████████  | 76/94 [09:58<01:33,  5.22s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [10:00<01:14,  4.39s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [10:00<01:14,  4.39s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [10:03<01:02,  3.91s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [10:03<01:02,  3.91s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [10:06<00:52,  3.53s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [10:06<00:52,  3.53s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [10:11<00:54,  3.92s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [10:11<00:54,  3.92s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [10:15<00:53,  4.15s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [10:15<00:53,  4.15s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [10:20<00:50,  4.25s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [10:20<00:50,  4.25s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [10:24<00:47,  4.34s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [10:24<00:47,  4.34s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [10:27<00:38,  3.87s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [10:27<00:38,  3.87s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [10:30<00:33,  3.73s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [10:30<00:33,  3.73s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [10:38<00:38,  4.80s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [10:38<00:38,  4.80s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [10:45<00:38,  5.54s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [10:45<00:38,  5.54s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [10:47<00:26,  4.46s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [10:47<00:26,  4.46s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [10:51<00:22,  4.47s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [10:51<00:22,  4.47s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [10:54<00:15,  3.99s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [10:54<00:15,  3.99s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [10:58<00:11,  3.82s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [10:58<00:11,  3.82s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [11:01<00:07,  3.72s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [11:01<00:07,  3.72s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [11:08<00:04,  4.66s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [11:08<00:04,  4.66s/it]Validation DataLoader 0: 100%|██████████| 94/94 [11:10<00:00,  3.74s/it]Validation DataLoader 0: 100%|██████████| 94/94 [11:10<00:00,  3.74s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56157666/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8823529411764706	0.8823529411764706
	proof: 0.8823529411764706	0.8823529411764706
64 trees have depth 2
	leaves: 0.515625	0.8975401334776335
	steps: 0.359375	0.4576264880952381
	proof: 0.359375	0.359375
28 trees have depth 3
	leaves: 0.4642857142857143	0.9049351442208585
	steps: 0.17857142857142858	0.37063492063492065
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8666806958473625
	steps: 0.16666666666666666	0.37205788039121374
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7744368376721318
	steps: 0.0	0.1962494770187078
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6529850266692373
	steps: 0.0	0.15220041396511985
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7782558021688456
	steps: 0.0	0.15571895424836601
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.6	0.6
	proof: 0.6	0.6
37 trees have size 5
	leaves: 0.5405405405405406	0.8945360945360947
	steps: 0.43243243243243246	0.5018018018018018
	proof: 0.43243243243243246	0.43243243243243246
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6153846153846154	0.9355921855921855
	steps: 0.3076923076923077	0.4476190476190475
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.8779220779220779
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8984343434343434
	steps: 0.1	0.3956349206349207
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8071234321234321
	steps: 0.07142857142857142	0.2200113378684807
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8961038961038961
	steps: 0.0	0.21328671328671328
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7809523809523811
	steps: 0.0	0.18803418803418803
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6541947818263608
	steps: 0.0	0.15169090169090169
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.26515151515151514
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7445533769063181
	steps: 0.0	0.16732026143790849
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.8571428571428571
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7722222222222221
	steps: 0.0	0.08366013071895424
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.6666666666666666	0.9393939393939394
	steps: 0.0	0.23571428571428568
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.6761363636363636
	steps: 0.0	0.05
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [11:10<00:00,  7.13s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5614973262032086
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8984648316537437
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5129084207882573
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=7.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
