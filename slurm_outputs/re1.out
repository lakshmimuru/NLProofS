187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:51,  3.78s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:51,  3.78s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:14,  3.42s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:14,  3.42s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:16,  4.13s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:16,  4.13s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:52,  3.25s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:52,  3.25s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:18,  3.58s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:18,  3.58s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:42,  3.21s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:42,  3.21s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:18,  2.97s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:18,  2.97s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:36,  2.52s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:36,  2.52s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:13,  2.28s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:13,  2.28s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:59,  5.71s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<07:59,  5.71s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:26,  4.66s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:41<06:26,  4.66s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:27,  3.99s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:27,  3.99s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:51<06:32,  4.85s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:51<06:32,  4.85s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:59<08:00,  6.00s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:59<08:00,  6.00s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:04<07:12,  5.48s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:04<07:12,  5.48s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:17<10:20,  7.95s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:17<10:20,  7.95s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:22<08:54,  6.95s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:22<08:54,  6.95s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:26<07:48,  6.16s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:26<07:48,  6.16s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:29<06:21,  5.08s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:29<06:21,  5.08s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:34<06:24,  5.19s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:34<06:24,  5.19s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:45<08:20,  6.85s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:45<08:20,  6.85s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:53<08:32,  7.12s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:53<08:32,  7.12s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:58<07:40,  6.48s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:58<07:40,  6.48s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:05<07:53,  6.76s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:05<07:53,  6.76s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:08<06:29,  5.65s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:08<06:29,  5.65s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:11<05:26,  4.80s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:11<05:26,  4.80s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:17<05:45,  5.16s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:17<05:45,  5.16s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:21<05:09,  4.70s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:21<05:09,  4.70s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:22<03:57,  3.66s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:22<03:57,  3.66s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:27<04:20,  4.07s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:27<04:20,  4.07s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:31<04:09,  3.96s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:31<04:09,  3.96s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:34<04:01,  3.90s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:34<04:01,  3.90s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:37<03:35,  3.53s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:37<03:35,  3.53s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:43<04:21,  4.37s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:43<04:21,  4.37s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:45<03:36,  3.66s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:45<03:36,  3.66s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:47<03:00,  3.10s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:47<03:00,  3.10s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:51<03:07,  3.30s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:51<03:07,  3.30s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:55<03:20,  3.59s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:55<03:20,  3.59s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:02<04:05,  4.47s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:02<04:05,  4.47s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:05<03:38,  4.05s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:05<03:38,  4.05s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:10<04:00,  4.54s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:10<04:00,  4.54s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:11<03:01,  3.48s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:11<03:01,  3.48s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:17<03:24,  4.00s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:17<03:24,  4.00s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:33<06:23,  7.68s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:33<06:23,  7.68s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:43<06:55,  8.47s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:43<06:55,  8.47s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:54<07:21,  9.19s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:54<07:21,  9.19s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:02<06:50,  8.73s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:02<06:50,  8.73s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:13<07:19,  9.55s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:13<07:19,  9.55s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:17<05:53,  7.85s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:17<05:53,  7.85s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:27<06:10,  8.42s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:27<06:10,  8.42s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:37<06:17,  8.78s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:37<06:17,  8.78s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:42<05:20,  7.64s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:42<05:20,  7.64s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:47<04:48,  7.03s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:47<04:48,  7.03s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:50<03:49,  5.73s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:50<03:49,  5.73s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:54<03:28,  5.34s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:54<03:28,  5.34s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:58<03:01,  4.78s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:58<03:01,  4.78s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:03<03:06,  5.03s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:03<03:06,  5.03s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:09<03:11,  5.32s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:09<03:11,  5.32s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:11<02:29,  4.26s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:11<02:29,  4.26s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:32<05:12,  9.20s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:32<05:12,  9.20s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:40<04:49,  8.78s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:40<04:49,  8.78s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:44<03:56,  7.38s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:44<03:56,  7.38s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:47<03:06,  6.01s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:47<03:06,  6.01s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:00<04:03,  8.12s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:00<04:03,  8.12s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:17<05:13, 10.80s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:17<05:13, 10.80s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:22<04:18,  9.22s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:22<04:18,  9.22s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:25<03:18,  7.34s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:25<03:18,  7.34s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:27<02:25,  5.61s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:27<02:25,  5.61s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:29<01:57,  4.69s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:29<01:57,  4.69s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:32<01:40,  4.18s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:32<01:40,  4.18s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:34<01:20,  3.52s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:34<01:20,  3.52s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:37<01:15,  3.44s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:37<01:15,  3.44s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:40<01:07,  3.21s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:40<01:07,  3.21s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:44<01:05,  3.30s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:44<01:05,  3.30s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:49<01:11,  3.76s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:49<01:11,  3.76s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:52<01:07,  3.76s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:52<01:07,  3.76s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:53<00:49,  2.94s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:53<00:49,  2.94s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:57<00:48,  3.04s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:57<00:48,  3.04s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:58<00:39,  2.66s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:58<00:39,  2.66s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:03<00:44,  3.20s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:03<00:44,  3.20s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:06<00:42,  3.24s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:06<00:42,  3.24s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:10<00:39,  3.30s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:10<00:39,  3.30s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:13<00:35,  3.22s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:13<00:35,  3.22s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:15<00:28,  2.85s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:15<00:28,  2.85s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:16<00:23,  2.56s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:16<00:23,  2.56s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:20<00:22,  2.84s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:20<00:22,  2.84s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:24<00:23,  3.30s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:24<00:23,  3.30s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:26<00:16,  2.75s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:26<00:16,  2.75s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:29<00:14,  2.92s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:29<00:14,  2.92s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:31<00:10,  2.54s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:31<00:10,  2.54s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:33<00:07,  2.39s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:33<00:07,  2.39s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:35<00:04,  2.25s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:35<00:04,  2.25s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:38<00:02,  2.59s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:38<00:02,  2.59s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:39<00:00,  2.17s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:39<00:00,  2.17s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.546875	0.9061778499278499
	steps: 0.390625	0.5011160714285714
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5357142857142857	0.9068110460967604
	steps: 0.17857142857142858	0.38443877551020406
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.8499659291325957
	steps: 0.16666666666666666	0.325376783710117
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7789947470168952
	steps: 0.0	0.22287395862056497
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6003580379520229
	steps: 0.0	0.1384004884004884
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7485507246376811
	steps: 0.0	0.22682191103243735
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8884615384615385
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6153846153846154	0.9302503052503053
	steps: 0.3076923076923077	0.4476190476190475
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.900909090909091
	steps: 0.1	0.3392857142857143
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.14285714285714285	0.789770546913404
	steps: 0.07142857142857142	0.23380230880230876
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8961038961038961
	steps: 0.0	0.21328671328671328
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.23076923076923073
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6549659404922563
	steps: 0.0	0.20083620083620088
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25874125874125875
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.21241830065359477
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.4615384615384615
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7111111111111111
	steps: 0.0	0.11461988304093568
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.8481711525189786
	steps: 0.0	0.27878787878787875
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:39<00:00,  4.89s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.8974867928288653
      F1_proof_val          0.4117647058823529
      F1_steps_val          0.5236341857730576
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=-5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:03,  3.27s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:03,  3.27s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:17,  2.80s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:17,  2.80s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<03:56,  2.60s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<03:56,  2.60s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:31,  2.35s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:31,  2.35s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:38,  3.13s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:38,  3.13s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<04:07,  2.81s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<04:07,  2.81s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:18<03:42,  2.55s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:18<03:42,  2.55s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:19<02:53,  2.01s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:19<02:53,  2.01s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:25,  1.71s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:25,  1.71s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:34,  3.27s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:34,  3.27s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<04:00,  2.90s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<04:00,  2.90s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:45,  2.75s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:45,  2.75s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:00,  2.98s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:00,  2.98s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:16,  3.20s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:16,  3.20s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:42<04:22,  3.32s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:42<04:22,  3.32s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:51<06:23,  4.92s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:51<06:23,  4.92s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:55<06:09,  4.80s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:55<06:09,  4.80s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:31,  4.36s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:59<05:31,  4.36s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:01<04:49,  3.86s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:01<04:49,  3.86s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:07<05:17,  4.29s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:07<05:17,  4.29s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:14<06:23,  5.25s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:14<06:23,  5.25s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:19<06:15,  5.21s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:19<06:15,  5.21s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:25<06:29,  5.49s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:25<06:29,  5.49s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:30<06:00,  5.15s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:30<06:00,  5.15s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:33<05:24,  4.71s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:33<05:24,  4.71s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:36<04:38,  4.10s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:36<04:38,  4.10s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:41<04:55,  4.41s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:41<04:55,  4.41s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:44<04:25,  4.03s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:44<04:25,  4.03s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:45<03:20,  3.08s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:45<03:20,  3.08s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:51<04:02,  3.78s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:51<04:02,  3.78s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:55<04:00,  3.82s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:55<04:00,  3.82s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:58<03:40,  3.56s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:58<03:40,  3.56s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:00<03:06,  3.06s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:00<03:06,  3.06s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:04<03:32,  3.55s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:04<03:32,  3.55s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:06<02:52,  2.92s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:06<02:52,  2.92s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:07<02:24,  2.48s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:07<02:24,  2.48s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:10<02:24,  2.53s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:10<02:24,  2.53s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:13<02:29,  2.67s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:13<02:29,  2.67s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:17<02:54,  3.17s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:17<02:54,  3.17s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:20<02:54,  3.24s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:20<02:54,  3.24s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:25<03:14,  3.68s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:25<03:14,  3.68s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:26<02:27,  2.84s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:26<02:27,  2.84s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:33<03:25,  4.03s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:33<03:25,  4.03s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:42<04:37,  5.56s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:42<04:37,  5.56s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:49<05:00,  6.13s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:49<05:00,  6.13s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:01<06:13,  7.77s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:01<06:13,  7.77s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:08<05:53,  7.51s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:08<05:53,  7.51s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:13<05:16,  6.89s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:13<05:16,  6.89s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:17<04:25,  5.89s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:17<04:25,  5.89s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:24<04:28,  6.09s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:24<04:28,  6.09s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<04:31,  6.30s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<04:31,  6.30s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:38<04:40,  6.68s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:38<04:40,  6.68s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:41<03:54,  5.73s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:41<03:54,  5.73s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:43<02:59,  4.49s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:43<02:59,  4.49s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:47<02:44,  4.23s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:47<02:44,  4.23s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:50<02:33,  4.04s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:50<02:33,  4.04s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:54<02:31,  4.10s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:54<02:31,  4.10s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:58<02:21,  3.93s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:58<02:21,  3.93s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:59<01:45,  3.01s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:59<01:45,  3.01s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:14<03:50,  6.78s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:14<03:50,  6.78s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:20<03:28,  6.31s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:20<03:28,  6.31s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:23<02:57,  5.56s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:23<02:57,  5.56s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:27<02:29,  4.84s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:27<02:29,  4.84s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:33<02:37,  5.24s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:33<02:37,  5.24s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:48<03:58,  8.23s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:48<03:58,  8.23s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:51<03:09,  6.78s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:51<03:09,  6.78s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:54<02:27,  5.47s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:54<02:27,  5.47s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:55<01:46,  4.09s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:55<01:46,  4.09s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:59<01:43,  4.14s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:59<01:43,  4.14s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:02<01:30,  3.79s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:02<01:30,  3.79s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:04<01:18,  3.41s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:04<01:18,  3.41s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:08<01:14,  3.37s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:08<01:14,  3.37s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:10<01:04,  3.09s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:10<01:04,  3.09s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:13<00:59,  2.99s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:13<00:59,  2.99s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:15<00:53,  2.81s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:15<00:53,  2.81s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:19<00:56,  3.13s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:19<00:56,  3.13s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:20<00:42,  2.51s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:20<00:42,  2.51s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:22<00:38,  2.38s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:22<00:38,  2.38s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:23<00:28,  1.93s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:23<00:28,  1.93s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:27<00:35,  2.54s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:27<00:35,  2.54s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:30<00:33,  2.54s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:30<00:33,  2.54s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:34<00:35,  2.94s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:34<00:35,  2.94s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:36<00:31,  2.90s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:36<00:31,  2.90s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:39<00:28,  2.83s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:39<00:28,  2.83s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:41<00:22,  2.49s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:41<00:22,  2.49s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:45<00:23,  2.97s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:45<00:23,  2.97s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:48<00:21,  3.13s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:48<00:21,  3.13s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:49<00:15,  2.51s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:49<00:15,  2.51s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:52<00:13,  2.68s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:52<00:13,  2.68s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:54<00:09,  2.37s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:54<00:09,  2.37s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:56<00:06,  2.29s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:56<00:06,  2.29s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:58<00:04,  2.17s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:58<00:04,  2.17s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:01<00:02,  2.46s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:01<00:02,  2.46s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:02<00:00,  1.89s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:02<00:00,  1.89s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9862745098039215
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.878830717893218
	steps: 0.375	0.4672991071428571
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.42857142857142855	0.8273912595341166
	steps: 0.17857142857142858	0.3959467120181405
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.8692420234086902
	steps: 0.16666666666666666	0.37316017316017314
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.721971114540774
	steps: 0.0	0.22915844838921762
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5283390279188598
	steps: 0.0	0.13430735930735932
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6863132799059573
	steps: 0.0	0.1622660658466285
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9829268292682927
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8751608751608752
	steps: 0.4594594594594595	0.5018018018018018
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8307692307692308
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.854181929181929
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.2	0.8556998556998557
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9168181818181818
	steps: 0.1	0.41428571428571426
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8296639868068441
	steps: 0.07142857142857142	0.2873015873015873
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8833333333333334
	steps: 0.0	0.2902097902097902
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7100840336134454
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.688781153487036
	steps: 0.0	0.19686285936285933
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8
	steps: 0.0	0.17692307692307693
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.4705882352941176
	steps: 0.0	0.12777777777777777
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6257575757575756
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8100686498855835
	steps: 0.0	0.22923178933409114
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:02<00:00,  3.85s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5454545454545454
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8693067112159114
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5165954098921124
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=-5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:22,  3.47s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:22,  3.47s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:37,  3.02s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:37,  3.02s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:16,  2.82s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<04:16,  2.82s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:49,  2.55s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:49,  2.55s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:09,  3.47s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:09,  3.47s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:33,  3.11s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:33,  3.11s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:35,  2.48s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:35,  2.48s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:50,  1.99s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:50,  1.99s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:21,  1.67s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:21,  1.67s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:33<06:49,  4.88s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:33<06:49,  4.88s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:35<05:38,  4.08s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:35<05:38,  4.08s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<04:57,  3.63s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:38<04:57,  3.63s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:41<04:50,  3.58s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:41<04:50,  3.58s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:45<04:58,  3.73s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:45<04:58,  3.73s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:49<04:59,  3.79s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:49<04:59,  3.79s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:57<06:33,  5.05s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:57<06:33,  5.05s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:05<07:33,  5.89s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:05<07:33,  5.89s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:10<06:54,  5.46s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:10<06:54,  5.46s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:13<05:56,  4.75s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:13<05:56,  4.75s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:21<06:57,  5.65s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:21<06:57,  5.65s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:26<06:58,  5.74s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:26<06:58,  5.74s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:31<06:17,  5.24s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:31<06:17,  5.24s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:37<06:30,  5.50s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:37<06:30,  5.50s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:42<06:18,  5.41s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:42<06:18,  5.41s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:46<05:43,  4.97s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:46<05:43,  4.97s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:49<04:56,  4.36s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:49<04:56,  4.36s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:55<05:20,  4.79s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:55<05:20,  4.79s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:58<04:57,  4.50s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:58<04:57,  4.50s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:59<03:43,  3.44s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:59<03:43,  3.44s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:05<04:16,  4.02s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:05<04:16,  4.02s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:09<04:15,  4.06s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:09<04:15,  4.06s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:14<04:38,  4.50s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:14<04:38,  4.50s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:17<03:52,  3.81s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:17<03:52,  3.81s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:21<04:03,  4.06s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:21<04:03,  4.06s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:23<03:19,  3.38s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:23<03:19,  3.38s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:24<02:42,  2.80s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:24<02:42,  2.80s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:27<02:39,  2.80s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:27<02:39,  2.80s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:31<02:48,  3.01s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:31<02:48,  3.01s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:36<03:23,  3.70s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:36<03:23,  3.70s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:39<03:10,  3.52s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:39<03:10,  3.52s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:43<03:14,  3.68s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:43<03:14,  3.68s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:44<02:28,  2.86s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:44<02:28,  2.86s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:46<02:15,  2.67s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:46<02:15,  2.67s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:56<03:54,  4.69s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:56<03:54,  4.69s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:04<04:42,  5.77s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:04<04:42,  5.77s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:14<05:43,  7.15s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:14<05:43,  7.15s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:21<05:32,  7.08s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:21<05:32,  7.08s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:29<05:36,  7.31s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:29<05:36,  7.31s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:31<04:21,  5.81s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:31<04:21,  5.81s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:38<04:27,  6.07s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:38<04:27,  6.07s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:47<04:57,  6.92s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:47<04:57,  6.92s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:51<04:18,  6.15s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:51<04:18,  6.15s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:56<03:55,  5.75s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:56<03:55,  5.75s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:58<03:01,  4.55s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:58<03:01,  4.55s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:01<02:37,  4.04s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:01<02:37,  4.04s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:05<02:34,  4.06s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:05<02:34,  4.06s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:09<02:28,  4.01s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:09<02:28,  4.01s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:13<02:24,  4.01s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:13<02:24,  4.01s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:14<01:48,  3.10s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:14<01:48,  3.10s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:33<04:28,  7.89s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:33<04:28,  7.89s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:35<03:27,  6.28s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:35<03:27,  6.28s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:39<02:52,  5.39s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:39<02:52,  5.39s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:42<02:25,  4.68s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:42<02:25,  4.68s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:53<03:21,  6.70s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:53<03:21,  6.70s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:08<04:21,  9.01s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:08<04:21,  9.01s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:11<03:25,  7.36s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:11<03:25,  7.36s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:14<02:41,  5.98s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:14<02:41,  5.98s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:15<01:56,  4.47s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:15<01:56,  4.47s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:19<01:53,  4.53s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:19<01:53,  4.53s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:22<01:33,  3.88s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:22<01:33,  3.88s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:23<01:10,  3.07s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:23<01:10,  3.07s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:26<01:05,  2.99s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:26<01:05,  2.99s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:28<01:00,  2.88s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:28<01:00,  2.88s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:31<00:58,  2.93s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:31<00:58,  2.93s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:34<00:53,  2.84s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:34<00:53,  2.84s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:39<01:00,  3.37s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:39<01:00,  3.37s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:40<00:45,  2.65s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:40<00:45,  2.65s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:42<00:41,  2.59s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:42<00:41,  2.59s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:43<00:31,  2.10s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:43<00:31,  2.10s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:46<00:34,  2.46s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:46<00:34,  2.46s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:50<00:35,  2.71s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:50<00:35,  2.71s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:53<00:34,  2.86s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:53<00:34,  2.86s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:56<00:32,  2.93s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:56<00:32,  2.93s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:59<00:29,  2.93s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:59<00:29,  2.93s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:01<00:23,  2.61s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:01<00:23,  2.61s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:04<00:21,  2.72s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:04<00:21,  2.72s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:10<00:25,  3.67s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:10<00:25,  3.67s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:11<00:17,  2.85s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:11<00:17,  2.85s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:14<00:15,  3.15s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:14<00:15,  3.15s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:16<00:11,  2.75s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:16<00:11,  2.75s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:19<00:07,  2.62s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:19<00:07,  2.62s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:23<00:06,  3.04s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:23<00:06,  3.04s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:26<00:03,  3.03s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:26<00:03,  3.03s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:26<00:00,  2.30s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:26<00:00,  2.30s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9215686274509803	0.9736694677871148
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.484375	0.8487091901154401
	steps: 0.328125	0.4062872023809524
	proof: 0.328125	0.328125
28 trees have depth 3
	leaves: 0.39285714285714285	0.8261137671851958
	steps: 0.14285714285714285	0.3546768707482993
	proof: 0.14285714285714285	0.14285714285714285
18 trees have depth 4
	leaves: 0.3888888888888889	0.8116884658551324
	steps: 0.16666666666666666	0.38638768638768645
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6873409521599567
	steps: 0.0	0.12232865174041643
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.47467653728157927
	steps: 0.0	0.1091628959276018
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.511904761904762
	steps: 0.0	0.1418859649122807
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.926829268292683	0.9707317073170731
	steps: 0.926829268292683	0.926829268292683
	proof: 0.926829268292683	0.926829268292683
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.6	0.6
	proof: 0.6	0.6
37 trees have size 5
	leaves: 0.4864864864864865	0.8592020592020593
	steps: 0.3783783783783784	0.4207207207207207
	proof: 0.3783783783783784	0.3783783783783784
13 trees have size 6
	leaves: 0.46153846153846156	0.821001221001221
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5384615384615384	0.8562271062271061
	steps: 0.2692307692307692	0.39816849816849814
	proof: 0.2692307692307692	0.2692307692307692
5 trees have size 8
	leaves: 0.2	0.827922077922078
	steps: 0.0	0.13
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9147979797979799
	steps: 0.1	0.44642857142857145
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.14285714285714285	0.6712287712287713
	steps: 0.07142857142857142	0.24761904761904763
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9006410256410255
	steps: 0.0	0.18636363636363634
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.375
	steps: 0.0	0.09090909090909091
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.4683904330963155
	steps: 0.0	0.07816627816627816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8705882352941177
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7175925925925926
	steps: 0.0	0.12605042016806722
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7692307692307693
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6896613190730837
	steps: 0.0	0.1469298245614035
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.5132275132275133
	steps: 0.0	0.14860681114551086
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.47916666666666663
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:26<00:00,  4.11s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5133689839572193
  ExactMatch_proof_val      0.3850267379679144
  ExactMatch_steps_val      0.3850267379679144
      F1_leaves_val         0.8398166074951227
      F1_proof_val          0.3850267379679144
      F1_steps_val          0.48178631134708017
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=-5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:31,  3.57s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:31,  3.57s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:59,  3.25s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:59,  3.25s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:16,  4.14s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:11<06:16,  4.14s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:53,  3.26s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:13<04:53,  3.26s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:20,  3.60s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:17<05:20,  3.60s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:44,  3.24s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:20<04:44,  3.24s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:20,  2.99s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:22<04:20,  2.99s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:38,  2.54s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:24<03:38,  2.54s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:15,  2.30s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:26<03:15,  2.30s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<08:05,  5.78s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:39<08:05,  5.78s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:42<06:31,  4.72s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:42<06:31,  4.72s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:31,  4.04s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:44<05:31,  4.04s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:56,  4.40s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:49<05:56,  4.40s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:56<06:38,  4.98s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:56<06:38,  4.98s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:00<06:22,  4.84s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:00<06:22,  4.84s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:06<06:50,  5.27s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:06<06:50,  5.27s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:11<06:35,  5.13s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:11<06:35,  5.13s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:15<05:55,  4.67s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:15<05:55,  4.67s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:18<05:14,  4.19s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:18<05:14,  4.19s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:23<05:21,  4.35s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:23<05:21,  4.35s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:31<06:44,  5.54s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:31<06:44,  5.54s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:41<08:17,  6.91s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:41<08:17,  6.91s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:49<08:29,  7.18s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:49<08:29,  7.18s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:56<08:14,  7.07s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:56<08:14,  7.07s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:59<06:41,  5.82s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:59<06:41,  5.82s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:01<05:34,  4.92s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:01<05:34,  4.92s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:08<06:04,  5.44s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:08<06:04,  5.44s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:11<05:18,  4.83s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:11<05:18,  4.83s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:13<04:04,  3.76s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:13<04:04,  3.76s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:17<04:15,  3.99s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:17<04:15,  3.99s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:21<03:57,  3.77s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:21<03:57,  3.77s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:25<04:04,  3.95s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:25<04:04,  3.95s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:27<03:34,  3.52s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:27<03:34,  3.52s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:34<04:22,  4.37s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:34<04:22,  4.37s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:36<03:36,  3.67s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:36<03:36,  3.67s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:38<03:10,  3.28s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:38<03:10,  3.28s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:42<03:15,  3.43s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:42<03:15,  3.43s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:47<03:37,  3.89s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:47<03:37,  3.89s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:53<04:05,  4.47s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:53<04:05,  4.47s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:56<03:34,  3.97s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:56<03:34,  3.97s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:02<04:15,  4.81s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:02<04:15,  4.81s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:03<03:11,  3.68s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:03<03:11,  3.68s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:15<05:04,  5.96s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:15<05:04,  5.96s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:26<06:18,  7.57s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:26<06:18,  7.57s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:47<09:32, 11.68s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:47<09:32, 11.68s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:55<08:24, 10.52s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:55<08:24, 10.52s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:03<07:43,  9.87s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:03<07:43,  9.87s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:10<06:44,  8.80s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:10<06:44,  8.80s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:15<05:47,  7.72s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:15<05:47,  7.72s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:23<05:41,  7.76s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:23<05:41,  7.76s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:34<06:18,  8.79s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:34<06:18,  8.79s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:38<05:14,  7.48s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [04:38<05:14,  7.48s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:43<04:26,  6.49s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:43<04:26,  6.49s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:45<03:34,  5.36s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:45<03:34,  5.36s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:50<03:20,  5.15s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:50<03:20,  5.15s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:53<02:54,  4.59s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:53<02:54,  4.59s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:01<03:23,  5.50s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:01<03:23,  5.50s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:05<03:02,  5.07s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:05<03:02,  5.07s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:07<02:23,  4.09s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:07<02:23,  4.09s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:22<04:09,  7.32s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:22<04:09,  7.32s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:29<04:05,  7.44s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:29<04:05,  7.44s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:34<03:34,  6.70s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [05:34<03:34,  6.70s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:37<02:51,  5.53s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [05:37<02:51,  5.53s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:49<03:41,  7.37s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [05:49<03:41,  7.37s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:07<05:11, 10.74s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:07<05:11, 10.74s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:12<04:11,  8.97s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:12<04:11,  8.97s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:15<03:08,  6.98s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:15<03:08,  6.98s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:16<02:19,  5.36s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:16<02:19,  5.36s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:19<01:58,  4.73s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:19<01:58,  4.73s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:22<01:37,  4.06s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:22<01:37,  4.06s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:24<01:19,  3.45s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:24<01:19,  3.45s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:27<01:13,  3.36s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:27<01:13,  3.36s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:30<01:06,  3.17s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:30<01:06,  3.17s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:33<01:05,  3.27s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:33<01:05,  3.27s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:36<01:01,  3.24s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [06:36<01:01,  3.24s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:40<01:02,  3.45s/it]Validation DataLoader 0:  81%|████████  | 76/94 [06:40<01:02,  3.45s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:41<00:46,  2.73s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [06:41<00:46,  2.73s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:44<00:43,  2.73s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [06:44<00:43,  2.73s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:46<00:36,  2.45s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [06:46<00:36,  2.45s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:51<00:43,  3.11s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [06:51<00:43,  3.11s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:54<00:40,  3.14s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [06:54<00:40,  3.14s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:58<00:42,  3.58s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [06:58<00:42,  3.58s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:01<00:36,  3.36s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:01<00:36,  3.36s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:03<00:29,  2.95s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:03<00:29,  2.95s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:05<00:23,  2.64s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:05<00:23,  2.64s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:08<00:21,  2.75s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:08<00:21,  2.75s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:12<00:21,  3.12s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:12<00:21,  3.12s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:14<00:15,  2.62s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:14<00:15,  2.62s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:16<00:13,  2.69s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:16<00:13,  2.69s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:18<00:09,  2.38s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:18<00:09,  2.38s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:20<00:06,  2.29s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:20<00:06,  2.29s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:22<00:04,  2.19s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:22<00:04,  2.19s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:27<00:03,  3.01s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [07:27<00:03,  3.01s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:28<00:00,  2.47s/it]Validation DataLoader 0: 100%|██████████| 94/94 [07:28<00:00,  2.47s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.9047833243145744
	steps: 0.390625	0.49838789682539686
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5357142857142857	0.9111259771974058
	steps: 0.17857142857142858	0.36709183673469387
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.867137646304313
	steps: 0.16666666666666666	0.33828362995029665
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.07692307692307693	0.7859512408154943
	steps: 0.0	0.2180941230714986
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5730548089681218
	steps: 0.0	0.12232620320855614
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7438919204365427
	steps: 0.0	0.222705671235083
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9050895050895051
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8967032967032966
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.6153846153846154	0.9330891330891331
	steps: 0.3076923076923077	0.44273504273504266
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.900909090909091
	steps: 0.1	0.3392857142857143
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8113822685251256
	steps: 0.07142857142857142	0.23270975056689341
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8961038961038961
	steps: 0.0	0.2435064935064935
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.07692307692307691
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.636650922177238
	steps: 0.0	0.2065875301169419
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.2532467532467533
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.5925925925925926
	steps: 0.0	0.2174688057040998
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.4615384615384615
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7072583419332644
	steps: 0.0	0.08088235294117647
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9465811965811964
	steps: 0.0	0.2954545454545454
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [07:28<00:00,  4.78s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.4117647058823529
  ExactMatch_steps_val      0.4117647058823529
      F1_leaves_val         0.9000975351183705
      F1_proof_val          0.4117647058823529
      F1_steps_val           0.520279375477551
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=-2.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:00,  3.24s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:00,  3.24s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:24,  2.87s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:05<04:24,  2.87s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<03:59,  2.63s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:08<03:59,  2.63s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:32,  2.36s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:10<03:32,  2.36s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:38,  3.12s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:14<04:38,  3.12s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<04:06,  2.81s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:16<04:06,  2.81s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:18<03:41,  2.54s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:18<03:41,  2.54s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:19<02:52,  2.00s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:19<02:52,  2.00s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:20,  1.65s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:20<02:20,  1.65s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:30,  3.21s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:27<04:30,  3.21s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<03:57,  2.86s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:29<03:57,  2.86s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:42,  2.72s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:31<03:42,  2.72s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:02,  2.99s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:35<04:02,  2.99s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:28,  3.35s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:39<04:28,  3.35s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:43<04:29,  3.41s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:43<04:29,  3.41s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:50<05:53,  4.53s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:50<05:53,  4.53s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:54<05:46,  4.50s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [00:54<05:46,  4.50s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:57<05:13,  4.12s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [00:57<05:13,  4.12s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:00<04:36,  3.68s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:00<04:36,  3.68s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:05<05:01,  4.07s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:05<05:01,  4.07s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:11<05:48,  4.78s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:11<05:48,  4.78s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:17<05:57,  4.96s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:17<05:57,  4.96s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:23<06:13,  5.26s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:23<06:13,  5.26s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:27<05:38,  4.83s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:27<05:38,  4.83s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:30<05:08,  4.48s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:30<05:08,  4.48s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:33<04:26,  3.92s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:33<04:26,  3.92s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:38<04:49,  4.33s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:38<04:49,  4.33s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:41<04:21,  3.96s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [01:41<04:21,  3.96s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:42<03:16,  3.03s/it]Validation DataLoader 0:  31%|███       | 29/94 [01:42<03:16,  3.03s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:47<03:56,  3.69s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [01:47<03:56,  3.69s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:52<04:10,  3.97s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [01:52<04:10,  3.97s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:55<03:46,  3.66s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [01:55<03:46,  3.66s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:57<03:10,  3.13s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [01:57<03:10,  3.13s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:01<03:32,  3.54s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:01<03:32,  3.54s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:03<02:51,  2.91s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:03<02:51,  2.91s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:05<02:35,  2.69s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:05<02:35,  2.69s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:08<02:31,  2.67s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:08<02:31,  2.67s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:13<03:09,  3.38s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:13<03:09,  3.38s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:17<03:20,  3.65s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:17<03:20,  3.65s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:20<03:15,  3.62s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:20<03:15,  3.62s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:25<03:19,  3.77s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:25<03:19,  3.77s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:25<02:30,  2.90s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:25<02:30,  2.90s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:32<03:28,  4.09s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:32<03:28,  4.09s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:43<05:03,  6.06s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [02:43<05:03,  6.06s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:51<05:26,  6.67s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [02:51<05:26,  6.67s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:02<06:18,  7.89s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:02<06:18,  7.89s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:11<06:33,  8.38s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:11<06:33,  8.38s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:16<05:38,  7.36s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:16<05:38,  7.36s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:19<04:32,  6.06s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:19<04:32,  6.06s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:23<03:54,  5.33s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:23<03:54,  5.33s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<04:17,  5.98s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:30<04:17,  5.98s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:35<03:58,  5.67s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:35<03:58,  5.67s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:40<03:43,  5.46s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [03:40<03:43,  5.46s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:42<02:51,  4.30s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [03:42<02:51,  4.30s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:45<02:39,  4.09s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [03:45<02:39,  4.09s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:49<02:25,  3.82s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [03:49<02:25,  3.82s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:53<02:25,  3.94s/it]Validation DataLoader 0:  61%|██████    | 57/94 [03:53<02:25,  3.94s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:56<02:17,  3.81s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [03:56<02:17,  3.81s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:57<01:42,  2.93s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [03:57<01:42,  2.93s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:14<03:55,  6.93s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:14<03:55,  6.93s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:19<03:31,  6.40s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:19<03:31,  6.40s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:22<02:53,  5.41s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:22<02:53,  5.41s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:25<02:26,  4.71s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:25<02:26,  4.71s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:32<02:45,  5.51s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:32<02:45,  5.51s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:45<03:45,  7.76s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [04:45<03:45,  7.76s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:48<02:55,  6.25s/it]Validation DataLoader 0:  70%|███████   | 66/94 [04:48<02:55,  6.25s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:50<02:17,  5.09s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [04:50<02:17,  5.09s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:51<01:39,  3.82s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [04:51<01:39,  3.82s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:55<01:33,  3.74s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [04:55<01:33,  3.74s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:57<01:18,  3.26s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [04:57<01:18,  3.26s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:59<01:09,  3.04s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [04:59<01:09,  3.04s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:03<01:08,  3.11s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:03<01:08,  3.11s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:05<01:01,  2.94s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:05<01:01,  2.94s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:08<00:57,  2.88s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:08<00:57,  2.88s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:10<00:51,  2.73s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:10<00:51,  2.73s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:14<00:55,  3.06s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:14<00:55,  3.06s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:15<00:40,  2.40s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:15<00:40,  2.40s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:17<00:36,  2.30s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:17<00:36,  2.30s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:18<00:28,  1.87s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:18<00:28,  1.87s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:21<00:31,  2.27s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:21<00:31,  2.27s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:24<00:30,  2.34s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:24<00:30,  2.34s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:28<00:35,  3.00s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:28<00:35,  3.00s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:31<00:31,  2.82s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [05:31<00:31,  2.82s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:33<00:27,  2.76s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [05:33<00:27,  2.76s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:35<00:22,  2.49s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [05:35<00:22,  2.49s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:39<00:23,  2.99s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [05:39<00:23,  2.99s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:43<00:21,  3.13s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [05:43<00:21,  3.13s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:44<00:15,  2.50s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [05:44<00:15,  2.50s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:47<00:13,  2.62s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [05:47<00:13,  2.62s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:48<00:09,  2.33s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [05:48<00:09,  2.33s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:50<00:06,  2.10s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [05:50<00:06,  2.10s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:52<00:03,  1.99s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [05:52<00:03,  1.99s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:54<00:02,  2.17s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [05:54<00:02,  2.17s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:55<00:00,  1.68s/it]Validation DataLoader 0: 100%|██████████| 94/94 [05:55<00:00,  1.68s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9862745098039215
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.878830717893218
	steps: 0.375	0.4672991071428571
	proof: 0.375	0.375
28 trees have depth 3
	leaves: 0.42857142857142855	0.8255597577026148
	steps: 0.17857142857142858	0.3959467120181405
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8742925284591951
	steps: 0.16666666666666666	0.3814935064935065
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6893678203990183
	steps: 0.0	0.21503795349949195
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5091313448456306
	steps: 0.0	0.14254911754911756
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6863132799059573
	steps: 0.0	0.1622660658466285
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9829268292682927
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8751608751608752
	steps: 0.4594594594594595	0.5018018018018018
	proof: 0.4594594594594595	0.4594594594594595
13 trees have size 6
	leaves: 0.46153846153846156	0.8307692307692308
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.854181929181929
	steps: 0.3076923076923077	0.4560439560439561
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.2	0.8556998556998557
	steps: 0.0	0.19666666666666668
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9168181818181818
	steps: 0.1	0.41428571428571426
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8545724117152689
	steps: 0.07142857142857142	0.32777777777777783
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8423076923076923
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7100840336134454
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.5697335344394169
	steps: 0.0	0.1690850815850816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8
	steps: 0.0	0.17692307692307693
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.4257703081232493
	steps: 0.0	0.147008547008547
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6742424242424242
	steps: 0.0	0.10793650793650794
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8100686498855835
	steps: 0.0	0.22923178933409114
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.575657894736842
	steps: 0.0	0.058823529411764705
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [05:55<00:00,  3.78s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5508021390374331
  ExactMatch_proof_val      0.40641711229946526
  ExactMatch_steps_val      0.40641711229946526
      F1_leaves_val         0.8665330771745833
      F1_proof_val          0.40641711229946526
      F1_steps_val          0.5167244252617695
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=-2.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:42,  3.68s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:42,  3.68s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:48,  3.14s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<04:48,  3.14s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:24,  2.91s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:09<04:24,  2.91s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<03:55,  2.62s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:11<03:55,  2.62s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:10,  3.49s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:16<05:10,  3.49s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:36,  3.14s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:18<04:36,  3.14s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:37,  2.50s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:19<03:37,  2.50s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:52,  2.01s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:20<02:52,  2.01s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:23,  1.69s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:21<02:23,  1.69s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<07:04,  5.06s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:34<07:04,  5.06s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:49,  4.22s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:36<05:49,  4.22s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<05:07,  3.75s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:39<05:07,  3.75s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:42<04:57,  3.67s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:42<04:57,  3.67s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:46<05:01,  3.77s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:46<05:01,  3.77s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:50<05:02,  3.83s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:50<05:02,  3.83s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:59<06:39,  5.12s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [00:59<06:39,  5.12s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:07<07:56,  6.19s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:07<07:56,  6.19s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<07:12,  5.68s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:12<07:12,  5.68s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:14<05:58,  4.78s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:14<05:58,  4.78s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:22<06:53,  5.58s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:22<06:53,  5.58s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:28<06:57,  5.72s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:28<06:57,  5.72s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:32<06:15,  5.22s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:32<06:15,  5.22s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:39<06:42,  5.67s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:39<06:42,  5.67s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:44<06:25,  5.50s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:44<06:25,  5.50s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:48<05:50,  5.07s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [01:48<05:50,  5.07s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:51<05:02,  4.44s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [01:51<05:02,  4.44s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:57<05:41,  5.10s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [01:57<05:41,  5.10s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:01<05:13,  4.74s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:01<05:13,  4.74s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:02<03:54,  3.61s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:02<03:54,  3.61s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:08<04:29,  4.22s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:08<04:29,  4.22s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:12<04:26,  4.23s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:12<04:26,  4.23s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:19<05:00,  4.85s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:19<05:00,  4.85s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:21<04:08,  4.08s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:21<04:08,  4.08s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:27<04:44,  4.75s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:27<04:44,  4.75s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:29<03:44,  3.80s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:29<03:44,  3.80s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:30<03:00,  3.11s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:30<03:00,  3.11s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:33<02:55,  3.08s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:33<02:55,  3.08s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:37<03:00,  3.22s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:37<03:00,  3.22s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:42<03:33,  3.88s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [02:42<03:33,  3.88s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:46<03:29,  3.88s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [02:46<03:29,  3.88s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:50<03:27,  3.91s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [02:50<03:27,  3.91s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:51<02:37,  3.03s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [02:51<02:37,  3.03s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:53<02:22,  2.80s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [02:53<02:22,  2.80s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:03<04:00,  4.81s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:03<04:00,  4.81s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:11<04:49,  5.90s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [03:11<04:49,  5.90s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:22<05:57,  7.45s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [03:22<05:57,  7.45s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:30<05:47,  7.39s/it]Validation DataLoader 0:  50%|█████     | 47/94 [03:30<05:47,  7.39s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:37<05:41,  7.43s/it]Validation DataLoader 0:  51%|█████     | 48/94 [03:37<05:41,  7.43s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:39<04:25,  5.90s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [03:39<04:25,  5.90s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:44<04:05,  5.58s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [03:44<04:05,  5.58s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:54<04:48,  6.71s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [03:54<04:48,  6.71s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:57<04:05,  5.86s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [03:57<04:05,  5.86s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:01<03:29,  5.12s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [04:01<03:29,  5.12s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:03<02:46,  4.16s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [04:03<02:46,  4.16s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:06<02:37,  4.03s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [04:06<02:37,  4.03s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:10<02:28,  3.90s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [04:10<02:28,  3.90s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:14<02:25,  3.92s/it]Validation DataLoader 0:  61%|██████    | 57/94 [04:14<02:25,  3.92s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:18<02:21,  3.93s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [04:18<02:21,  3.93s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:19<01:46,  3.05s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [04:19<01:46,  3.05s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:40<04:43,  8.34s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [04:40<04:43,  8.34s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:42<03:38,  6.62s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [04:42<03:38,  6.62s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:46<03:02,  5.69s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [04:46<03:02,  5.69s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:49<02:30,  4.86s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [04:49<02:30,  4.86s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:59<03:12,  6.43s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [04:59<03:12,  6.43s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:13<04:16,  8.84s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [05:13<04:16,  8.84s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:17<03:23,  7.26s/it]Validation DataLoader 0:  70%|███████   | 66/94 [05:17<03:23,  7.26s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:20<02:38,  5.89s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [05:20<02:38,  5.89s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:21<01:54,  4.41s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [05:21<01:54,  4.41s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:24<01:42,  4.09s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [05:24<01:42,  4.09s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:27<01:30,  3.77s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [05:27<01:30,  3.77s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:28<01:08,  3.00s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [05:28<01:08,  3.00s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:31<01:04,  2.95s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [05:31<01:04,  2.95s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:34<01:01,  2.92s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [05:34<01:01,  2.92s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:37<00:57,  2.87s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [05:37<00:57,  2.87s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:39<00:53,  2.81s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [05:39<00:53,  2.81s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:44<01:00,  3.38s/it]Validation DataLoader 0:  81%|████████  | 76/94 [05:44<01:00,  3.38s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:45<00:45,  2.66s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [05:45<00:45,  2.66s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:47<00:41,  2.56s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [05:47<00:41,  2.56s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:48<00:31,  2.09s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [05:48<00:31,  2.09s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:51<00:33,  2.37s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [05:51<00:33,  2.37s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:55<00:34,  2.66s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [05:55<00:34,  2.66s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:59<00:36,  3.06s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [05:59<00:36,  3.06s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:02<00:33,  3.09s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [06:02<00:33,  3.09s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:05<00:30,  3.10s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [06:05<00:30,  3.10s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:07<00:24,  2.74s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [06:07<00:24,  2.74s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:11<00:26,  3.26s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [06:11<00:26,  3.26s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:16<00:25,  3.64s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [06:16<00:25,  3.64s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:17<00:17,  2.84s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [06:17<00:17,  2.84s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:20<00:15,  3.12s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [06:20<00:15,  3.12s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:22<00:10,  2.74s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [06:22<00:10,  2.74s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:25<00:07,  2.62s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [06:25<00:07,  2.62s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:29<00:06,  3.11s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [06:29<00:06,  3.11s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:32<00:03,  3.09s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [06:32<00:03,  3.09s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:33<00:00,  2.40s/it]Validation DataLoader 0: 100%|██████████| 94/94 [06:33<00:00,  2.40s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9215686274509803	0.9736694677871148
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.484375	0.847035082972583
	steps: 0.328125	0.4062872023809524
	proof: 0.328125	0.328125
28 trees have depth 3
	leaves: 0.39285714285714285	0.8261137671851958
	steps: 0.14285714285714285	0.3546768707482993
	proof: 0.14285714285714285	0.14285714285714285
18 trees have depth 4
	leaves: 0.3888888888888889	0.8116884658551324
	steps: 0.16666666666666666	0.38638768638768645
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.6775507423697469
	steps: 0.0	0.14155942097118565
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.44519807923169263
	steps: 0.0	0.11950549450549451
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.5161375661375662
	steps: 0.0	0.1418859649122807
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.926829268292683	0.9707317073170731
	steps: 0.926829268292683	0.926829268292683
	proof: 0.926829268292683	0.926829268292683
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.6	0.6
	proof: 0.6	0.6
37 trees have size 5
	leaves: 0.4864864864864865	0.8592020592020593
	steps: 0.3783783783783784	0.4207207207207207
	proof: 0.3783783783783784	0.3783783783783784
13 trees have size 6
	leaves: 0.46153846153846156	0.821001221001221
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5384615384615384	0.8521062271062271
	steps: 0.2692307692307692	0.39816849816849814
	proof: 0.2692307692307692	0.2692307692307692
5 trees have size 8
	leaves: 0.2	0.827922077922078
	steps: 0.0	0.13
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.9147979797979799
	steps: 0.1	0.44642857142857145
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.14285714285714285	0.6621378621378621
	steps: 0.07142857142857142	0.2654761904761905
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9006410256410255
	steps: 0.0	0.18636363636363634
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.375
	steps: 0.0	0.09090909090909091
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.45410471881060116
	steps: 0.0	0.07816627816627816
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8705882352941177
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6488095238095238
	steps: 0.0	0.15018315018315018
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.7692307692307693
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6896613190730837
	steps: 0.0	0.1469298245614035
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.5132275132275133
	steps: 0.0	0.14860681114551086
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [06:33<00:00,  4.18s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5133689839572193
  ExactMatch_proof_val      0.3850267379679144
  ExactMatch_steps_val      0.3850267379679144
      F1_leaves_val          0.837595388428984
      F1_proof_val          0.3850267379679144
      F1_steps_val          0.4835103658393008
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=-2.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:57,  3.84s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:57,  3.84s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:28,  3.57s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:28,  3.57s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:14<07:56,  5.24s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:14<07:56,  5.24s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:16<06:06,  4.07s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:16<06:06,  4.07s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<06:44,  4.54s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<06:44,  4.54s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:24<05:31,  3.77s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:24<05:31,  3.77s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:27<05:04,  3.50s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:27<05:04,  3.50s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:29<04:18,  3.01s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:29<04:18,  3.01s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:31<03:44,  2.65s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:31<03:44,  2.65s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:45<08:44,  6.25s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:45<08:44,  6.25s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:47<07:04,  5.12s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:47<07:04,  5.12s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:50<06:03,  4.43s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:50<06:03,  4.43s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:56<06:33,  4.86s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:56<06:33,  4.86s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:02<06:42,  5.03s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:02<06:42,  5.03s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:07<06:45,  5.13s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:07<06:45,  5.13s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:15<07:48,  6.01s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:15<07:48,  6.01s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:20<07:29,  5.83s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:20<07:29,  5.83s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:28<08:08,  6.42s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:28<08:08,  6.42s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<06:48,  5.45s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<06:48,  5.45s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:36<06:24,  5.20s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:36<06:24,  5.20s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:45<07:43,  6.35s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:45<07:43,  6.35s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:54<08:25,  7.01s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:54<08:25,  7.01s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:07<10:26,  8.82s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:07<10:26,  8.82s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:13<09:25,  8.07s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:13<09:25,  8.07s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:16<07:33,  6.57s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:16<07:33,  6.57s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:19<06:19,  5.59s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:19<06:19,  5.59s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:26<06:36,  5.92s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:26<06:36,  5.92s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:29<05:37,  5.12s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:29<05:37,  5.12s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:31<04:26,  4.10s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:31<04:26,  4.10s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:37<04:56,  4.63s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:37<04:56,  4.63s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:41<04:47,  4.56s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:41<04:47,  4.56s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:45<04:36,  4.45s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:45<04:36,  4.45s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:48<04:01,  3.95s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:48<04:01,  3.95s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:57<05:23,  5.39s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:57<05:23,  5.39s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:59<04:20,  4.42s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:59<04:20,  4.42s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:01<03:36,  3.73s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:01<03:36,  3.73s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:05<03:35,  3.79s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:05<03:35,  3.79s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:14<04:51,  5.20s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:14<04:51,  5.20s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:31<07:57,  8.69s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:31<07:57,  8.69s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:34<06:17,  6.99s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:34<06:17,  6.99s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:43<06:52,  7.78s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:43<06:52,  7.78s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:45<05:06,  5.89s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:45<05:06,  5.89s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:55<06:12,  7.30s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:55<06:12,  7.30s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:33<13:37, 16.36s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:33<13:37, 16.36s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:56<15:04, 18.46s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:56<15:04, 18.46s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:05<12:32, 15.67s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:05<12:32, 15.67s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:15<10:53, 13.91s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:15<10:53, 13.91s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:28<10:23, 13.56s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:28<10:23, 13.56s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:38<09:27, 12.61s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:38<09:27, 12.61s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:46<08:06, 11.06s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:46<08:06, 11.06s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:04<09:33, 13.33s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:04<09:33, 13.33s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:12<08:09, 11.65s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:12<08:09, 11.65s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:19<06:55, 10.14s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:19<06:55, 10.14s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:22<05:23,  8.10s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:22<05:23,  8.10s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:27<04:43,  7.27s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:27<04:43,  7.27s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:31<03:56,  6.22s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:31<03:56,  6.22s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:37<03:43,  6.05s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:37<03:43,  6.05s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:42<03:28,  5.78s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:42<03:28,  5.78s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:44<02:43,  4.68s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:44<02:43,  4.68s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:02<04:54,  8.67s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:02<04:54,  8.67s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:10<04:42,  8.56s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:10<04:42,  8.56s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:14<03:46,  7.08s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:14<03:46,  7.08s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:17<03:00,  5.84s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:17<03:00,  5.84s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:35<04:46,  9.54s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:35<04:46,  9.54s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:54<05:57, 12.34s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:54<05:57, 12.34s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:59<04:45, 10.20s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:59<04:45, 10.20s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:02<03:40,  8.16s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:02<03:40,  8.16s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:04<02:43,  6.29s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:04<02:43,  6.29s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:08<02:17,  5.50s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:08<02:17,  5.50s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:11<01:52,  4.67s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:11<01:52,  4.67s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:13<01:29,  3.90s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:13<01:29,  3.90s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:16<01:21,  3.72s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:16<01:21,  3.72s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:19<01:13,  3.51s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:19<01:13,  3.51s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:24<01:17,  3.88s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:24<01:17,  3.88s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:28<01:14,  3.94s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:28<01:14,  3.94s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:32<01:10,  3.90s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:32<01:10,  3.90s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:34<00:56,  3.30s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:34<00:56,  3.30s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:37<00:53,  3.36s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:37<00:53,  3.36s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:39<00:43,  2.89s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:39<00:43,  2.89s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:45<00:52,  3.77s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:45<00:52,  3.77s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:49<00:52,  4.01s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:49<00:52,  4.01s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:54<00:48,  4.03s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:54<00:48,  4.03s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:57<00:43,  3.98s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:57<00:43,  3.98s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:01<00:38,  3.88s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:01<00:38,  3.88s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:03<00:30,  3.38s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:03<00:30,  3.38s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:09<00:33,  4.15s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:09<00:33,  4.15s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [09:14<00:30,  4.41s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [09:14<00:30,  4.41s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:16<00:21,  3.64s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:16<00:21,  3.64s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:19<00:17,  3.48s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:19<00:17,  3.48s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:22<00:13,  3.35s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:22<00:13,  3.35s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:25<00:09,  3.10s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:25<00:09,  3.10s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:29<00:07,  3.58s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:29<00:07,  3.58s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:35<00:04,  4.09s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:35<00:04,  4.09s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:36<00:00,  3.22s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:36<00:00,  3.22s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.546875	0.9115101911976912
	steps: 0.390625	0.5015625
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.4642857142857143	0.9088584035012607
	steps: 0.17857142857142858	0.38358843537414966
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8884339426006094
	steps: 0.2222222222222222	0.3777898027898028
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.0	0.792036967953853
	steps: 0.0	0.25500397038858574
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5843193147704425
	steps: 0.0	0.11616569704804999
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7549060654857755
	steps: 0.0	0.21484996484996488
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5945945945945946	0.9089505089505091
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.5384615384615384	0.9214285714285714
	steps: 0.3076923076923077	0.5076923076923077
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5	0.9251526251526253
	steps: 0.3076923076923077	0.4294871794871795
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.6	0.925909090909091
	steps: 0.1	0.4057142857142857
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.45238095238095244
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8373562944991516
	steps: 0.14285714285714285	0.2894557823129252
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.9151515151515153
	steps: 0.0	0.203030303030303
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7689075630252101
	steps: 0.0	0.14285714285714285
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6410770516033674
	steps: 0.0	0.2058937794231912
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.2532467532467533
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6918578497525866
	steps: 0.0	0.25555555555555554
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.9333333333333333
	steps: 0.0	0.42857142857142855
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6787317620650953
	steps: 0.0	0.09294871794871795
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.9266666666666666
	steps: 0.0	0.3023088023088023
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:36<00:00,  6.13s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.9053082924128681
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5297219461186118
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=2.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:13,  4.66s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:13,  4.66s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:46,  3.77s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:46,  3.77s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:15<08:20,  5.50s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:15<08:20,  5.50s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:18<06:51,  4.58s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:18<06:51,  4.58s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<06:32,  4.41s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:22<06:32,  4.41s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:25<05:44,  3.92s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:25<05:44,  3.92s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:30<05:59,  4.13s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:30<05:59,  4.13s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:32<04:59,  3.48s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:32<04:59,  3.48s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:34<04:34,  3.23s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:34<04:34,  3.23s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:51<10:05,  7.21s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:51<10:05,  7.21s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:54<08:11,  5.92s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:54<08:11,  5.92s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:57<07:05,  5.19s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:57<07:05,  5.19s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:04<07:42,  5.71s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:04<07:42,  5.71s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:10<07:42,  5.79s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:10<07:42,  5.79s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:16<07:53,  5.99s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:16<07:53,  5.99s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:34<12:23,  9.53s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:34<12:23,  9.53s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:51<15:01, 11.70s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:51<15:01, 11.70s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:55<11:59,  9.47s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:55<11:59,  9.47s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:59<09:47,  7.83s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:59<09:47,  7.83s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:05<09:01,  7.32s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:05<09:01,  7.32s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:12<08:31,  7.00s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:12<08:31,  7.00s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:22<09:30,  7.92s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:22<09:30,  7.92s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:33<10:34,  8.94s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:33<10:34,  8.94s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:37<08:38,  7.40s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:37<08:38,  7.40s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:42<07:48,  6.79s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:42<07:48,  6.79s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:46<06:37,  5.84s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:46<06:37,  5.84s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:54<07:11,  6.45s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:54<07:11,  6.45s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:58<06:20,  5.76s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:58<06:20,  5.76s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:00<04:56,  4.56s/it]Validation DataLoader 0:  31%|███       | 29/94 [03:00<04:56,  4.56s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:07<05:48,  5.44s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:07<05:48,  5.44s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:13<05:43,  5.45s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:13<05:43,  5.45s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:18<05:38,  5.47s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:18<05:38,  5.47s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:21<04:47,  4.72s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:21<04:47,  4.72s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:34<07:16,  7.28s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:34<07:16,  7.28s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:37<05:43,  5.82s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:37<05:43,  5.82s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:39<04:41,  4.86s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:39<04:41,  4.86s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:42<04:03,  4.28s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:42<04:03,  4.28s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:49<04:36,  4.94s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:49<04:36,  4.94s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:00<06:12,  6.77s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:00<06:12,  6.77s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:06<06:02,  6.70s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:06<06:02,  6.70s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:12<05:40,  6.42s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:12<05:40,  6.42s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:14<04:25,  5.10s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:14<04:25,  5.10s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:21<04:48,  5.66s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:21<04:48,  5.66s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:50<10:25, 12.52s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:50<10:25, 12.52s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:02<10:06, 12.37s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:02<10:06, 12.37s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:16<10:28, 13.09s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:16<10:28, 13.09s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:32<10:45, 13.74s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:32<10:45, 13.74s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:44<10:14, 13.36s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:44<10:14, 13.36s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:49<08:03, 10.75s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:49<08:03, 10.75s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:57<07:26, 10.15s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:57<07:26, 10.15s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:15<08:56, 12.48s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:15<08:56, 12.48s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:22<07:26, 10.62s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:22<07:26, 10.62s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:28<06:23,  9.36s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:28<06:23,  9.36s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:32<05:04,  7.61s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:32<05:04,  7.61s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:39<04:49,  7.43s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:39<04:49,  7.43s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:42<03:59,  6.31s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:42<03:59,  6.31s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:48<03:47,  6.15s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:48<03:47,  6.15s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:53<03:27,  5.77s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [06:53<03:27,  5.77s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:55<02:44,  4.71s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [06:55<02:44,  4.71s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:15<05:13,  9.21s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:15<05:13,  9.21s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:25<05:17,  9.61s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:25<05:17,  9.61s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:30<04:22,  8.20s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:30<04:22,  8.20s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:34<03:36,  6.97s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:34<03:36,  6.97s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:44<03:54,  7.83s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [07:44<03:54,  7.83s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [08:06<05:51, 12.12s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [08:06<05:51, 12.12s/it]Validation DataLoader 0:  70%|███████   | 66/94 [08:10<04:25,  9.49s/it]Validation DataLoader 0:  70%|███████   | 66/94 [08:10<04:25,  9.49s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:13<03:21,  7.45s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:13<03:21,  7.45s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:15<02:31,  5.82s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:15<02:31,  5.82s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:19<02:17,  5.49s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:19<02:17,  5.49s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:22<01:51,  4.65s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:22<01:51,  4.65s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:25<01:38,  4.29s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:25<01:38,  4.29s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:31<01:41,  4.63s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:31<01:41,  4.63s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:35<01:34,  4.48s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:35<01:34,  4.48s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:41<01:38,  4.90s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:41<01:38,  4.90s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:45<01:27,  4.63s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:45<01:27,  4.63s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:50<01:28,  4.93s/it]Validation DataLoader 0:  81%|████████  | 76/94 [08:50<01:28,  4.93s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:52<01:07,  3.97s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [08:52<01:07,  3.97s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:55<00:58,  3.68s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [08:55<00:58,  3.68s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:57<00:47,  3.15s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [08:57<00:47,  3.15s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [09:02<00:49,  3.55s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [09:02<00:49,  3.55s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [09:05<00:46,  3.56s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [09:05<00:46,  3.56s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [09:11<00:49,  4.14s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [09:11<00:49,  4.14s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [09:14<00:42,  3.88s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [09:14<00:42,  3.88s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:16<00:34,  3.41s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:16<00:34,  3.41s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:19<00:27,  3.08s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:19<00:27,  3.08s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:26<00:33,  4.24s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:26<00:33,  4.24s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [09:32<00:33,  4.78s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [09:32<00:33,  4.78s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:33<00:23,  3.89s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [09:33<00:23,  3.89s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:38<00:19,  3.97s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [09:38<00:19,  3.97s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:40<00:13,  3.38s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [09:40<00:13,  3.38s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:42<00:09,  3.18s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [09:42<00:09,  3.18s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:50<00:09,  4.55s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [09:50<00:09,  4.55s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:55<00:04,  4.60s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [09:55<00:04,  4.60s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:56<00:00,  3.62s/it]Validation DataLoader 0: 100%|██████████| 94/94 [09:56<00:00,  3.62s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.546875	0.9076659451659451
	steps: 0.421875	0.5303199404761905
	proof: 0.421875	0.421875
28 trees have depth 3
	leaves: 0.4642857142857143	0.8898609327180756
	steps: 0.17857142857142858	0.3557823129251701
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8854036395703062
	steps: 0.2777777777777778	0.4148268398268398
	proof: 0.2777777777777778	0.2777777777777778
13 trees have depth 5
	leaves: 0.15384615384615385	0.7853840603840604
	steps: 0.0	0.262118650580189
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5785090959460708
	steps: 0.0	0.15620094191522763
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7208290107065177
	steps: 0.0	0.13233213575285185
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.8999414999415
	steps: 0.4864864864864865	0.5558558558558558
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.6153846153846154	0.9324175824175824
	steps: 0.46153846153846156	0.5615384615384615
	proof: 0.46153846153846156	0.46153846153846156
26 trees have size 7
	leaves: 0.5	0.9084249084249085
	steps: 0.3076923076923077	0.45347985347985353
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.9414141414141414
	steps: 0.0	0.2966666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.8812626262626264
	steps: 0.1	0.34404761904761905
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8710226281654853
	steps: 0.21428571428571427	0.3404761904761905
	proof: 0.21428571428571427	0.21428571428571427
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.75	0.9
	steps: 0.0	0.2727272727272727
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8015873015873016
	steps: 0.0	0.19642857142857142
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.7061041083099907
	steps: 0.0	0.17582417582417587
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7946428571428572
	steps: 0.0	0.24358974358974358
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6315645139174549
	steps: 0.0	0.15
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.25
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6179084073820916
	steps: 0.0	0.09049773755656108
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.7582345191040843
	steps: 0.0	0.2036231884057971
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.5454545454545455
	steps: 0.0	0.19047619047619044
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [09:56<00:00,  6.35s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.43315508021390375
  ExactMatch_steps_val      0.43315508021390375
      F1_leaves_val         0.8990830087692327
      F1_proof_val          0.43315508021390375
      F1_steps_val          0.5383112616830493
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=2.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:09<14:24,  9.30s/it]Validation DataLoader 0:   1%|          | 1/94 [00:09<14:24,  9.30s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:13<09:21,  6.11s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:13<09:21,  6.11s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:20<10:12,  6.74s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:20<10:12,  6.74s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:23<07:41,  5.13s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:23<07:41,  5.13s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:32<09:53,  6.67s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:32<09:53,  6.67s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:36<08:13,  5.61s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:36<08:13,  5.61s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:40<07:37,  5.26s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:40<07:37,  5.26s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:43<06:15,  4.37s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:43<06:15,  4.37s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:45<05:21,  3.78s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:45<05:21,  3.78s/it]Validation DataLoader 0:  11%|█         | 10/94 [01:05<12:00,  8.58s/it]Validation DataLoader 0:  11%|█         | 10/94 [01:05<12:00,  8.58s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [01:07<09:27,  6.84s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [01:07<09:27,  6.84s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [01:11<08:09,  5.97s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [01:11<08:09,  5.97s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:22<10:07,  7.50s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:22<10:07,  7.50s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:28<09:23,  7.04s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:28<09:23,  7.04s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:42<11:43,  8.91s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:42<11:43,  8.91s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:57<14:01, 10.78s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:57<14:01, 10.78s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [02:16<17:07, 13.34s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [02:16<17:07, 13.34s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [02:29<16:35, 13.11s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [02:29<16:35, 13.11s/it]Validation DataLoader 0:  20%|██        | 19/94 [02:36<14:21, 11.49s/it]Validation DataLoader 0:  20%|██        | 19/94 [02:36<14:21, 11.49s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:45<13:10, 10.68s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [02:45<13:10, 10.68s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:56<12:58, 10.66s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [02:56<12:58, 10.66s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [03:07<12:54, 10.75s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [03:07<12:54, 10.75s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [03:27<16:13, 13.71s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [03:27<16:13, 13.71s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [03:32<12:53, 11.04s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [03:32<12:53, 11.04s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [03:41<11:52, 10.33s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [03:41<11:52, 10.33s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [03:45<09:35,  8.47s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [03:45<09:35,  8.47s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [04:01<11:51, 10.62s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [04:01<11:51, 10.62s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [04:06<09:57,  9.05s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [04:06<09:57,  9.05s/it]Validation DataLoader 0:  31%|███       | 29/94 [04:08<07:20,  6.78s/it]Validation DataLoader 0:  31%|███       | 29/94 [04:08<07:20,  6.78s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [04:15<07:25,  6.96s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [04:15<07:25,  6.96s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [04:20<06:46,  6.44s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [04:20<06:46,  6.44s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [04:29<07:20,  7.11s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [04:29<07:20,  7.11s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [04:33<06:14,  6.15s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [04:33<06:14,  6.15s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [04:44<07:44,  7.74s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [04:44<07:44,  7.74s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [04:47<06:12,  6.31s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [04:47<06:12,  6.31s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:54<06:07,  6.33s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [04:54<06:07,  6.33s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:59<05:44,  6.05s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [04:59<05:44,  6.05s/it]Validation DataLoader 0:  40%|████      | 38/94 [05:04<05:22,  5.75s/it]Validation DataLoader 0:  40%|████      | 38/94 [05:04<05:22,  5.75s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [05:15<06:38,  7.25s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [05:15<06:38,  7.25s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [05:18<05:35,  6.20s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [05:18<05:35,  6.20s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [05:28<06:15,  7.08s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [05:28<06:15,  7.08s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [05:30<04:57,  5.72s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [05:30<04:57,  5.72s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [05:36<04:54,  5.78s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [05:36<04:54,  5.78s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:57<08:42, 10.45s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [05:57<08:42, 10.45s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [06:31<14:04, 17.24s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [06:31<14:04, 17.24s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [06:46<13:27, 16.81s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [06:46<13:27, 16.81s/it]Validation DataLoader 0:  50%|█████     | 47/94 [06:59<12:14, 15.63s/it]Validation DataLoader 0:  50%|█████     | 47/94 [06:59<12:14, 15.63s/it]Validation DataLoader 0:  51%|█████     | 48/94 [07:15<12:03, 15.72s/it]Validation DataLoader 0:  51%|█████     | 48/94 [07:15<12:03, 15.72s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [07:23<10:07, 13.50s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [07:23<10:07, 13.50s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [07:35<09:25, 12.85s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [07:35<09:25, 12.85s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [07:49<09:24, 13.12s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [07:49<09:24, 13.12s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [07:59<08:33, 12.24s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [07:59<08:33, 12.24s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [08:04<06:54, 10.12s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [08:04<06:54, 10.12s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [08:08<05:30,  8.25s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [08:08<05:30,  8.25s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [08:15<05:06,  7.87s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [08:15<05:06,  7.87s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [08:19<04:19,  6.82s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [08:19<04:19,  6.82s/it]Validation DataLoader 0:  61%|██████    | 57/94 [08:31<05:07,  8.31s/it]Validation DataLoader 0:  61%|██████    | 57/94 [08:31<05:07,  8.31s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [08:36<04:23,  7.31s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [08:36<04:23,  7.31s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [08:38<03:22,  5.78s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [08:38<03:22,  5.78s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [09:11<07:56, 14.01s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [09:11<07:56, 14.01s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [09:19<06:43, 12.22s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [09:19<06:43, 12.22s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [09:24<05:17,  9.93s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [09:24<05:17,  9.93s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [09:29<04:24,  8.53s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [09:29<04:24,  8.53s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [09:46<05:26, 10.88s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [09:46<05:26, 10.88s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [10:10<07:09, 14.82s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [10:10<07:09, 14.82s/it]Validation DataLoader 0:  70%|███████   | 66/94 [10:14<05:29, 11.76s/it]Validation DataLoader 0:  70%|███████   | 66/94 [10:14<05:29, 11.76s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [10:18<04:13,  9.40s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [10:18<04:13,  9.40s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [10:20<03:07,  7.22s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [10:20<03:07,  7.22s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [10:23<02:30,  6.00s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [10:23<02:30,  6.00s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [10:26<02:02,  5.10s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [10:26<02:02,  5.10s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [10:28<01:36,  4.19s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [10:28<01:36,  4.19s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [10:34<01:43,  4.69s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [10:34<01:43,  4.69s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [10:39<01:35,  4.56s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [10:39<01:35,  4.56s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [10:43<01:31,  4.58s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [10:43<01:31,  4.58s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [10:48<01:30,  4.77s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [10:48<01:30,  4.77s/it]Validation DataLoader 0:  81%|████████  | 76/94 [10:55<01:36,  5.39s/it]Validation DataLoader 0:  81%|████████  | 76/94 [10:55<01:36,  5.39s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [10:57<01:14,  4.37s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [10:57<01:14,  4.37s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [11:00<01:01,  3.82s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [11:00<01:01,  3.82s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [11:02<00:50,  3.38s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [11:02<00:50,  3.38s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [11:07<00:53,  3.79s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [11:07<00:53,  3.79s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [11:11<00:51,  3.97s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [11:11<00:51,  3.97s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [11:21<01:08,  5.75s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [11:21<01:08,  5.75s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [11:24<00:54,  4.99s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [11:24<00:54,  4.99s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [11:28<00:45,  4.55s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [11:28<00:45,  4.55s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [11:31<00:36,  4.06s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [11:31<00:36,  4.06s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [11:38<00:39,  4.93s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [11:38<00:39,  4.93s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [11:57<01:03,  9.12s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [11:57<01:03,  9.12s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [11:59<00:41,  6.98s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [11:59<00:41,  6.98s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [12:03<00:30,  6.12s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [12:03<00:30,  6.12s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [12:05<00:19,  4.99s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [12:05<00:19,  4.99s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [12:08<00:12,  4.27s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [12:08<00:12,  4.27s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [12:15<00:10,  5.20s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [12:15<00:10,  5.20s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [12:22<00:05,  5.70s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [12:22<00:05,  5.70s/it]Validation DataLoader 0: 100%|██████████| 94/94 [12:23<00:00,  4.42s/it]Validation DataLoader 0: 100%|██████████| 94/94 [12:23<00:00,  4.42s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9893557422969187
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.515625	0.8924839917027416
	steps: 0.359375	0.4516369047619047
	proof: 0.359375	0.359375
28 trees have depth 3
	leaves: 0.4642857142857143	0.9067801246372676
	steps: 0.17857142857142858	0.3554421768707483
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.840262669429336
	steps: 0.1111111111111111	0.3732924482924483
	proof: 0.1111111111111111	0.1111111111111111
13 trees have depth 5
	leaves: 0.07692307692307693	0.8147972690959117
	steps: 0.0	0.21111209977606737
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.7043684140322796
	steps: 0.0	0.1460676578323637
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.7748762131115071
	steps: 0.0	0.17977990791458284
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5135135135135135	0.8855270855270855
	steps: 0.40540540540540543	0.4837837837837837
	proof: 0.40540540540540543	0.40540540540540543
13 trees have size 6
	leaves: 0.5384615384615384	0.8892107892107893
	steps: 0.38461538461538464	0.4794871794871795
	proof: 0.38461538461538464	0.38461538461538464
26 trees have size 7
	leaves: 0.6153846153846154	0.9416971916971918
	steps: 0.3076923076923077	0.463003663003663
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.4	0.8779220779220779
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8877272727272729
	steps: 0.0	0.31214285714285717
	proof: 0.0	0.0
2 trees have size 10
	leaves: 0.0	0.9090909090909091
	steps: 0.0	0.3650793650793651
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.14285714285714285	0.7950188700188701
	steps: 0.07142857142857142	0.2815192743764172
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8877005347593583
	steps: 0.0	0.16267942583732056
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8823529411764706
	steps: 0.0	0.07692307692307691
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.7326563958916901
	steps: 0.0	0.2386752136752137
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7782805429864252
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7592592592592592
	steps: 0.0	0.21176470588235294
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.26666666666666666
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.8169340463458111
	steps: 0.0	0.08366013071895424
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8932178932178932
	steps: 0.0	0.17374847374847377
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5347222222222222
	steps: 0.0	0.0625
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.6363636363636364
	steps: 0.0	0.10526315789473685
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [12:23<00:00,  7.91s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5454545454545454
  ExactMatch_proof_val      0.39572192513368987
  ExactMatch_steps_val      0.39572192513368987
      F1_leaves_val         0.8998015536942872
      F1_proof_val          0.39572192513368987
      F1_steps_val          0.5049305736674323
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=2.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:40,  3.66s/it]Validation DataLoader 0:   1%|          | 1/94 [00:03<05:40,  3.66s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:07,  3.34s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:06<05:07,  3.34s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:40,  4.40s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:40,  4.40s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:13,  3.48s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:14<05:13,  3.48s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:18<05:40,  3.83s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:18<05:40,  3.83s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:21<05:01,  3.42s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:21<05:01,  3.42s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:24<04:30,  3.11s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:24<04:30,  3.11s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:25<03:44,  2.61s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:25<03:44,  2.61s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:27<03:23,  2.39s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:27<03:23,  2.39s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:40<07:52,  5.62s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:40<07:52,  5.62s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:42<06:26,  4.66s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:42<06:26,  4.66s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:45<05:37,  4.12s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:45<05:37,  4.12s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:51<06:10,  4.58s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:51<06:10,  4.58s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:58<07:07,  5.34s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:58<07:07,  5.34s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:03<06:54,  5.25s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:03<06:54,  5.25s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:13<08:36,  6.62s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:13<08:36,  6.62s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:17<07:45,  6.04s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:17<07:45,  6.04s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:21<06:47,  5.36s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:21<06:47,  5.36s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:24<05:52,  4.70s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:24<05:52,  4.70s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:31<06:39,  5.40s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:31<06:39,  5.40s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:39<07:13,  5.93s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:39<07:13,  5.93s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:48<08:30,  7.10s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:48<08:30,  7.10s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:53<07:39,  6.47s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [01:53<07:39,  6.47s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:59<07:23,  6.33s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [01:59<07:23,  6.33s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:03<06:15,  5.44s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:03<06:15,  5.44s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:06<05:19,  4.70s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:06<05:19,  4.70s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:13<06:04,  5.44s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:13<06:04,  5.44s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:17<05:33,  5.06s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:17<05:33,  5.06s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:18<04:15,  3.93s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:18<04:15,  3.93s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:24<04:37,  4.34s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:24<04:37,  4.34s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:27<04:20,  4.14s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:27<04:20,  4.14s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:31<04:12,  4.08s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:31<04:12,  4.08s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:34<03:41,  3.63s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:34<03:41,  3.63s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:43<05:20,  5.34s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [02:43<05:20,  5.34s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:45<04:17,  4.37s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [02:45<04:17,  4.37s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:48<03:42,  3.83s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [02:48<03:42,  3.83s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:52<03:41,  3.88s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [02:52<03:41,  3.88s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:57<03:59,  4.27s/it]Validation DataLoader 0:  40%|████      | 38/94 [02:57<03:59,  4.27s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:09<06:00,  6.56s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:09<06:00,  6.56s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:13<05:13,  5.81s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:13<05:13,  5.81s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:21<05:47,  6.57s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:21<05:47,  6.57s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:23<04:21,  5.03s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:23<04:21,  5.03s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:29<04:39,  5.47s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:29<04:39,  5.47s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:49<08:07,  9.75s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [03:49<08:07,  9.75s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:00<08:11, 10.03s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:00<08:11, 10.03s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:10<08:00, 10.01s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:10<08:00, 10.01s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:23<08:29, 10.85s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:23<08:29, 10.85s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:31<07:52, 10.27s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:31<07:52, 10.27s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:38<06:52,  9.16s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [04:38<06:52,  9.16s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:48<06:49,  9.32s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [04:48<06:49,  9.32s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:57<06:46,  9.45s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [04:57<06:46,  9.45s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:02<05:40,  8.10s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:02<05:40,  8.10s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:08<05:06,  7.47s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:08<05:06,  7.47s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:12<04:12,  6.30s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:12<04:12,  6.30s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:17<03:46,  5.80s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:17<03:46,  5.80s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:20<03:16,  5.16s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:20<03:16,  5.16s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:26<03:13,  5.22s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:26<03:13,  5.22s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:30<03:00,  5.02s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:30<03:00,  5.02s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:32<02:21,  4.06s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:32<02:21,  4.06s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:48<04:17,  7.56s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [05:48<04:17,  7.56s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:57<04:29,  8.17s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [05:57<04:29,  8.17s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:03<03:59,  7.49s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:03<03:59,  7.49s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:06<03:10,  6.14s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:06<03:10,  6.14s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:18<03:54,  7.80s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:18<03:54,  7.80s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:31<04:34,  9.47s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [06:31<04:34,  9.47s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:36<03:43,  7.98s/it]Validation DataLoader 0:  70%|███████   | 66/94 [06:36<03:43,  7.98s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:38<02:51,  6.35s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [06:38<02:51,  6.35s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:40<02:07,  4.92s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [06:40<02:07,  4.92s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:43<01:47,  4.30s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [06:43<01:47,  4.30s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:45<01:31,  3.80s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [06:45<01:31,  3.80s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:47<01:15,  3.27s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [06:47<01:15,  3.27s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:51<01:10,  3.22s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [06:51<01:10,  3.22s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:53<01:05,  3.13s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [06:53<01:05,  3.13s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:59<01:16,  3.82s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [06:59<01:16,  3.82s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:02<01:10,  3.71s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:02<01:10,  3.71s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:07<01:10,  3.90s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:07<01:10,  3.90s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:08<00:51,  3.04s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:08<00:51,  3.04s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:10<00:46,  2.94s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:10<00:46,  2.94s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:12<00:39,  2.65s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:12<00:39,  2.65s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:18<00:48,  3.43s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [07:18<00:48,  3.43s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:21<00:43,  3.38s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [07:21<00:43,  3.38s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:24<00:38,  3.25s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [07:24<00:38,  3.25s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:27<00:36,  3.28s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [07:27<00:36,  3.28s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:31<00:33,  3.32s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [07:31<00:33,  3.32s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:33<00:26,  2.94s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [07:33<00:26,  2.94s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:41<00:36,  4.52s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [07:41<00:36,  4.52s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:47<00:35,  5.13s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [07:47<00:35,  5.13s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:49<00:24,  4.11s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [07:49<00:24,  4.11s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:52<00:19,  3.87s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [07:52<00:19,  3.87s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:54<00:12,  3.25s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [07:54<00:12,  3.25s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:56<00:08,  2.83s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [07:56<00:08,  2.83s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:58<00:05,  2.62s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [07:58<00:05,  2.62s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:03<00:03,  3.30s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:03<00:03,  3.30s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:04<00:00,  2.67s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:04<00:00,  2.67s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9893557422969187
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.53125	0.9048081259018759
	steps: 0.390625	0.49412202380952386
	proof: 0.390625	0.390625
28 trees have depth 3
	leaves: 0.5357142857142857	0.9058009450866594
	steps: 0.17857142857142858	0.38265306122448983
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.5	0.8896965688632356
	steps: 0.2222222222222222	0.3700737534070867
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.07692307692307693	0.7817253497474979
	steps: 0.0	0.21885233921433017
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.5965642127296263
	steps: 0.0	0.14213972302207598
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7816239316239315
	steps: 0.0	0.2381855473960737
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5675675675675675	0.9050895050895051
	steps: 0.4864864864864865	0.563963963963964
	proof: 0.4864864864864865	0.4864864864864865
13 trees have size 6
	leaves: 0.46153846153846156	0.8967032967032966
	steps: 0.3076923076923077	0.46923076923076923
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.9213369963369964
	steps: 0.3076923076923077	0.44322344322344315
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.6	0.9318181818181819
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.5	0.8936363636363638
	steps: 0.1	0.3542857142857143
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.35714285714285715	0.8655281226709798
	steps: 0.14285714285714285	0.27358276643990925
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8961038961038961
	steps: 0.0	0.21328671328671328
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8117647058823529
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.636650922177238
	steps: 0.0	0.2065875301169419
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7946428571428572
	steps: 0.0	0.16666666666666666
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6934001670843776
	steps: 0.0	0.21241830065359477
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.4615384615384615
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7388888888888888
	steps: 0.0	0.1118421052631579
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.8949938949938949
	steps: 0.0	0.30151515151515146
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.5625
	steps: 0.0	0.05555555555555555
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.6666666666666667
	steps: 0.0	0.09523809523809522
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [08:04<00:00,  5.16s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5775401069518716
  ExactMatch_proof_val      0.41711229946524064
  ExactMatch_steps_val      0.41711229946524064
      F1_leaves_val         0.9025131029005138
      F1_proof_val          0.41711229946524064
      F1_steps_val          0.5255005056403212
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=2, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:48,  4.39s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<06:48,  4.39s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:57,  3.89s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:07<05:57,  3.89s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:26,  4.25s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:12<06:26,  4.25s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:15<05:18,  3.54s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:15<05:18,  3.54s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:20<06:10,  4.17s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:20<06:10,  4.17s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:23<05:40,  3.87s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:23<05:40,  3.87s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:26<05:11,  3.58s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:26<05:11,  3.58s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:28<04:19,  3.02s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:28<04:19,  3.02s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:29<03:36,  2.55s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:29<03:36,  2.55s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:37<05:47,  4.14s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:37<05:47,  4.14s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:40<05:00,  3.63s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:40<05:00,  3.63s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<04:46,  3.50s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:43<04:46,  3.50s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:47<05:03,  3.75s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [00:47<05:03,  3.75s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:53<06:02,  4.53s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [00:53<06:02,  4.53s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:58<06:04,  4.61s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [00:58<06:04,  4.61s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:09<08:18,  6.38s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:09<08:18,  6.38s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:16<08:32,  6.65s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:16<08:32,  6.65s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:20<07:34,  5.98s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:20<07:34,  5.98s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<09:08,  7.31s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:31<09:08,  7.31s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:37<08:27,  6.86s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:37<08:27,  6.86s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:48<10:07,  8.33s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:48<10:07,  8.33s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:55<09:18,  7.76s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [01:55<09:18,  7.76s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:04<09:42,  8.20s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:04<09:42,  8.20s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:07<07:51,  6.73s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:07<07:51,  6.73s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:15<07:52,  6.85s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:15<07:52,  6.85s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:18<06:42,  5.92s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:18<06:42,  5.92s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:25<07:02,  6.31s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:25<07:02,  6.31s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:30<06:20,  5.76s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:30<06:20,  5.76s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:32<04:55,  4.55s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:32<04:55,  4.55s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:39<05:34,  5.23s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [02:39<05:34,  5.23s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:43<05:14,  4.99s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [02:43<05:14,  4.99s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:48<05:17,  5.12s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [02:48<05:17,  5.12s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:52<04:41,  4.61s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [02:52<04:41,  4.61s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:03<06:39,  6.65s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:03<06:39,  6.65s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:05<05:13,  5.32s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:05<05:13,  5.32s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:08<04:28,  4.63s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:08<04:28,  4.63s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:12<03:58,  4.19s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:12<03:58,  4.19s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:14<03:29,  3.75s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:14<03:29,  3.75s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:26<05:39,  6.17s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [03:26<05:39,  6.17s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:34<05:58,  6.63s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [03:34<05:58,  6.63s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:39<05:22,  6.08s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [03:39<05:22,  6.08s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:41<04:15,  4.91s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [03:41<04:15,  4.91s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:53<05:57,  7.01s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [03:53<05:57,  7.01s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:12<08:56, 10.73s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:12<08:56, 10.73s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:23<08:51, 10.86s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [04:23<08:51, 10.86s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:39<09:46, 12.21s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [04:39<09:46, 12.21s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:52<09:44, 12.43s/it]Validation DataLoader 0:  50%|█████     | 47/94 [04:52<09:44, 12.43s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:59<08:16, 10.79s/it]Validation DataLoader 0:  51%|█████     | 48/94 [04:59<08:16, 10.79s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:04<06:56,  9.25s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:04<06:56,  9.25s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:09<05:47,  7.91s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [05:09<05:47,  7.91s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:18<05:50,  8.15s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [05:18<05:50,  8.15s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:26<05:38,  8.05s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [05:26<05:38,  8.05s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:33<05:23,  7.89s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [05:33<05:23,  7.89s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:37<04:23,  6.58s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [05:37<04:23,  6.58s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:43<04:17,  6.61s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [05:43<04:17,  6.61s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:47<03:39,  5.79s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [05:47<03:39,  5.79s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:52<03:28,  5.63s/it]Validation DataLoader 0:  61%|██████    | 57/94 [05:52<03:28,  5.63s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:57<03:15,  5.44s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [05:57<03:15,  5.44s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:59<02:33,  4.38s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [05:59<02:33,  4.38s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:24<05:56, 10.47s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [06:24<05:56, 10.47s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:31<05:12,  9.47s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [06:31<05:12,  9.47s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:34<04:01,  7.56s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [06:34<04:01,  7.56s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:40<03:34,  6.92s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [06:40<03:34,  6.92s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:49<03:49,  7.64s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [06:49<03:49,  7.64s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:05<04:57, 10.27s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [07:05<04:57, 10.27s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:09<03:49,  8.20s/it]Validation DataLoader 0:  70%|███████   | 66/94 [07:09<03:49,  8.20s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:13<03:12,  7.14s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [07:13<03:12,  7.14s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:16<02:27,  5.65s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [07:16<02:27,  5.65s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:19<02:01,  4.86s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [07:19<02:01,  4.86s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:22<01:49,  4.56s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [07:22<01:49,  4.56s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:26<01:34,  4.12s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [07:26<01:34,  4.12s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:31<01:38,  4.46s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [07:31<01:38,  4.46s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:34<01:26,  4.12s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [07:34<01:26,  4.12s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:39<01:29,  4.46s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [07:39<01:29,  4.46s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:44<01:25,  4.51s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [07:44<01:25,  4.51s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:49<01:22,  4.59s/it]Validation DataLoader 0:  81%|████████  | 76/94 [07:49<01:22,  4.59s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:51<01:03,  3.73s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [07:51<01:03,  3.73s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:54<00:57,  3.58s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [07:54<00:57,  3.58s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:56<00:46,  3.09s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [07:56<00:46,  3.09s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:00<00:49,  3.55s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [08:00<00:49,  3.55s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:04<00:47,  3.64s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [08:04<00:47,  3.64s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:09<00:48,  4.06s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [08:09<00:48,  4.06s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:13<00:43,  3.99s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [08:13<00:43,  3.99s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:16<00:37,  3.75s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [08:16<00:37,  3.75s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:19<00:30,  3.41s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [08:19<00:30,  3.41s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:25<00:33,  4.15s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [08:25<00:33,  4.15s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:30<00:31,  4.44s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [08:30<00:31,  4.44s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:32<00:22,  3.67s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [08:32<00:22,  3.67s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:35<00:17,  3.49s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [08:35<00:17,  3.49s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:37<00:12,  3.06s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [08:37<00:12,  3.06s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:39<00:08,  2.87s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [08:39<00:08,  2.87s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:42<00:05,  2.95s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [08:42<00:05,  2.95s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:47<00:03,  3.39s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [08:47<00:03,  3.39s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:48<00:00,  2.81s/it]Validation DataLoader 0: 100%|██████████| 94/94 [08:48<00:00,  2.81s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9607843137254902	0.9921568627450981
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.515625	0.8965739989177489
	steps: 0.359375	0.47354910714285714
	proof: 0.359375	0.359375
28 trees have depth 3
	leaves: 0.39285714285714285	0.8835812996527282
	steps: 0.17857142857142858	0.34387755102040823
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.3888888888888889	0.865201619368286
	steps: 0.16666666666666666	0.36853054353054354
	proof: 0.16666666666666666	0.16666666666666666
13 trees have depth 5
	leaves: 0.0	0.7317370039143858
	steps: 0.0	0.2021408706929069
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6297206061911945
	steps: 0.0	0.15590599876314165
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.0	0.6311827920961047
	steps: 0.0	0.13111946532999164
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9902439024390244
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 1.0	1.0
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.8891306891306893
	steps: 0.43243243243243246	0.5166666666666667
	proof: 0.43243243243243246	0.43243243243243246
13 trees have size 6
	leaves: 0.5384615384615384	0.8994505494505495
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5	0.9115689865689866
	steps: 0.3076923076923077	0.45347985347985353
	proof: 0.3076923076923077	0.3076923076923077
5 trees have size 8
	leaves: 0.2	0.8873737373737374
	steps: 0.0	0.24666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.4	0.8943939393939395
	steps: 0.1	0.2773809523809524
	proof: 0.1	0.1
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.5714285714285715
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.21428571428571427	0.8153949225377798
	steps: 0.07142857142857142	0.2511904761904762
	proof: 0.07142857142857142	0.07142857142857142
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8423076923076923
	steps: 0.0	0.1818181818181818
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.7973856209150327
	steps: 0.0	0.15384615384615383
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.716955756661639
	steps: 0.0	0.20112110112110113
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.8375000000000001
	steps: 0.0	0.25874125874125875
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.6347543065809319
	steps: 0.0	0.12254901960784315
	proof: 0.0	0.0
1 trees have size 20
	leaves: 0.0	0.6666666666666666
	steps: 0.0	0.2222222222222222
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.6393345216874629
	steps: 0.0	0.09206349206349207
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.0	0.8081963802787602
	steps: 0.0	0.1944178628389155
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.4375
	steps: 0.0	0.07142857142857144
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.47619047619047616
	steps: 0.0	0.2
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [08:48<00:00,  5.63s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5347593582887701
  ExactMatch_proof_val      0.40106951871657753
  ExactMatch_steps_val      0.40106951871657753
      F1_leaves_val         0.8877131738847244
      F1_proof_val          0.40106951871657753
      F1_steps_val          0.5084232843400738
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=5, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
187 proofs loaded. 0 invalid ones removed.
Validation: 0it [00:00, ?it/s]Validation:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   0%|          | 0/94 [00:00<?, ?it/s]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:22,  4.76s/it]Validation DataLoader 0:   1%|          | 1/94 [00:04<07:22,  4.76s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:43,  4.38s/it]Validation DataLoader 0:   2%|▏         | 2/94 [00:08<06:43,  4.38s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:15<08:08,  5.37s/it]Validation DataLoader 0:   3%|▎         | 3/94 [00:15<08:08,  5.37s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:19<07:33,  5.03s/it]Validation DataLoader 0:   4%|▍         | 4/94 [00:19<07:33,  5.03s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:25<07:43,  5.21s/it]Validation DataLoader 0:   5%|▌         | 5/94 [00:25<07:43,  5.21s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:28<06:29,  4.43s/it]Validation DataLoader 0:   6%|▋         | 6/94 [00:28<06:29,  4.43s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:32<06:14,  4.31s/it]Validation DataLoader 0:   7%|▋         | 7/94 [00:32<06:14,  4.31s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:34<05:10,  3.61s/it]Validation DataLoader 0:   9%|▊         | 8/94 [00:34<05:10,  3.61s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:36<04:34,  3.24s/it]Validation DataLoader 0:  10%|▉         | 9/94 [00:36<04:34,  3.24s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:45<06:59,  4.99s/it]Validation DataLoader 0:  11%|█         | 10/94 [00:45<06:59,  4.99s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:49<06:18,  4.56s/it]Validation DataLoader 0:  12%|█▏        | 11/94 [00:49<06:18,  4.56s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:53<05:58,  4.37s/it]Validation DataLoader 0:  13%|█▎        | 12/94 [00:53<05:58,  4.37s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:00<07:10,  5.31s/it]Validation DataLoader 0:  14%|█▍        | 13/94 [01:00<07:10,  5.31s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:06<07:05,  5.32s/it]Validation DataLoader 0:  15%|█▍        | 14/94 [01:06<07:05,  5.32s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:12<07:14,  5.50s/it]Validation DataLoader 0:  16%|█▌        | 15/94 [01:12<07:14,  5.50s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:21<08:36,  6.62s/it]Validation DataLoader 0:  17%|█▋        | 16/94 [01:21<08:36,  6.62s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:28<08:47,  6.85s/it]Validation DataLoader 0:  18%|█▊        | 17/94 [01:28<08:47,  6.85s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:34<08:22,  6.61s/it]Validation DataLoader 0:  19%|█▉        | 18/94 [01:34<08:22,  6.61s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:42<08:31,  6.81s/it]Validation DataLoader 0:  20%|██        | 19/94 [01:42<08:31,  6.81s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:51<09:27,  7.67s/it]Validation DataLoader 0:  21%|██▏       | 20/94 [01:51<09:27,  7.67s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:59<09:21,  7.69s/it]Validation DataLoader 0:  22%|██▏       | 21/94 [01:59<09:21,  7.69s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:11<10:57,  9.14s/it]Validation DataLoader 0:  23%|██▎       | 22/94 [02:11<10:57,  9.14s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:21<11:06,  9.39s/it]Validation DataLoader 0:  24%|██▍       | 23/94 [02:21<11:06,  9.39s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:30<10:37,  9.11s/it]Validation DataLoader 0:  26%|██▌       | 24/94 [02:30<10:37,  9.11s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:37<09:45,  8.49s/it]Validation DataLoader 0:  27%|██▋       | 25/94 [02:37<09:45,  8.49s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:40<07:53,  6.97s/it]Validation DataLoader 0:  28%|██▊       | 26/94 [02:40<07:53,  6.97s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:50<08:45,  7.84s/it]Validation DataLoader 0:  29%|██▊       | 27/94 [02:50<08:45,  7.84s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:56<07:52,  7.16s/it]Validation DataLoader 0:  30%|██▉       | 28/94 [02:56<07:52,  7.16s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:57<05:55,  5.47s/it]Validation DataLoader 0:  31%|███       | 29/94 [02:57<05:55,  5.47s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:06<06:46,  6.35s/it]Validation DataLoader 0:  32%|███▏      | 30/94 [03:06<06:46,  6.35s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:15<07:37,  7.27s/it]Validation DataLoader 0:  33%|███▎      | 31/94 [03:15<07:37,  7.27s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:22<07:25,  7.19s/it]Validation DataLoader 0:  34%|███▍      | 32/94 [03:22<07:25,  7.19s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:26<06:18,  6.20s/it]Validation DataLoader 0:  35%|███▌      | 33/94 [03:26<06:18,  6.20s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:33<06:19,  6.32s/it]Validation DataLoader 0:  36%|███▌      | 34/94 [03:33<06:19,  6.32s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:36<05:11,  5.29s/it]Validation DataLoader 0:  37%|███▋      | 35/94 [03:36<05:11,  5.29s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:42<05:28,  5.67s/it]Validation DataLoader 0:  38%|███▊      | 36/94 [03:42<05:28,  5.67s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:47<05:05,  5.35s/it]Validation DataLoader 0:  39%|███▉      | 37/94 [03:47<05:05,  5.35s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:52<04:58,  5.33s/it]Validation DataLoader 0:  40%|████      | 38/94 [03:52<04:58,  5.33s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:01<05:55,  6.46s/it]Validation DataLoader 0:  41%|████▏     | 39/94 [04:01<05:55,  6.46s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:09<06:07,  6.80s/it]Validation DataLoader 0:  43%|████▎     | 40/94 [04:09<06:07,  6.80s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:20<07:13,  8.19s/it]Validation DataLoader 0:  44%|████▎     | 41/94 [04:20<07:13,  8.19s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:23<05:38,  6.51s/it]Validation DataLoader 0:  45%|████▍     | 42/94 [04:23<05:38,  6.51s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:31<05:53,  6.94s/it]Validation DataLoader 0:  46%|████▌     | 43/94 [04:31<05:53,  6.94s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:54<09:58, 11.97s/it]Validation DataLoader 0:  47%|████▋     | 44/94 [04:54<09:58, 11.97s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:14<11:43, 14.37s/it]Validation DataLoader 0:  48%|████▊     | 45/94 [05:14<11:43, 14.37s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:24<10:24, 13.01s/it]Validation DataLoader 0:  49%|████▉     | 46/94 [05:24<10:24, 13.01s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:36<09:57, 12.72s/it]Validation DataLoader 0:  50%|█████     | 47/94 [05:36<09:57, 12.72s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:46<08:58, 11.70s/it]Validation DataLoader 0:  51%|█████     | 48/94 [05:46<08:58, 11.70s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:50<07:08,  9.52s/it]Validation DataLoader 0:  52%|█████▏    | 49/94 [05:50<07:08,  9.52s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [06:00<07:01,  9.58s/it]Validation DataLoader 0:  53%|█████▎    | 50/94 [06:00<07:01,  9.58s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:20<09:09, 12.79s/it]Validation DataLoader 0:  54%|█████▍    | 51/94 [06:20<09:09, 12.79s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:26<07:31, 10.75s/it]Validation DataLoader 0:  55%|█████▌    | 52/94 [06:26<07:31, 10.75s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:32<06:27,  9.45s/it]Validation DataLoader 0:  56%|█████▋    | 53/94 [06:32<06:27,  9.45s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:36<05:11,  7.79s/it]Validation DataLoader 0:  57%|█████▋    | 54/94 [06:36<05:11,  7.79s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:42<04:37,  7.13s/it]Validation DataLoader 0:  59%|█████▊    | 55/94 [06:42<04:37,  7.13s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:47<04:10,  6.60s/it]Validation DataLoader 0:  60%|█████▉    | 56/94 [06:47<04:10,  6.60s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:56<04:27,  7.23s/it]Validation DataLoader 0:  61%|██████    | 57/94 [06:56<04:27,  7.23s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [07:02<04:10,  6.96s/it]Validation DataLoader 0:  62%|██████▏   | 58/94 [07:02<04:10,  6.96s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [07:04<03:10,  5.45s/it]Validation DataLoader 0:  63%|██████▎   | 59/94 [07:04<03:10,  5.45s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:24<05:28,  9.65s/it]Validation DataLoader 0:  64%|██████▍   | 60/94 [07:24<05:28,  9.65s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:38<06:06, 11.12s/it]Validation DataLoader 0:  65%|██████▍   | 61/94 [07:38<06:06, 11.12s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:44<05:07,  9.60s/it]Validation DataLoader 0:  66%|██████▌   | 62/94 [07:44<05:07,  9.60s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:50<04:21,  8.44s/it]Validation DataLoader 0:  67%|██████▋   | 63/94 [07:50<04:21,  8.44s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [08:05<05:09, 10.33s/it]Validation DataLoader 0:  68%|██████▊   | 64/94 [08:05<05:09, 10.33s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [08:22<06:01, 12.45s/it]Validation DataLoader 0:  69%|██████▉   | 65/94 [08:22<06:01, 12.45s/it]Validation DataLoader 0:  70%|███████   | 66/94 [08:25<04:32,  9.71s/it]Validation DataLoader 0:  70%|███████   | 66/94 [08:25<04:32,  9.71s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:30<03:37,  8.07s/it]Validation DataLoader 0:  71%|███████▏  | 67/94 [08:30<03:37,  8.07s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:32<02:43,  6.28s/it]Validation DataLoader 0:  72%|███████▏  | 68/94 [08:32<02:43,  6.28s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:35<02:16,  5.47s/it]Validation DataLoader 0:  73%|███████▎  | 69/94 [08:35<02:16,  5.47s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:39<01:57,  4.91s/it]Validation DataLoader 0:  74%|███████▍  | 70/94 [08:39<01:57,  4.91s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:41<01:35,  4.15s/it]Validation DataLoader 0:  76%|███████▌  | 71/94 [08:41<01:35,  4.15s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:46<01:34,  4.31s/it]Validation DataLoader 0:  77%|███████▋  | 72/94 [08:46<01:34,  4.31s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:50<01:26,  4.13s/it]Validation DataLoader 0:  78%|███████▊  | 73/94 [08:50<01:26,  4.13s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:54<01:24,  4.22s/it]Validation DataLoader 0:  79%|███████▊  | 74/94 [08:54<01:24,  4.22s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:59<01:23,  4.37s/it]Validation DataLoader 0:  80%|███████▉  | 75/94 [08:59<01:23,  4.37s/it]Validation DataLoader 0:  81%|████████  | 76/94 [09:05<01:27,  4.87s/it]Validation DataLoader 0:  81%|████████  | 76/94 [09:05<01:27,  4.87s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [09:07<01:09,  4.06s/it]Validation DataLoader 0:  82%|████████▏ | 77/94 [09:07<01:09,  4.06s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [09:10<00:57,  3.61s/it]Validation DataLoader 0:  83%|████████▎ | 78/94 [09:10<00:57,  3.61s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [09:12<00:48,  3.25s/it]Validation DataLoader 0:  84%|████████▍ | 79/94 [09:12<00:48,  3.25s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [09:20<01:05,  4.66s/it]Validation DataLoader 0:  85%|████████▌ | 80/94 [09:20<01:05,  4.66s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [09:25<01:00,  4.68s/it]Validation DataLoader 0:  86%|████████▌ | 81/94 [09:25<01:00,  4.68s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [09:31<01:03,  5.26s/it]Validation DataLoader 0:  87%|████████▋ | 82/94 [09:31<01:03,  5.26s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [09:36<00:55,  5.00s/it]Validation DataLoader 0:  88%|████████▊ | 83/94 [09:36<00:55,  5.00s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:40<00:48,  4.84s/it]Validation DataLoader 0:  89%|████████▉ | 84/94 [09:40<00:48,  4.84s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:43<00:38,  4.28s/it]Validation DataLoader 0:  90%|█████████ | 85/94 [09:43<00:38,  4.28s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:53<00:46,  5.82s/it]Validation DataLoader 0:  91%|█████████▏| 86/94 [09:53<00:46,  5.82s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [10:01<00:45,  6.50s/it]Validation DataLoader 0:  93%|█████████▎| 87/94 [10:01<00:45,  6.50s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [10:03<00:31,  5.18s/it]Validation DataLoader 0:  94%|█████████▎| 88/94 [10:03<00:31,  5.18s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [10:06<00:23,  4.72s/it]Validation DataLoader 0:  95%|█████████▍| 89/94 [10:06<00:23,  4.72s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [10:09<00:16,  4.07s/it]Validation DataLoader 0:  96%|█████████▌| 90/94 [10:09<00:16,  4.07s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [10:12<00:10,  3.62s/it]Validation DataLoader 0:  97%|█████████▋| 91/94 [10:12<00:10,  3.62s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [10:16<00:07,  3.80s/it]Validation DataLoader 0:  98%|█████████▊| 92/94 [10:16<00:07,  3.80s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [10:20<00:03,  3.94s/it]Validation DataLoader 0:  99%|█████████▉| 93/94 [10:20<00:03,  3.94s/it]Validation DataLoader 0: 100%|██████████| 94/94 [10:22<00:00,  3.22s/it]Validation DataLoader 0: 100%|██████████| 94/94 [10:22<00:00,  3.22s/it]Validation results saved to /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.json and /scratch/gpfs/lm2472/NLProofS/prover/lightning_logs/version_56162932/results_val.tsv
Performance by depth:
51 trees have depth 1
	leaves: 0.9411764705882353	0.9867413632119516
	steps: 0.8627450980392157	0.8627450980392157
	proof: 0.8627450980392157	0.8627450980392157
64 trees have depth 2
	leaves: 0.546875	0.9017699314574315
	steps: 0.34375	0.4479910714285714
	proof: 0.34375	0.34375
28 trees have depth 3
	leaves: 0.5	0.9020877931592217
	steps: 0.17857142857142858	0.37471655328798187
	proof: 0.17857142857142858	0.17857142857142858
18 trees have depth 4
	leaves: 0.4444444444444444	0.8568682860349527
	steps: 0.2222222222222222	0.41019721019721017
	proof: 0.2222222222222222	0.2222222222222222
13 trees have depth 5
	leaves: 0.07692307692307693	0.7868326118326118
	steps: 0.0	0.27137093675555213
	proof: 0.0	0.0
7 trees have depth 6
	leaves: 0.0	0.6600907029478458
	steps: 0.0	0.1860554478201537
	proof: 0.0	0.0
6 trees have depth 7
	leaves: 0.16666666666666666	0.7201000690131125
	steps: 0.0	0.17825256099249906
	proof: 0.0	0.0
Performance by size:
41 trees have size 3
	leaves: 0.9512195121951219	0.9869918699186992
	steps: 0.9512195121951219	0.9512195121951219
	proof: 0.9512195121951219	0.9512195121951219
10 trees have size 4
	leaves: 0.9	0.9857142857142858
	steps: 0.5	0.5
	proof: 0.5	0.5
37 trees have size 5
	leaves: 0.5405405405405406	0.896080496080496
	steps: 0.40540540540540543	0.49189189189189186
	proof: 0.40540540540540543	0.40540540540540543
13 trees have size 6
	leaves: 0.5384615384615384	0.8994505494505495
	steps: 0.3076923076923077	0.4384615384615384
	proof: 0.3076923076923077	0.3076923076923077
26 trees have size 7
	leaves: 0.5769230769230769	0.9247557997557998
	steps: 0.2692307692307692	0.42454212454212453
	proof: 0.2692307692307692	0.2692307692307692
5 trees have size 8
	leaves: 0.4	0.8738816738816739
	steps: 0.0	0.14666666666666667
	proof: 0.0	0.0
10 trees have size 9
	leaves: 0.6	0.9186363636363637
	steps: 0.2	0.4734126984126984
	proof: 0.2	0.2
2 trees have size 10
	leaves: 0.0	0.8545454545454546
	steps: 0.0	0.4285714285714286
	proof: 0.0	0.0
14 trees have size 11
	leaves: 0.2857142857142857	0.8230789052217623
	steps: 0.14285714285714285	0.3325396825396825
	proof: 0.14285714285714285	0.14285714285714285
1 trees have size 12
	leaves: 1.0	1.0
	steps: 1.0	1.0
	proof: 1.0	1.0
4 trees have size 13
	leaves: 0.5	0.8484848484848484
	steps: 0.0	0.21969696969696967
	proof: 0.0	0.0
1 trees have size 15
	leaves: 0.0	0.4
	steps: 0.0	0.25
	proof: 0.0	0.0
2 trees have size 16
	leaves: 0.0	0.8444444444444444
	steps: 0.0	0.3205128205128205
	proof: 0.0	0.0
6 trees have size 17
	leaves: 0.0	0.6789682539682541
	steps: 0.0	0.16554741554741556
	proof: 0.0	0.0
2 trees have size 18
	leaves: 0.0	0.7946428571428572
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
3 trees have size 19
	leaves: 0.0	0.7592592592592592
	steps: 0.0	0.21176470588235294
	proof: 0.0	0.0
1 trees have size 20
	leaves: 1.0	1.0
	steps: 0.0	0.3636363636363636
	proof: 0.0	0.0
3 trees have size 21
	leaves: 0.0	0.7722222222222221
	steps: 0.0	0.08366013071895424
	proof: 0.0	0.0
3 trees have size 23
	leaves: 0.3333333333333333	0.8873015873015873
	steps: 0.0	0.27573099415204677
	proof: 0.0	0.0
2 trees have size 27
	leaves: 0.0	0.4375
	steps: 0.0	0.07142857142857144
	proof: 0.0	0.0
1 trees have size 31
	leaves: 0.0	0.608695652173913
	steps: 0.0	0.18181818181818182
	proof: 0.0	0.0
Validation DataLoader 0: 100%|██████████| 94/94 [10:22<00:00,  6.62s/it]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  ExactMatch_leaves_val     0.5721925133689839
  ExactMatch_proof_val      0.40106951871657753
  ExactMatch_steps_val      0.40106951871657753
      F1_leaves_val         0.8978033785171661
      F1_proof_val          0.40106951871657753
      F1_steps_val           0.515758115109947
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Configuration: 
 Namespace(config=None, subcommand='validate', validate=Namespace(config=[Path_fsr(cli_task2_stepwise_t5-large.yaml, cwd=/scratch/gpfs/lm2472/NLProofS/prover)], seed_everything=1, trainer=Namespace(logger=True, checkpoint_callback=None, enable_checkpointing=True, callbacks=[Namespace(class_path='pytorch_lightning.callbacks.LearningRateMonitor', init_args=Namespace(logging_interval='step', log_momentum=False))], default_root_dir=None, gradient_clip_val=0.5, gradient_clip_algorithm=None, process_position=0, num_nodes=1, num_processes=None, devices=None, gpus=1, auto_select_gpus=False, tpu_cores=None, ipus=None, log_gpu_memory=None, progress_bar_refresh_rate=None, enable_progress_bar=True, overfit_batches=0.0, track_grad_norm=-1, check_val_every_n_epoch=10, fast_dev_run=False, accumulate_grad_batches=32, max_epochs=600, min_epochs=None, max_steps=-1, min_steps=None, max_time=None, limit_train_batches=None, limit_val_batches=None, limit_test_batches=None, limit_predict_batches=None, val_check_interval=None, flush_logs_every_n_steps=None, log_every_n_steps=5, accelerator=None, strategy=None, sync_batchnorm=False, precision=32, enable_model_summary=True, weights_summary='top', weights_save_path=None, num_sanity_val_steps=2, resume_from_checkpoint=None, profiler=None, benchmark=None, deterministic=False, reload_dataloaders_every_n_epochs=0, auto_lr_find=False, replace_sampler_ddp=True, detect_anomaly=False, auto_scale_batch_size=False, prepare_data_per_node=None, plugins=None, amp_backend='native', amp_level=None, move_metrics_to_cpu=False, multiple_trainloader_mode='max_size_cycle', stochastic_weight_avg=False, terminate_on_nan=None), model=Namespace(stepwise=True, max_num_steps=20, model_name='t5-large', lr=5e-05, warmup_steps=1000, num_beams=10, topk=10, proof_search=True, verifier_weight=0.5, greedy_search=False, diverse_beam_search=True, num_beam_groups=10, diversity_penalty=5.0, verifier_ckpt='../models/verifier-bank-task2.ckpt', oracle_prover=False, oracle_verifier=False, dataset='entailmentbank', max_input_len=1024), data=Namespace(dataset='entailmentbank', sample_goal='intermediates', max_input_len=1024, max_output_len=64, batch_size=2, num_workers=2, path_train='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/train.jsonl', path_val='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/dev.jsonl', path_test='../data/entailment_trees_emnlp2021_data_v3/dataset/task_2/test.jsonl', subtree_proved_prob=0.75, subtree_proved_all_or_none=False, model_name='t5-large', stepwise=True), ckpt_path='../models/prover-bank-task2.ckpt', verbose=True))
